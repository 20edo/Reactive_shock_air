
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reactive air shock &#8212; Reactive air shock assignment</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/Logo_Politecnico_Milano.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Reactive air shock assignment</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Cerca in questo libro ..." aria-label="Cerca in questo libro ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Code description
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1T_code_structure.html">
   One temperature
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Attiva / disattiva la navigazione" aria-controls="site-navigation"
                title="Attiva / disattiva la navigazione" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Scarica questa pagina"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Reactive_Air_shock.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Scarica il file sorgente" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Stampa in PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/20edo/Reactive_shock_air"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Repository di origine"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/20edo/Reactive_shock_air/issues/new?title=Issue%20on%20page%20%2FReactive_Air_shock.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Apri un problema"><i class="fas fa-lightbulb"></i>questione aperta</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Modalità schermo intero"
        title="Modalità schermo intero"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/20edo/Reactive_shock_air/master?urlpath=tree/Book/Reactive_Air_shock.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Lanciare Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenuti
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Reactive air shock
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specie-class-definition">
     Specie class definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-species-data">
     Importing species data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reaction-class-definition">
   Reaction class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-reactions-data">
     Importing reactions data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-class-definition">
   Problem class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rh-jump-relations">
     RH jump relations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
     Computation of the chemical source terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-shock-relax-chemistry-funciton">
     Pre-shock relax chemistry funciton
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-version">
     Energy version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-energy-version-depreciated-with-and-without-fsolve">
       Euler system of equation and solve function, energy version  // depreciated, with and without fsolve
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-energy-version">
       Euler system of equation and solve function, energy version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-function-energy-version">
       Solve function, energy version
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-version">
     Temperature version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-temperature-version">
       Euler system of equation and solve function, temperature version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-temperature-version">
       Solve, temperature version
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matte-version-cancellare">
     Matte version CANCELLARE
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-equations">
       Euler equations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-system">
       Solve system
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specie-problem">
   11 specie problem
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-altitude-density">
     Effect of altitude (density)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-velocity">
     Effect of velocity
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-composition">
     Effect of composition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#o2-dissociation">
   O2 Dissociation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reactive air shock</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contenuti </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Reactive air shock
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specie-class-definition">
     Specie class definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-species-data">
     Importing species data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reaction-class-definition">
   Reaction class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-reactions-data">
     Importing reactions data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-class-definition">
   Problem class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rh-jump-relations">
     RH jump relations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
     Computation of the chemical source terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-shock-relax-chemistry-funciton">
     Pre-shock relax chemistry funciton
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#energy-version">
     Energy version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-energy-version-depreciated-with-and-without-fsolve">
       Euler system of equation and solve function, energy version  // depreciated, with and without fsolve
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-energy-version">
       Euler system of equation and solve function, energy version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-function-energy-version">
       Solve function, energy version
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-version">
     Temperature version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-temperature-version">
       Euler system of equation and solve function, temperature version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-temperature-version">
       Solve, temperature version
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matte-version-cancellare">
     Matte version CANCELLARE
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-equations">
       Euler equations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-system">
       Solve system
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specie-problem">
   11 specie problem
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-altitude-density">
     Effect of altitude (density)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-velocity">
     Effect of velocity
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-composition">
     Effect of composition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#o2-dissociation">
   O2 Dissociation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="reactive-air-shock">
<h1>Reactive air shock<a class="headerlink" href="#reactive-air-shock" title="Permalink to this headline">¶</a></h1>
<p>In this report a code to compute the chemical relaxation past a shock is developed. [Aggiungere cose]</p>
<p>Firstly, as python is used, the required packages are imported and global variables are defined.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">itg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Kb</span>  <span class="o">=</span> <span class="mf">1.3806503e-23</span><span class="p">;</span>  <span class="c1"># Boltzmann constant [J/K]</span>
<span class="n">amu</span> <span class="o">=</span> <span class="mf">1.66053904020e-24</span><span class="p">;</span> <span class="c1"># 1/Avogadro&#39;s number [mol]</span>
<span class="n">Ru</span> <span class="o">=</span> <span class="n">Kb</span><span class="o">/</span><span class="n">amu</span> <span class="c1">#[J/(K*mol)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">#rtol = 1e-3</span>
<span class="c1">#atol = 1e-6</span>
<span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-16</span>
<span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-16</span>
<span class="n">debug</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># tolleranze per la soluzione due sistemi</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="specie-class-definition">
<h2>Specie class definition<a class="headerlink" href="#specie-class-definition" title="Permalink to this headline">¶</a></h2>
<p>For each specie a common framework is defined which allows to compute thermodynamic derivatives, energy, temperature and other relevant values for the subsequent calculations starting from the data provided by Park and Zanardi.</p>
<p>Assuming that the different contributions can be computed indipendently, the temperature and CVs are defined as the sum of the translational-rotational, vibrational and electronic which are calculated as:</p>
<ul>
<li><p>Translational-rotational :</p>
<ol class="simple">
<li><p>If the molecule is monoatomic, it has no rotational dofs, then <span class="math notranslate nohighlight">\( CV^t = \frac{3}{2} R_{gas} T \)</span></p></li>
<li><p>If the molecule is not monoatomic, the rotational contribution must be added <span class="math notranslate nohighlight">\( CV^{(rt)} = CV^t + R \)</span></p></li>
</ol>
<p>Then, energy is computed as <span class="math notranslate nohighlight">\(e^{tr} = CV  T\)</span>.</p>
</li>
<li><p>Vibrational :
The contribution of vibrational dofs to energy is computed by assuming armhonic oscillator potential. The energy can becomes: <span class="math notranslate nohighlight">\(e^{v} = R_{gas} \frac{\theta_v}{e^{\frac{\theta_v}{T}-1}} \)</span> <br>
The analytical expression for the heat is computed by deriving with respect to T.</p></li>
<li><p>Electronic :
Given the partition function (Zanardi’s tables), the energy due to electronic energy levels is computed as: <span class="math notranslate nohighlight">\( e = R_{gas}T^2 \frac{\partial}{\partial T} log(Z) = \frac{R_gas}{Z} \sum_i g_i \theta_i e^{-\frac{\theta_i}{T}}\)</span>.</p>
<p>Analogously with the vibrational contribution the expression for the specific heat is obtained deriving the formula with respect to T.</p>
</li>
</ul>
<p>All energies are written as sensible energy whose reference temperature is <span class="math notranslate nohighlight">\(T_0 = 293.15 K\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">specie</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">th_v</span><span class="p">,</span> <span class="n">th_r</span><span class="p">,</span> <span class="n">th_d</span><span class="p">,</span> <span class="n">h_form</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_v</span> <span class="o">=</span> <span class="n">th_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_r</span> <span class="o">=</span> <span class="n">th_r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">=</span> <span class="n">th_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_rot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_vib</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_ele</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmol</span> <span class="o">=</span> <span class="n">mmol</span><span class="o">*</span><span class="mf">1e-3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">Kb</span><span class="o">/</span><span class="p">(</span><span class="n">mmol</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span><span class="o">/</span><span class="n">amu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_form</span> <span class="o">=</span> <span class="n">h_form</span>
        <span class="n">specie</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="s1">&#39;Computes the energy and Cv as the sum of translational-rotational, vibrational and electronic contributions&#39;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">T0</span> <span class="o">=</span> <span class="mf">298.15</span>
        
        <span class="c1"># Traslational - rotational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cv_rot</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv_rot</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
            
        <span class="n">e_rot</span>  <span class="o">=</span> <span class="n">cv_rot</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">T0</span><span class="p">)</span>
        
        <span class="c1"># Vibrational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cv_vib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv_vib</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Electronic</span>
        <span class="n">Z</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T</span><span class="p">))</span>
        <span class="n">Z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">))</span>
        <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z10</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
        <span class="n">Z20</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
        <span class="n">e_ele</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z1</span> <span class="o">/</span> <span class="n">Z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z10</span> <span class="o">/</span> <span class="n">Z0</span>
        <span class="n">cv_ele</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">e_ele</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Z2</span> <span class="o">/</span> <span class="n">Z</span><span class="p">)</span>
        
        <span class="c1"># Update Cv and e values</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">cv_rot</span> <span class="o">+</span> <span class="n">cv_vib</span> <span class="o">+</span> <span class="n">cv_ele</span>
        <span class="n">e</span>  <span class="o">=</span> <span class="n">e_rot</span>  <span class="o">+</span> <span class="n">e_vib</span>  <span class="o">+</span> <span class="n">e_ele</span> 
        <span class="n">e</span>  <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T0</span>                         <span class="c1"># Additional term to transform in sensible energy</span>
        <span class="n">e</span>  <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_form</span>
        
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">cv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="importing-species-data">
<h2>Importing species data<a class="headerlink" href="#importing-species-data" title="Permalink to this headline">¶</a></h2>
<p>Species are defined as objects of class specie and properties are defined according to the tables in Zanardi.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N2</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">28.0134</span><span class="p">,</span> <span class="mi">3395</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">113200</span><span class="p">)</span>
<span class="n">N2</span><span class="o">.</span><span class="n">electro_g</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">N2</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.2231565e+04</span><span class="p">,</span> <span class="mf">8.5778626e+04</span><span class="p">,</span> <span class="mf">8.6050267e+04</span><span class="p">,</span> <span class="mf">9.5351186e+04</span><span class="p">,</span> <span class="mf">9.8056357e+04</span><span class="p">,</span>
                          <span class="mf">9.9682677e+04</span><span class="p">,</span> <span class="mf">1.0489765e+05</span><span class="p">,</span> <span class="mf">1.1164896e+05</span><span class="p">,</span> <span class="mf">1.2258365e+05</span><span class="p">,</span> <span class="mf">1.2488569e+05</span><span class="p">,</span> 
                          <span class="mf">1.2824762e+05</span><span class="p">,</span> <span class="mf">1.3380609e+05</span><span class="p">,</span> <span class="mf">1.4042964e+05</span><span class="p">,</span> <span class="mf">1.5049589e+05</span><span class="p">])</span>
<span class="n">N2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;N2&#39;</span>

<span class="n">O2</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">31.9988</span><span class="p">,</span> <span class="mf">2239.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">)</span>
<span class="n">O2</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">O2</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1391560e+04</span><span class="p">,</span> <span class="mf">1.8984739e+04</span><span class="p">,</span> <span class="mf">4.7559736e+04</span><span class="p">,</span> <span class="mf">4.9912421e+04</span><span class="p">,</span> <span class="mf">5.0922686e+04</span><span class="p">,</span>
                         <span class="mf">7.1898633e+04</span><span class="p">])</span>
<span class="n">O2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span>

<span class="n">O</span>  <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">15.9994</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">59500</span><span class="p">,</span> <span class="mf">1.5574e+07</span><span class="p">)</span>
<span class="n">O</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">O</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.2770776e+02</span><span class="p">,</span> <span class="mf">3.2656888e+02</span><span class="p">,</span> <span class="mf">2.2830286e+04</span><span class="p">,</span> <span class="mf">4.8619930e+04</span><span class="p">])</span>
<span class="n">O</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">14.0067</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">113200</span><span class="p">,</span> <span class="mf">3.3747e+07</span><span class="p">)</span>
<span class="n">N</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">N</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.7664696e+04</span><span class="p">,</span> <span class="mf">4.1493093e+04</span><span class="p">])</span>
<span class="n">N</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>

<span class="n">NO</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">30.0061</span><span class="p">,</span> <span class="mf">2817.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">,</span> <span class="mf">3.0091e+6</span><span class="p">)</span>
<span class="n">NO</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">NO</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.4673458e+04</span><span class="p">,</span> <span class="mf">6.3171396e+04</span><span class="p">,</span> <span class="mf">6.5994503e+04</span><span class="p">,</span> <span class="mf">6.9061210e+04</span><span class="p">,</span> <span class="mf">7.0499985e+04</span><span class="p">,</span>
                        <span class="mf">7.4910550e+04</span><span class="p">,</span> <span class="mf">7.6288753e+04</span><span class="p">,</span> <span class="mf">8.6761885e+04</span><span class="p">,</span> <span class="mf">8.7144312e+04</span><span class="p">,</span> <span class="mf">8.8860771e+04</span><span class="p">,</span>
                        <span class="mf">8.9817556e+04</span><span class="p">,</span> <span class="mf">8.9884459e+04</span><span class="p">,</span> <span class="mf">9.0427021e+04</span><span class="p">,</span> <span class="mf">9.0642838e+04</span><span class="p">,</span> <span class="mf">9.1117633e+04</span><span class="p">])</span>
<span class="n">NO</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span>

<span class="n">N2p</span><span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">28.0128514</span><span class="p">,</span> <span class="mf">3395.0</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">113200</span><span class="p">,</span> <span class="mf">5.3886e+07</span><span class="p">)</span>
<span class="n">N2p</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> 
                         <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">N2p</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3189972e+04</span><span class="p">,</span> <span class="mf">3.6633231e+04</span><span class="p">,</span> <span class="mf">3.6688768e+04</span><span class="p">,</span> <span class="mf">5.9853048e+04</span><span class="p">,</span> <span class="mf">6.6183659e+04</span><span class="p">,</span> 
                          <span class="mf">7.5989919e+04</span><span class="p">,</span> <span class="mf">7.6255086e+04</span><span class="p">,</span> <span class="mf">8.2010186e+04</span><span class="p">,</span> <span class="mf">8.4168349e+04</span><span class="p">,</span> <span class="mf">8.6326512e+04</span><span class="p">,</span> 
                         <span class="mf">8.9204062e+04</span><span class="p">,</span> <span class="mf">9.2081613e+04</span><span class="p">,</span> <span class="mf">9.2225490e+04</span><span class="p">,</span> <span class="mf">9.2937684e+04</span><span class="p">,</span> <span class="mf">9.6397938e+04</span><span class="p">,</span> <span class="mf">1.0359181e+05</span><span class="p">])</span>
<span class="n">N2p</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;N2p&#39;</span>

<span class="c1">#O2p= specie(31.9982514, 2239, 2.1, 59500, 3.6592e+07)</span>
<span class="c1">#O2p.electro_g = np.array([3, 2, 1, 1, 6, 3, 3])</span>
<span class="c1">#O2p.electro_th = np.array([0.0, 1.1391560e+04, 1.8984739e+04, 4.7559736e+04, 4.9912421e+04, 5.0922686e+04, 7.1898633e+04])</span>
<span class="c1">#O2p.name = &#39;O2p&#39;</span>
<span class="n">O2p</span><span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">31.9982514</span><span class="p">,</span> <span class="mi">2239</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">,</span> <span class="mf">3.6592e+07</span><span class="p">)</span>
<span class="n">O2p</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">O2p</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.7354408e+04</span><span class="p">,</span> <span class="mf">5.8373987e+04</span><span class="p">,</span> <span class="mf">5.8414273e+04</span><span class="p">,</span> <span class="mf">6.2298966e+04</span><span class="p">,</span> <span class="mf">6.7334679e+04</span><span class="p">,</span>
                          <span class="mf">7.1219372e+04</span><span class="p">,</span> <span class="mf">7.6542841e+04</span><span class="p">,</span> <span class="mf">8.8196920e+04</span><span class="p">,</span> <span class="mf">8.8916307e+04</span><span class="p">,</span> <span class="mf">9.4239776e+04</span><span class="p">,</span> <span class="mf">9.4959163e+04</span><span class="p">,</span>
                          <span class="mf">9.5920265e+04</span><span class="p">,</span> <span class="mf">9.9850999e+04</span><span class="p">,</span> <span class="mf">1.0359181e+05</span><span class="p">])</span>
<span class="n">O2p</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;O2p&#39;</span>


<span class="n">NOp</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">30.0055514</span><span class="p">,</span> <span class="mi">2817</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">,</span> <span class="mf">3.3000e+07</span><span class="p">)</span>
<span class="n">NOp</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">NOp</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.5089678e+04</span><span class="p">,</span> <span class="mf">8.5254624e+04</span><span class="p">,</span> <span class="mf">8.9035726e+04</span><span class="p">,</span> <span class="mf">9.7469826e+04</span><span class="p">,</span> <span class="mf">1.0005530e+05</span><span class="p">,</span> <span class="mf">1.0280337e+05</span><span class="p">,</span> <span class="mf">1.0571386e+05</span><span class="p">])</span>
<span class="n">NOp</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NOp&#39;</span>

<span class="n">Op</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">15.9988514</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">59500</span><span class="p">,</span> <span class="mf">9.8056e+07</span><span class="p">)</span>
<span class="n">Op</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">Op</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.8583347e+04</span><span class="p">,</span> <span class="mf">5.8223492e+04</span><span class="p">])</span>
<span class="n">Op</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Op&#39;</span>

<span class="n">Np</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">14.0061514</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">113200</span><span class="p">,</span> <span class="mf">1.3438e+08</span><span class="p">)</span>
<span class="n">Np</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">Np</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.0068352e+01</span><span class="p">,</span> <span class="mf">1.8819180e+02</span><span class="p">,</span> <span class="mf">2.2036569e+04</span><span class="p">,</span> <span class="mf">4.7031835e+04</span><span class="p">,</span> <span class="mf">6.7312522e+04</span><span class="p">,</span> <span class="mf">1.3271908e+05</span><span class="p">])</span>
<span class="n">Np</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Np&#39;</span>

<span class="n">em</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">0.00054858</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">em</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">em</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;em&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="reaction-class-definition">
<h1>Reaction class definition<a class="headerlink" href="#reaction-class-definition" title="Permalink to this headline">¶</a></h1>
<p>A reaction is defined by the soichometric coefficients, the reactants, the products and the reaction rate coefficients. The latter are computed as follows:</p>
<ul class="simple">
<li><p>Forward reaction coefficient :       <span class="math notranslate nohighlight">\(k_f\)</span> is expressed as <span class="math notranslate nohighlight">\(k_f = C_f T ^{\eta_f}e^{\frac{\theta_d}{T}}\)</span> (coefficients from Park’s tables)</p></li>
<li><p>Equilibrium reaction coefficient :   <span class="math notranslate nohighlight">\(k_c\)</span> is computed from the polynomial interpolation by Park</p></li>
<li><p>Backward reaction coefficient:       <span class="math notranslate nohighlight">\(k_b\)</span> is computed as <span class="math notranslate nohighlight">\(k_b = \frac{k_f}{k_c}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">subreaction</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">stoichr</span><span class="p">,</span> <span class="n">stoichp</span><span class="p">,</span> <span class="n">Cf</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">th_d</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">=</span> <span class="n">reactants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">products</span>  <span class="o">=</span> <span class="n">products</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stoichr</span>   <span class="o">=</span> <span class="n">stoichr</span> <span class="c1"># Stoichometric coefficient ordered as [reactants, products]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stoichp</span>   <span class="o">=</span> <span class="n">stoichp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span>        <span class="o">=</span> <span class="n">Cf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nf</span>        <span class="o">=</span> <span class="n">nf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_d</span>      <span class="o">=</span> <span class="n">th_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span>         <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_mol</span>     <span class="o">=</span> <span class="kc">None</span>

        
    <span class="k">def</span> <span class="nf">kf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">kf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span> <span class="o">*</span> <span class="n">T</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kf</span>
        
    <span class="k">def</span> <span class="nf">kb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">kb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">kc</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kb</span>
    
    <span class="k">def</span> <span class="nf">kc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="n">T</span> <span class="c1"># from Zanardi&#39;s 2.5.1 Chemical Kinetic Model</span>
        <span class="c1"># kc = np.exp(np.dot(Z ** np.arange(0,5), self.A))</span>
        <span class="n">kc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">kc</span> <span class="o">=</span> <span class="mf">1e-15</span>
        <span class="k">return</span> <span class="n">kc</span>
    
    
<span class="k">class</span> <span class="nc">reaction</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">e_mol</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subreactions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_mol</span>        <span class="o">=</span> <span class="n">e_mol</span>
    
    
    <span class="k">def</span> <span class="nf">add_subreaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subr</span><span class="p">):</span>
        <span class="n">subr</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span>
        <span class="n">subr</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_mol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subreactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="importing-reactions-data">
<h2>Importing reactions data<a class="headerlink" href="#importing-reactions-data" title="Permalink to this headline">¶</a></h2>
<p>Reacttions data are taken from Park’s tables</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># I devide the constant rate Cf for 1e6 to convert from cm3/mol to m3/mol</span>
<span class="c1"># I also multiplicate e_mol for 4184 in order to convert Kcal/mol in J/mol</span>

<span class="c1">###O2diss = reaction([1.335, -4.127, 0.616, 0.093, -0.005], -117.98*4184)</span>
<span class="n">O2diss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span><span class="mf">1.335</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.127</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.616</span><span class="p">,</span> <span class="mf">0.093</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.005</span><span class="p">],</span> <span class="o">-</span><span class="mf">117.98</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.32e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N2diss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span> <span class="mf">3.898</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.611</span><span class="p">,</span> <span class="mf">0.683</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.118</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">],</span> <span class="o">-</span><span class="mf">225.00</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.10e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e24</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NOdiss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span><span class="mf">1.549</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.784</span><span class="p">,</span> <span class="mf">0.228</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.043</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">],</span> <span class="o">-</span><span class="mf">150.03</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span> 
<span class="c1">###NOdiss.add_subreaction(subreaction([NO, N], [N, O, N], [1, 1], [1, 1, 1], 4.6e17/1e6,</span>
<span class="c1">###                                  -0.5, 75500))</span>
<span class="c1">###NOdiss.add_subreaction(subreaction([NO, O], [N, O, O], [1, 1], [1, 1, 1], 4.6e17/1e6,</span>
<span class="c1">###                                  -0.5, 75500))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">7.36e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Exchange reactions</span>
<span class="n">NO_O</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.16e8</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mi">19220</span><span class="p">)</span>
<span class="n">NO_O</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.215</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.657</span><span class="p">,</span> <span class="mf">0.843</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.136</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">])</span>
<span class="n">NO_O</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">32.05</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O_N2</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">3.18e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">37700</span><span class="p">)</span>
<span class="n">O_N2</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.349</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.828</span><span class="p">,</span> <span class="mf">0.455</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">])</span>
<span class="n">O_N2</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">74.97</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O_O2p</span>      <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">O2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">6.85e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.520</span><span class="p">,</span> <span class="mi">18600</span><span class="p">)</span>
<span class="n">O_O2p</span><span class="o">.</span><span class="n">A</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.411</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.998</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">])</span>
<span class="n">O_O2p</span><span class="o">.</span><span class="n">e_mol</span><span class="o">=</span> <span class="o">-</span><span class="mf">36.88</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N2_Np</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">9.85e12</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.180</span><span class="p">,</span> <span class="mi">12100</span><span class="p">)</span>
<span class="n">N2_Np</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.963</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.116</span><span class="p">,</span> <span class="mf">0.692</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.103</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">])</span>
<span class="n">N2_Np</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">24.06</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O_NOp</span>      <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">NO</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">,</span> <span class="mi">51000</span><span class="p">)</span>
<span class="n">O_NOp</span><span class="o">.</span><span class="n">A</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.705</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.223</span><span class="p">,</span> <span class="mf">0.522</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.090</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">])</span>
<span class="n">O_NOp</span><span class="o">.</span><span class="n">e_mol</span><span class="o">=</span> <span class="o">-</span><span class="mf">101.34</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N2_Op</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">6.33e16</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.210</span><span class="p">,</span> <span class="mi">22200</span><span class="p">)</span>
<span class="n">N2_Op</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.391</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.443</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.080</span><span class="p">,</span> <span class="mf">0.027</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">])</span>
<span class="n">N2_Op</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">44.23</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N_NOp</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">NO</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.21e15</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020</span><span class="p">,</span> <span class="mi">61100</span><span class="p">)</span>
<span class="n">N_NOp</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.132</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.550</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.249</span><span class="p">,</span> <span class="mf">0.041</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">])</span>
<span class="n">N_NOp</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">121.51</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O2_NOp</span>      <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">NO</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.03e16</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.170</span><span class="p">,</span> <span class="mi">32400</span><span class="p">)</span>
<span class="n">O2_NOp</span><span class="o">.</span><span class="n">A</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.115</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.225</span><span class="p">,</span> <span class="mf">0.524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.095</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">])</span>
<span class="n">O2_NOp</span><span class="o">.</span><span class="n">e_mol</span><span class="o">=</span> <span class="o">-</span><span class="mf">64.46</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">NOp_N</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">NOp</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N2p</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.7e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.400</span><span class="p">,</span> <span class="mi">35500</span><span class="p">)</span>
<span class="n">NOp_N</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.746</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.013</span><span class="p">,</span> <span class="mf">0.013</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">])</span>
<span class="n">NOp_N</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">70.60</span><span class="o">*</span><span class="mi">4184</span>

<span class="c1"># Associative ionization</span>
<span class="n">O___N</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">NOp</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.53e11</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.370</span><span class="p">,</span> <span class="mi">3200</span><span class="p">)</span>
<span class="n">O___N</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">6.234</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.536</span><span class="p">,</span> <span class="mf">0.494</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.058</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">])</span>
<span class="n">O___N</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">63.69</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O___O</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">O2p</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">3.85e11</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.490</span><span class="p">,</span> <span class="mi">80600</span><span class="p">)</span>
<span class="n">O___O</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.904</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.418</span><span class="p">,</span> <span class="mf">1.861</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.288</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">])</span>
<span class="n">O___O</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">160.20</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N___N</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N2p</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.79e11</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.770</span><span class="p">,</span> <span class="mi">67500</span><span class="p">)</span>
<span class="n">N___N</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.488</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.374</span><span class="p">,</span> <span class="mf">0.481</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.044</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">])</span>
<span class="n">N___N</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">134.29</span><span class="o">*</span><span class="mi">4184</span>

<span class="c1"># Electron impact ionization</span>
<span class="n">O_ion</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">Op</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">3.9e33</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.780</span><span class="p">,</span> <span class="mi">158500</span><span class="p">)</span>
<span class="n">O_ion</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.980</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.534</span><span class="p">,</span> <span class="mf">1.244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.190</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">])</span>
<span class="n">O_ion</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">315.06</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N_ion</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">Np</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">2.5e34</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.820</span><span class="p">,</span> <span class="mi">168600</span><span class="p">)</span>
<span class="n">N_ion</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.553</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.870</span><span class="p">,</span> <span class="mf">0.472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.060</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">])</span>
<span class="n">N_ion</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">335.23</span><span class="o">*</span><span class="mi">4184</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="problem-class-definition">
<h1>Problem class definition<a class="headerlink" href="#problem-class-definition" title="Permalink to this headline">¶</a></h1>
<p>We define a class problem so that several condition can be studied, analyzed, compared and contrasted.</p>
<p>The initial conditions for the shock relaxation region are obtained by assuming frozen chemistry through the shock which, in the Euler equations framework is a discontinuity whose jumps are defined by the Rankine-Hugoniot relations.</p>
<p>The variable are mixture density, velocity, energy and mixture mass fractions.</p>
<p>For the mixture considered the the following relations hold:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e_{mixture} = \Sigma_i e_i Y_i \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(CV_{mixture} = \Sigma_i CV_i Y_i \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{mixture} = \Sigma_i R_i Y_i \)</span></p></li>
</ul>
<p>The system of equation in the relaxation region is written as :</p>
<ul class="simple">
<li><p>Mass equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0\)</span></p></li>
<li><p>Momentum equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \)</span> <br>
Since <span class="math notranslate nohighlight">\( P = P(\rho, e, Y) = \rho \Sigma_i Y_i R T \)</span> , then <span class="math notranslate nohighlight">\( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial e} d e + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)</span>  <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R T \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial e} = \frac{\partial P}{\partial T}\frac{\partial T}{\partial e} = \rho \frac{\Sigma_i Y_i R}{CV_{mixture}}\)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial Y_i} = \rho R T\)</span> <br>
Hence, the momentum equation can be written as : <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R T \frac{\partial \rho}{\partial x} + \rho \frac{\Sigma_i Y_i R}{CV_{mixture}} \frac{\partial e}{\partial x } + \rho R T \Sigma_i \frac{Y_i}{x}\)</span></p></li>
</ul>
</li>
<li><p>Energy equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\)</span></p></li>
<li><p>Species transport equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">problem</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specie</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>     <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mi">300</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">1.225</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">3000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>     <span class="o">=</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="mf">6.2</span> <span class="o">*</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1"># Sigma HS nitrogen</span>
    
    <span class="k">def</span> <span class="nf">add_specie_ic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specie</span><span class="p">,</span> <span class="n">Y0</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">specie</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y0</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y0</span>
        
    <span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">R</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">R</span>
    
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">CV1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">CV</span> <span class="o">+</span> <span class="n">CV1</span><span class="o">*</span><span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">CV</span>        
    
    <span class="k">def</span> <span class="nf">e_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of energy wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="n">e_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y</span><span class="p">)):</span>
            <span class="n">e_Y</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">inutile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y</span>
        
    <span class="k">def</span> <span class="nf">only_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span> <span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">CV1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e</span>    
    
    <span class="k">def</span> <span class="nf">T_from_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">T0</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
        
        <span class="n">T</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">T</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0</span><span class="p">,</span> 
                                            <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_from_e did not converge&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rh-jump-relations">
<h2>RH jump relations<a class="headerlink" href="#rh-jump-relations" title="Permalink to this headline">¶</a></h2>
<p>Firstly, the Rankine Hugoniot relations are solved for a perfect gas with the same R of the mixture and the isoentropic coefficient <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>. <br>
Then, the results obtained are used as guess to initialize the non-linear solver. The Rankine-Hugoniot relations read: <br></p>
<p>\begin{cases}
\rho_0 u_0 = \rho_1 u \
\rho_0 u_0^2 + P_0 = \rho_1 u_1^2 + P_1 \
h_0^t  = e_0 + \frac{P_0}{\rho_0} + \frac{1}{2}u_0^2 =
e_1 + \frac{P_1}{\rho_1} + \frac{1}{2} u_1^2 = h_1^t
\end{cases}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RHsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">rho2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span>
    <span class="n">e2</span><span class="p">,</span> <span class="n">CV2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
    
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">e0</span><span class="p">,</span> <span class="n">CV0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">out_rho</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">)</span>                       <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="n">out_mom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>  <span class="n">p0</span><span class="p">)</span>            <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
    <span class="n">out_ene</span> <span class="o">=</span> <span class="p">(</span><span class="n">e0</span> <span class="o">+</span> <span class="n">p0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">-</span> <span class="p">(</span><span class="n">e2</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">/</span> <span class="n">rho2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u2</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>
      
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">out_rho</span><span class="p">,</span> <span class="n">out_mom</span><span class="p">,</span> <span class="n">out_ene</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rho2, T2, u2 : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">out</span>

    
<span class="k">def</span> <span class="nf">RHjump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Build a guess assuming perfect gas with gamma = 1.4</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">M0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">/</span> <span class="n">c0</span>
    <span class="n">M2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">p2</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
    <span class="n">T2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">);</span> 
    <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">M2</span><span class="p">;</span>
        
    <span class="c1"># Solve RH relations</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RHsystem</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> 
                                     <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># , epsfcn=1e-8, factor = 0.1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RH not converged&#39;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Compute reference post shock mean free path</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    <span class="n">mmixt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mmol</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">=</span> <span class="n">Kb</span> <span class="o">*</span> <span class="n">T2</span> <span class="o">/</span> <span class="n">p2</span>  <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cv2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">cp</span> <span class="o">/</span> <span class="n">cv2</span>
    <span class="n">c2c</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">M2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">/</span> <span class="n">c2c</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre shock Mach : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock guess values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2c</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reference mean free path : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speed is negative!!! Look at RHjump&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;EXITING&quot;</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">RHsystem</span> <span class="o">=</span> <span class="n">RHsystem</span>
<span class="n">problem</span><span class="o">.</span><span class="n">RHjump</span> <span class="o">=</span> <span class="n">RHjump</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computation-of-the-chemical-source-terms">
<h2>Computation of the chemical source terms<a class="headerlink" href="#computation-of-the-chemical-source-terms" title="Permalink to this headline">¶</a></h2>
<p>To compute the chemical sources for each specie, for each reaction the specie mass fraction vector is transformed in “local” number densities which are multiplied by the forward and backward reaction coefficients as defined before to compute the reaction rate. <br>
According to the Park’s definition of forward and backward coefficients, the reaction rate is computed as: <br></p>
<p><span class="math notranslate nohighlight">\( K_f \Pi_{i = 0}^{N_{reactants}} \)</span></p>
<p>Finally, the generated/destroyed species are expressed in terms of “global” mass fraction rate and summed for each reaction and sub-reaction.</p>
<p>[Aggiungere] and the released energy is computed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Se</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">reaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">)):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Transform the global y vector to the local n vector</span>
                <span class="n">nr_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">np_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">w_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">nr_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                <span class="c1">#breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">w_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">w_s</span>
                <span class="c1"># S += mmol * (np.matmul(np.transpose(omegap), obj.stoichp) - np.matmul(  np.transpose(omegar), obj.stoichr)) * w_s</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">subreaction</span><span class="p">):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="c1"># Transform the global y vector to the local n vector</span>
                <span class="n">nr_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">np_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">w_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">nr_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                
                <span class="c1"># breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">w_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">w_s</span>
                
                
        <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Member of the reaction group of this problem are ill-defined&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Se = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">Se</span>

<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sy</span> <span class="o">=</span> <span class="n">compute_Sy</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pre-shock-relax-chemistry-funciton">
<h2>Pre-shock relax chemistry funciton<a class="headerlink" href="#pre-shock-relax-chemistry-funciton" title="Permalink to this headline">¶</a></h2>
<p>Starting from the given composition, the equilibrium composition in the reference state (pre-shock) is computed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pre_shock_relax_chemistry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Y</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>
    <span class="n">Sy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Sy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">)):</span>
        
        <span class="n">Sy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
        <span class="n">Y</span> <span class="o">+=</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">Sy</span>
        <span class="k">if</span> <span class="n">output</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; concentration : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;    Sorgente : &#39;</span>  <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">Sy</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Species not conserved in pre-shock relax&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y less than 0 in chemical relax pre - shock&#39;</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">Y</span>

<span class="n">problem</span><span class="o">.</span><span class="n">pre_shock_relax_chemistry</span> <span class="o">=</span> <span class="n">pre_shock_relax_chemistry</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="energy-version">
<h2>Energy version<a class="headerlink" href="#energy-version" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euler-system-of-equation-and-solve-function-energy-version-depreciated-with-and-without-fsolve">
<h3>Euler system of equation and solve function, energy version  // depreciated, with and without fsolve<a class="headerlink" href="#euler-system-of-equation-and-solve-function-energy-version-depreciated-with-and-without-fsolve" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="euler-system-of-equation-and-solve-function-energy-version">
<h3>Euler system of equation and solve function, energy version<a class="headerlink" href="#euler-system-of-equation-and-solve-function-energy-version" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="solve-function-energy-version">
<h3>Solve function, energy version<a class="headerlink" href="#solve-function-energy-version" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="temperature-version">
<h2>Temperature version<a class="headerlink" href="#temperature-version" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euler-system-of-equation-and-solve-function-temperature-version">
<h3>Euler system of equation and solve function, temperature version<a class="headerlink" href="#euler-system-of-equation-and-solve-function-temperature-version" title="Permalink to this headline">¶</a></h3>
<p>In this case the primary variables considered are density, velocity, mass fractions and temperature. \</p>
<p>The equations read:</p>
<ul class="simple">
<li><p>Mass equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0\)</span></p></li>
<li><p>Momentum equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \)</span> <br>
Since <span class="math notranslate nohighlight">\( P = P(\rho, T, Y) = \rho \Sigma_i Y_i R T \)</span> , then <span class="math notranslate nohighlight">\( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T} d T + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)</span>  <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_u T \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial T} = \rho \Sigma_i Y_i R_u\)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial Y_i} = \rho R_u T\)</span> <br>
Hence, the momentum equation can be written as : <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R T \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_u \frac{\partial T}{\partial x} + \rho R T \Sigma_i \frac{Y_i}{x}\)</span></p></li>
</ul>
</li>
<li><p>Energy equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\)</span> <br>
In analogy with the pressure, we have <span class="math notranslate nohighlight">\( e = e (T, Y_i) \)</span>, then <span class="math notranslate nohighlight">\( de = \frac{\partial e }{\partial T} dT + \Sigma \frac{\partial e }{\partial Y_i} dY_i\)</span> <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial T} = cv(T, Y_i) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial Y_i} = e_i(T) \)</span> <br>
Hence, the energy equation can be written as : <br>
$ \frac{\partial T}{\partial x} = \frac{1}{cv} [ \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \Sigma_i e_i(T) \frac{\partialY_</p></li>
</ul>
</li>
<li><p>Species transport equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In this block one of the primary variables is temperature and not energy</span>

<span class="k">def</span> <span class="nf">Euler_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    <span class="n">rho_x</span><span class="p">,</span> <span class="n">u_x</span><span class="p">,</span> <span class="n">T_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span> <span class="p">)</span>
    <span class="n">e_Y</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1"># Manca Kb /mmol o sbaglio? o R magari          [OK]</span>
    <span class="c1">## p_x = np.sum(rho_x * Y  * Ru * T + rho * Y_x * T * Ru + rho * Y * Ru * T_x)</span>
    <span class="n">p_x</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1">##p_x = (self.R(Y)*T*Y)* rho_x + (rho*self.R(Y)*Y)* T_x</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">p_x</span> <span class="o">+=</span> <span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T_x</span>
        <span class="c1">##p_x += (rho*self.R(Y)*T)*Y_x[t]</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First term of the derivative p_x: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    
    <span class="c1"># p = self.R(Y) * rho * T </span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span>
    
    <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system R                                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho_x            : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system cv               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system p                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>

    <span class="c1"># Mass equation</span>
    <span class="n">rho_xc</span> <span class="o">=</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">u_x</span>
    
    <span class="c1"># Momentum equation</span>
    <span class="n">u_xc</span>  <span class="o">=</span> <span class="o">-</span>  <span class="n">p_x</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    
    <span class="c1"># print(&#39;rho_x              : &#39; + str(rho_x))</span>
    <span class="c1"># print(&#39;p                  : &#39; + str(p))</span>
    <span class="c1"># print(&#39;rho                : &#39; + str(rho))</span>
    <span class="c1"># print(&#39;e_Y                : &#39; + str(e_Y))</span>
    <span class="c1"># print(&#39;Y_x                : &#39; + str(Y_x))</span>
    <span class="c1"># print(&#39;sum(e_Y * Y_x)     : &#39; + str(np.sum(e_Y * Y_x)))</span>
    <span class="c1"># print(&#39;cv                 : &#39; + str(cv))</span>
    <span class="c1"># Energy equation</span>
    <span class="n">T_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho_x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">))</span> <span class="o">/</span> <span class="n">cv</span>
    <span class="c1"># print(&#39;T_xc              : &#39; + str(T_xc))</span>

    <span class="c1">#e_xc  = p / rho ** 2 * rho_x + Se + rho * u_x + 1 / 2 * rho_x * u</span>
    
    <span class="c1"># Species equations</span>
    <span class="n">Y_xc</span>  <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    <span class="n">x_xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho_xc</span><span class="p">]</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_xc</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Y_xc</span><span class="p">:</span>
        <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_c              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x - x_c        : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system S                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        
        
    <span class="k">return</span>   <span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span>
    
<span class="k">def</span> <span class="nf">Euler_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_spatial</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A Solving for x = </span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_spatial</span>, end=&quot;&quot;)
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;State values  = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        
        <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
            <span class="n">x0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        
        <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
                                            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>  
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler_x did not converge&#39;</span><span class="p">)</span>    
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="c1"># print(&#39;x_x = &#39; + str(x_x))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ier = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ier</span><span class="p">))</span>
            
        
        <span class="k">return</span> <span class="n">x_x</span>
    
    
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_system</span> <span class="o">=</span> <span class="n">Euler_system</span>
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_x</span> <span class="o">=</span> <span class="n">Euler_x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solve-temperature-version">
<h3>Solve, temperature version<a class="headerlink" href="#solve-temperature-version" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># Compute post shock values to be used as initial conditions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RHjump</span><span class="p">()</span>
    
    <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x</span><span class="p">,</span> 
                              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">,</span>
                              <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">:,:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span>
    
    <span class="c1"># Compute energy</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">)):</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">=</span> <span class="n">e</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="o">=</span> <span class="n">p</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span> <span class="o">=</span> <span class="n">solve</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="matte-version-cancellare">
<h2>Matte version CANCELLARE<a class="headerlink" href="#matte-version-cancellare" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euler-equations">
<h3>Euler equations<a class="headerlink" href="#euler-equations" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="solve-system">
<h3>Solve system<a class="headerlink" href="#solve-system" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="plot">
<h1>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;T [K]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;rho [Kg/m3]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity [m/s]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">logplot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">print_max</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;For validation purpuses, the fluxes of conserved values are plotted as a function of x&#39;&#39;&#39;</span>
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="c1"># Compute and plot mass flux</span>

    <span class="n">subaxes_mass</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mass_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span>
    <span class="n">error_mass_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_flux</span> <span class="o">-</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass2</span> <span class="o">=</span> <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass flux [Kg/s]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot momentum flux</span>
    <span class="n">subaxes_momentum</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">momentum_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> 
    <span class="n">error_momentum_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">momentum_flux</span> <span class="o">-</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_momentum2</span> <span class="o">=</span> <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Momentum flux [Pa * m / s]&#39;</span><span class="p">)</span>  <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot total enthalpy flux</span>
    <span class="n">subaxes_enthalpy</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> 
    <span class="n">error_enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">enthalpy_flux</span> <span class="o">-</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_enthalpy2</span> <span class="o">=</span> <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;enthalpy flux [J/ms]&#39;</span><span class="p">)</span> <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="c1">#     # Compute and plot energy flux</span>
<span class="c1">#     subaxes_energy     = plt.subplot(5, 1, 4)</span>
<span class="c1">#     energy_flux = (self.sol_rho * ( self.sol_e + 1 / 2 * self.sol_u ** 2 )) * self.sol_u </span>
<span class="c1">#     error_energy_flux = ( energy_flux - energy_flux[0] ) / energy_flux[0]</span>
<span class="c1">#     subaxes_energy.plot(self.sol_x, error_energy_flux, ls)</span>
    
<span class="c1">#     subaxes_energy2 = subaxes_energy.twiny()</span>
<span class="c1">#     subaxes_energy2.plot(x_lambda, error_energy_flux, ls)</span>
    
<span class="c1">#     # Set labels etc.</span>
<span class="c1">#     subaxes_energy.set_xlim(0, xmax)</span>
<span class="c1">#     subaxes_energy2.set_xlim(0, xmax / self.mfp)</span>
<span class="c1">#     subaxes_energy.set_xlabel(&#39;x [m]&#39;)</span>
<span class="c1">#     subaxes_energy2.set_xlabel(&#39;x / reference mfp [-]&#39;)</span>
<span class="c1">#     subaxes_energy.set_ylabel(&#39;Energy flux [J/ms]&#39;) # CANCELLARE controllare unità di misura o toglierle</span>
<span class="c1">#     subaxes_energy2.grid()</span>
<span class="c1">#     subaxes_energy.yaxis.grid(True)</span>
    
    <span class="c1"># Compute and plot sum of mass fractions</span>
    <span class="n">subaxes_mass_frac</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">mass_frac_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
    <span class="n">error_mass_frac_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_frac_flux</span> <span class="o">-</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass_frac2</span> <span class="o">=</span> <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum of mass fractions [-]&#39;</span><span class="p">)</span> 
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_max</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass flux error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum momentum flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_momentum_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum enthalpy flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_enthalpy_flux</span><span class="p">))))</span>
        <span class="c1"># print(&#39;Maximum energy flux error     : &#39; + str(np.max(np.abs(error_energy_flux))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass frac error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_frac_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last value of mass flux       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass_flux</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ymin                          : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">)))</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">plot_T</span> <span class="o">=</span> <span class="n">plot_T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_rho</span> <span class="o">=</span> <span class="n">plot_rho</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_u</span> <span class="o">=</span> <span class="n">plot_u</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_Y</span> <span class="o">=</span> <span class="n">plot_Y</span>
<span class="n">problem</span><span class="o">.</span><span class="n">logplot_Y</span> <span class="o">=</span> <span class="n">logplot_Y</span>
<span class="n">problem</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="n">validate</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="specie-problem">
<h1>11 specie problem<a class="headerlink" href="#specie-problem" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_11specie</span> <span class="o">=</span> <span class="n">problem</span><span class="p">()</span>

<span class="c1"># Add species </span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">NO</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">N</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O2p</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">NOp</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">N2p</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">Np</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">Op</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">em</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Add reactions</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O2diss</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2diss</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NOdiss</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NO_O</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_N2</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_O2p</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2_Np</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_NOp</span> <span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2_Op</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N_NOp</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O2_NOp</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NOp_N</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O___N</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O___O</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N___N</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_ion</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N_ion</span><span class="p">)</span>

<span class="c1"># Set ic</span>
<span class="c1"># caso 1 di Matte (stessi di Park)    CANCELLARE</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mf">247.02</span> <span class="c1"># 300</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">3.097e-4</span> <span class="c1">#1.225</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">5062</span> <span class="c1">#3000</span>

<span class="c1"># Solve</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre shock Mach : 16.000562605530575
******************************
Post-shock guess values:
rho    : 0.0018226047541988338
T      : 12530.13407323571
Speed  : 860.1433724938996
Mach   : 0.3817439471343904
******************************
Post-shock values:
rho    : 0.0023988886158463254
T      : 9986.617517088329
Speed  : 653.5115426553153
Mach   : 0.34284740141105646
******************************
Reference mean free path : 2.168525552716173e-05

A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/lib/python3/dist-packages/scipy/integrate/_ivp/common.py:40: UserWarning: The following arguments have no effect for a chosen solver: `args`.
  warn(&quot;The following arguments have no effect for a chosen solver: {}.&quot;
/usr/lib/python3/dist-packages/scipy/integrate/_ivp/common.py:47: UserWarning: `rtol` is too low, setting to 2.220446049250313e-14
  warn(&quot;`rtol` is too low, setting to {}&quot;.format(100 * EPS))
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 0.000000000000e+00
A Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.168525552716e-10
A Solving for x = 6.278879372486e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.278879372486e-11
A Solving for x = 1.255775874497e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.255775874497e-10
A Solving for x = 2.599714584412e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.599714584412e-10
A Solving for x = 3.943653294328e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.943653294328e-10
A Solving for x = 5.287592004243e-10
A Solving for x = 5.287592004243e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.174435674818e-10
A Solving for x = 8.174435674818e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.106127934539e-09
A Solving for x = 1.106127934539e-09
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.394812301597e-09
A Solving for x = 1.394812301597e-09
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.683496668654e-09
A Solving for x = 1.683496668654e-09
A Solving for x = 2.526386563335e-09
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.526386563335e-09
A Solving for x = 3.369276458016e-09
A Solving for x = 3.369276458016e-09
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.212166352696e-09
A Solving for x = 4.212166352696e-09
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.082920394024e-09
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.082920394024e-09
A Solving for x = 1.195367443535e-08
A Solving for x = 1.195367443535e-08
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.582442847668e-08
A Solving for x = 1.582442847668e-08
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.934720089681e-08
A Solving for x = 2.934720089681e-08
A Solving for x = 4.286997331693e-08
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.286997331693e-08
A Solving for x = 5.639274573706e-08
A Solving for x = 5.639274573706e-08
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.199625336679e-08
A Solving for x = 8.199625336679e-08
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.075997609965e-07
A Solving for x = 1.075997609965e-07
A Solving for x = 1.332032686263e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.332032686263e-07
A Solving for x = 1.588067762560e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.588067762560e-07
A Solving for x = 2.222409845111e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.222409845111e-07
A Solving for x = 2.856751927662e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.856751927662e-07
A Solving for x = 3.491094010213e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.491094010213e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.125436092763e-07
A Solving for x = 4.125436092763e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.040705654196e-07
A Solving for x = 6.040705654196e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.955975215629e-07
A Solving for x = 7.955975215629e-07
A Solving for x = 9.871244777062e-07
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 9.871244777062e-07
A Solving for x = 1.178651433850e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.178651433850e-06
A Solving for x = 1.443169021005e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.443169021005e-06
A Solving for x = 1.707686608161e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.707686608161e-06
A Solving for x = 1.972204195317e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.972204195317e-06
A Solving for x = 2.236721782473e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.236721782473e-06
A Solving for x = 2.501239369629e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.501239369629e-06
A Solving for x = 3.183483594607e-06
A Solving for x = 3.183483594607e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.865727819586e-06
A Solving for x = 3.865727819586e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.547972044565e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.547972044565e-06
A Solving for x = 5.230216269544e-06
A Solving for x = 5.230216269544e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.912460494523e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.912460494523e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.733471320634e-06
A Solving for x = 6.733471320634e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.554482146745e-06
A Solving for x = 7.554482146745e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.375492972856e-06
A Solving for x = 8.375492972856e-06
A Solving for x = 9.196503798968e-06
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 9.196503798968e-06
A Solving for x = 1.001751462508e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.001751462508e-05
A Solving for x = 1.083852545119e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.083852545119e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.223881644504e-05
A Solving for x = 1.363910743889e-05
A Solving for x = 1.363910743889e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.503939843273e-05
A Solving for x = 1.503939843273e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.643968942658e-05
A Solving for x = 1.643968942658e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.783998042043e-05
A Solving for x = 1.783998042043e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 1.924027141428e-05
A Solving for x = 1.924027141428e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.102023026293e-05
A Solving for x = 2.102023026293e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.280018911157e-05
A Solving for x = 2.280018911157e-05
A Solving for x = 2.458014796022e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.458014796022e-05
A Solving for x = 2.636010680887e-05
A Solving for x = 2.636010680887e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.814006565752e-05
A Solving for x = 2.814006565752e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 2.992002450616e-05
A Solving for x = 2.992002450616e-05
A Solving for x = 3.169277158279e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.169277158279e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.346551865941e-05
A Solving for x = 3.346551865941e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.523826573603e-05
A Solving for x = 3.523826573603e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.701101281265e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.701101281265e-05
A Solving for x = 3.878375988927e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 3.878375988927e-05
A Solving for x = 4.055650696589e-05
A Solving for x = 4.055650696589e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.233482599656e-05
A Solving for x = 4.233482599656e-05
A Solving for x = 4.411314502723e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.411314502723e-05
A Solving for x = 4.589146405789e-05
A Solving for x = 4.589146405789e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.766978308856e-05
A Solving for x = 4.766978308856e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 4.944810211923e-05
A Solving for x = 4.944810211923e-05
A Solving for x = 5.122642114989e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.122642114989e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.302435505769e-05
A Solving for x = 5.302435505769e-05
A Solving for x = 5.482228896548e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.482228896548e-05
A Solving for x = 5.662022287327e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.662022287327e-05
A Solving for x = 5.841815678106e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 5.841815678106e-05
A Solving for x = 6.021609068886e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.021609068886e-05
A Solving for x = 6.201402459665e-05
A Solving for x = 6.201402459665e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.383156381779e-05
A Solving for x = 6.383156381779e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.564910303893e-05
A Solving for x = 6.564910303893e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.746664226007e-05
A Solving for x = 6.746664226007e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 6.928418148122e-05
A Solving for x = 6.928418148122e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.110172070236e-05
A Solving for x = 7.110172070236e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.291925992350e-05
A Solving for x = 7.291925992350e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.475575193932e-05
A Solving for x = 7.475575193932e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.659224395515e-05
A Solving for x = 7.659224395515e-05
A Solving for x = 7.842873597097e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 7.842873597097e-05
A Solving for x = 8.026522798680e-05
A Solving for x = 8.026522798680e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.210172000262e-05
A Solving for x = 8.210172000262e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.393821201845e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.393821201845e-05
A Solving for x = 8.579443058873e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.579443058873e-05
A Solving for x = 8.765064915901e-05
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A Solving for x = 8.765064915901e-05
A Solving for x = 8.950686772929e-05
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_57670</span><span class="o">/</span><span class="mf">109356891.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> 
<span class="g g-Whitespace">     </span><span class="mi">41</span> <span class="c1"># Solve</span>
<span class="ne">---&gt; </span><span class="mi">42</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="nn">/tmp/ipykernel_57670/3187716142.py</span> in <span class="ni">solve</span><span class="nt">(self, xf)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>         <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> 
<span class="ne">---&gt; </span><span class="mi">11</span>     <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">12</span>                               <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>                               <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/integrate/_ivp/ivp.py</span> in <span class="ni">solve_ivp</span><span class="nt">(fun, t_span, y0, method, t_eval, dense_output, events, vectorized, **options)</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span>     <span class="n">status</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span>     <span class="k">while</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">502</span>         <span class="n">message</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span> 
<span class="g g-Whitespace">    </span><span class="mi">504</span>         <span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;finished&#39;</span><span class="p">:</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/integrate/_ivp/base.py</span> in <span class="ni">step</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>             <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
<span class="ne">--&gt; </span><span class="mi">182</span>             <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_impl</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span> 
<span class="g g-Whitespace">    </span><span class="mi">184</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/integrate/_ivp/bdf.py</span> in <span class="ni">_step_impl</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">352</span>                     <span class="n">LU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">J</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span> 
<span class="ne">--&gt; </span><span class="mi">354</span>                 <span class="n">converged</span><span class="p">,</span> <span class="n">n_iter</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">solve_bdf_system</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>                     <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_new</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">LU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_lu</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span>                     <span class="n">scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newton_tol</span><span class="p">)</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/integrate/_ivp/bdf.py</span> in <span class="ni">solve_bdf_system</span><span class="nt">(fun, t_new, y_predict, c, psi, LU, solve_lu, scale, tol)</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="n">converged</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">     </span><span class="mi">43</span>     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NEWTON_MAXITER</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">44</span>         <span class="n">f</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t_new</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span>             <span class="k">break</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/integrate/_ivp/base.py</span> in <span class="ni">fun</span><span class="nt">(t, y)</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>         <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>             <span class="bp">self</span><span class="o">.</span><span class="n">nfev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">139</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_single</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span> 
<span class="g g-Whitespace">    </span><span class="mi">141</span>         <span class="bp">self</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">fun</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/integrate/_ivp/base.py</span> in <span class="ni">fun_wrapped</span><span class="nt">(t, y)</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> 
<span class="g g-Whitespace">     </span><span class="mi">20</span>     <span class="k">def</span> <span class="nf">fun_wrapped</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">21</span>         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span> 
<span class="g g-Whitespace">     </span><span class="mi">23</span>     <span class="k">return</span> <span class="n">fun_wrapped</span><span class="p">,</span> <span class="n">y0</span>

<span class="nn">/tmp/ipykernel_57670/906599801.py</span> in <span class="ni">Euler_x</span><span class="nt">(self, x_spatial, x)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>         <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> 
<span class="ne">--&gt; </span><span class="mi">102</span>         <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
<span class="g g-Whitespace">    </span><span class="mi">103</span>                                             <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span>                                             <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/optimize/minpack.py</span> in <span class="ni">fsolve</span><span class="nt">(func, x0, args, fprime, full_output, col_deriv, xtol, maxfev, band, epsfcn, factor, diag)</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span>                <span class="s1">&#39;diag&#39;</span><span class="p">:</span> <span class="n">diag</span><span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span> 
<span class="ne">--&gt; </span><span class="mi">147</span>     <span class="n">res</span> <span class="o">=</span> <span class="n">_root_hybr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">fprime</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span>     <span class="k">if</span> <span class="n">full_output</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>

<span class="nn">/usr/lib/python3/dist-packages/scipy/optimize/minpack.py</span> in <span class="ni">_root_hybr</span><span class="nt">(func, x0, args, jac, col_deriv, xtol, maxfev, band, eps, factor, diag, **unknown_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>         <span class="k">if</span> <span class="n">maxfev</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>             <span class="n">maxfev</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">224</span>         <span class="n">retval</span> <span class="o">=</span> <span class="n">_minpack</span><span class="o">.</span><span class="n">_hybrd</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="p">,</span> <span class="n">maxfev</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>                                  <span class="n">ml</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">epsfcn</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">diag</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>     <span class="k">else</span><span class="p">:</span>

<span class="nn">/tmp/ipykernel_57670/906599801.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(x_x)</span>
<span class="g g-Whitespace">    </span><span class="mi">100</span>         <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> 
<span class="ne">--&gt; </span><span class="mi">102</span>         <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
<span class="g g-Whitespace">    </span><span class="mi">103</span>                                             <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span>                                             <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nn">/tmp/ipykernel_57670/906599801.py</span> in <span class="ni">Euler_system</span><span class="nt">(self, x, x_x)</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span>         <span class="n">p</span> <span class="o">+=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> 
<span class="ne">---&gt; </span><span class="mi">31</span>     <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span> 
<span class="g g-Whitespace">     </span><span class="mi">33</span>     <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>

<span class="nn">/tmp/ipykernel_57670/3067284615.py</span> in <span class="ni">compute_Sy</span><span class="nt">(self, rho, T, Y)</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span> 
<span class="g g-Whitespace">     </span><span class="mi">32</span>                 <span class="c1"># Compute the reaction rate</span>
<span class="ne">---&gt; </span><span class="mi">33</span>                 <span class="n">w_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">nr_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span>                 <span class="c1">#breakpoint()</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span>                 <span class="c1"># Update the source terms for the species equation</span>

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">prod</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">/usr/lib/python3/dist-packages/numpy/core/fromnumeric.py</span> in <span class="ni">prod</span><span class="nt">(a, axis, dtype, out, keepdims, initial, where)</span>
<span class="g g-Whitespace">   </span><span class="mi">2908</span>     <span class="mi">10</span>
<span class="g g-Whitespace">   </span><span class="mi">2909</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">2910</span><span class="s2">     return _wrapreduction(a, np.multiply, &#39;prod&#39;, axis, dtype, out,</span>
<span class="g g-Whitespace">   </span><span class="mi">2911</span><span class="s2">                           keepdims=keepdims, initial=initial, where=where)</span>
<span class="g g-Whitespace">   </span><span class="mi">2912</span><span class="s2"> </span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmax</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="n">xmax_l</span> <span class="o">=</span> <span class="mf">3e7</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_T</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_rho</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="c1"># ax[1].set_ylim(2.2e-3,2.6e-3)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">logplot_Y</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_u</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Reactive_Air_shock_53_0.png" src="_images/Reactive_Air_shock_53_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_11specie</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum mass flux error       : 3.8992680452961817e-13
Maximum momentum flux error   : 7.203640096541309e-13
Maximum enthalpy flux error   : 3.7209135859591135e-06
Maximum mass frac error       : 7.51620987671231e-14
Last value of mass flux       : 1.5677014000006058
Ymin                          : 0.0
</pre></div>
</div>
<img alt="_images/Reactive_Air_shock_54_1.png" src="_images/Reactive_Air_shock_54_1.png" />
</div>
</div>
<div class="section" id="effect-of-altitude-density">
<h2>Effect of altitude (density)<a class="headerlink" href="#effect-of-altitude-density" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="effect-of-velocity">
<h2>Effect of velocity<a class="headerlink" href="#effect-of-velocity" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="effect-of-composition">
<h2>Effect of composition<a class="headerlink" href="#effect-of-composition" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="o2-dissociation">
<h1>O2 Dissociation<a class="headerlink" href="#o2-dissociation" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_dissociation</span> <span class="o">=</span> <span class="n">problem</span><span class="p">()</span>

<span class="n">diss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span><span class="mf">1.335</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.127</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.616</span><span class="p">,</span> <span class="mf">0.093</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.005</span><span class="p">],</span> <span class="o">-</span><span class="mf">117.98</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span>
<span class="n">diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>

<span class="n">diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>

<span class="c1"># Add species </span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>


<span class="c1"># Add reactions</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diss</span><span class="p">)</span>

<span class="c1"># Set ic</span>
<span class="c1">#O2_dissociation.T0     = 273.15 - 74.51</span>
<span class="c1">#O2_dissociation.rho0   = 1.8460e-5</span>
<span class="c1">#O2_dissociation.u0     = 25*np.sqrt(1.4*Ru/32*O2_dissociation.T0)</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mf">273.15</span> <span class="o">-</span> <span class="mf">74.51</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">1.8460e-5</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.4</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="p">(</span><span class="mi">32</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span> <span class="o">*</span> <span class="n">O2_dissociation</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>

<span class="c1"># Solve</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre shock Mach : 24.99953124560539
******************************
Post-shock guess values:
rho    : 0.00010988091967707133
T      : 24326.932817927933
Speed  : 1128.987418452406
Mach   : 0.37951675314028627
******************************
Post-shock values:
rho    : 0.0001652319892416528
T      : 17270.44435333903
Speed  : 750.787885643443
Mach   : 0.3201760047604018
******************************
Reference mean free path : 0.00040063369246117354

A Solving for x = 1.000000000000e+00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmax</span> <span class="o">=</span> <span class="mf">2e-2</span>
<span class="n">xmax_l</span> <span class="o">=</span> <span class="mf">3e7</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,)</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">plot_T</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">plot_rho</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">plot_Y</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="c1"># O2_dissociation.logplot_Y(ax[2], xmax = xmax)</span>
<span class="n">O2_dissociation</span><span class="o">.</span><span class="n">plot_u</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Reactive_Air_shock_72_0.png" src="_images/Reactive_Air_shock_72_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_dissociation</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">xmax</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum mass flux error       : 6.559984551245814e-13
Maximum momentum flux error   : 1.113961399063128e-12
Maximum enthalpy flux error   : 6.581196502021277e-13
Maximum mass frac error       : 1.5543122344752192e-15
Last value of mass flux       : 0.12405417584337154
Ymin                          : 0.0
</pre></div>
</div>
<img alt="_images/Reactive_Air_shock_73_1.png" src="_images/Reactive_Air_shock_73_1.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Di Venti Edoardo, Zucchelli Umberto<br/>
    
        &copy; Diritto d'autore 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>