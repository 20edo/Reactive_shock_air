%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{One temperature code description}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{Reactive air shock assignment}
\date{Feb 21, 2022}
\release{}
\author{Venti Edoardo, Zucchelli Umberto}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
In this project a code for the solution of the post\sphinxhyphen{}shock chemical relaxation problem is presented, validated and the results for some relevant cases are analyzed.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The code is written to be easily edited and re\sphinxhyphen{}used
\end{sphinxadmonition}


\part{One temperature code description}


\chapter{One temperature}
\label{\detokenize{1_Temperature/1T_code_structure:one-temperature}}\label{\detokenize{1_Temperature/1T_code_structure::doc}}
\sphinxAtStartPar
The main classes of the code are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Specie}\): contains specie data such as energy level and degeneracy and allows to compute the energy of a specie at a given temperature

\item {} 
\sphinxAtStartPar
\(\textbf{Reaction}\) and \(\textbf{sub-reaction}\): contain the reaction data such as reactants, products, exponents etc. and allows to compute the forward and backward coefficients

\item {} 
\sphinxAtStartPar
\(\textbf{Problem}\): contains the problem information such as initial mixture composition, speed, temperature, etc. and allows to compute the mixture properties for a given state, solve the chemical relaxation problem and plot the results.

\end{itemize}

\sphinxAtStartPar
Each of these classes will be explained in details in the following pages.


\chapter{Required packages and global constants}
\label{\detokenize{1_Temperature/1T_code_structure:required-packages-and-global-constants}}
\sphinxAtStartPar
Firstly, some relevant python packages are imporoted and some useful constants are set. From the next page on the first lines will be hidden, they usually serve the same purpose as here and eventually add some tolerance parameter or load the results of the previous page.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{import} \PYG{n+nn}{copy} \PYG{k}{as} \PYG{n+nn}{cp}
\PYG{k+kn}{import} \PYG{n+nn}{sys}
\PYG{k+kn}{import} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{optimize} \PYG{k}{as} \PYG{n+nn}{opt}
\PYG{k+kn}{import} \PYG{n+nn}{scipy}\PYG{n+nn}{.}\PYG{n+nn}{integrate} \PYG{k}{as} \PYG{n+nn}{itg}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Kb}  \PYG{o}{=} \PYG{l+m+mf}{1.3806503e\PYGZhy{}23}\PYG{p}{;}     \PYG{c+c1}{\PYGZsh{} Boltzmann constant [J/K]}
\PYG{n}{amu} \PYG{o}{=} \PYG{l+m+mf}{1.66053904020e\PYGZhy{}24}\PYG{p}{;} \PYG{c+c1}{\PYGZsh{} 1/Avogadro\PYGZsq{}s number [mol]}
\PYG{n}{Ru} \PYG{o}{=} \PYG{n}{Kb}\PYG{o}{/}\PYG{n}{amu}              \PYG{c+c1}{\PYGZsh{} Universal gas constant [J/(K*mol)]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide_cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZpc{}}\PYG{k}{run} 1T\PYGZus{}code\PYGZus{}structure.ipynb
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\chapter{Specie class definition}
\label{\detokenize{1_Temperature/Specie_class_definition:specie-class-definition}}\label{\detokenize{1_Temperature/Specie_class_definition::doc}}
\sphinxAtStartPar
For each specie a common framework is defined which allows to compute thermodynamic derivatives, energy, temperature and other relevant values for the subsequent calculations starting from the data provided by Park {[}1{]} and Zanardi {[}2{]}.

\sphinxAtStartPar
Assuming that the different contributions can be computed indipendently, the temperature and CVs are defined as the sum of the translational\sphinxhyphen{}rotational, vibrational and electronic components which are calculated as:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\( \textbf{Translational-rotational}\) :
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
If the molecule is monoatomic, it has no rotational dofs, then \( CV^t = \frac{3}{2} R_{gas} T \)

\item {} 
\sphinxAtStartPar
If the molecule is not monoatomic, the rotational contribution must be added \( CV^{(rt)} = CV^t + R \)

\end{enumerate}

\sphinxAtStartPar
Then, energy is computed as \(e^{tr} = CV  T\).

\item {} 
\sphinxAtStartPar
\( \textbf{ Vibrational }\) :
The contribution of vibrational dofs to energy is computed by assuming armhonic oscillator potential. The energy becomes: \(e^{v} = R_{gas} \frac{\theta_v}{e^{\frac{\theta_v}{T}-1}} \) 
The analytical expression for the specific heat is computed by deriving with respect to T, leading to the expression: 
\( CV^{v}_s = R_{gas} \frac{(\theta^v_s/T)^2 e^{\theta^v_s/T}} {(e^{\theta^v_s/T}-1)^2} \)

\item {} 
\sphinxAtStartPar
\( \textbf{ Electronic } \) :
Given the partition function {[}2{]}, the energy due to electronic energy levels is computed as: \( e = R_{gas}T^2 \frac{\partial}{\partial T} log(Z) = \frac{R_gas}{Z} \sum_i g_i \theta_i e^{-\frac{\theta_i}{T}}\).

\sphinxAtStartPar
Analogously with the vibrational contribution, the expression for the specific heat is obtained deriving the formula with respect to T.

\end{itemize}

\sphinxAtStartPar
The enthalpy of formation of species i \(\Delta h_{f,i}\) is at \(T_0 = 298.15 K\)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{specie}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{th\PYGZus{}v}\PYG{p}{,} \PYG{n}{th\PYGZus{}r}\PYG{p}{,} \PYG{n}{h\PYGZus{}form} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v} \PYG{o}{=} \PYG{n}{th\PYGZus{}v}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}r} \PYG{o}{=} \PYG{n}{th\PYGZus{}r}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e0} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}rot} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}vib} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}ele} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{=} \PYG{n}{mmol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}3}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{=} \PYG{n}{Kb}\PYG{o}{/}\PYG{p}{(}\PYG{n}{mmol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}3}\PYG{p}{)}\PYG{o}{/}\PYG{n}{amu}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{h\PYGZus{}form} \PYG{o}{=} \PYG{n}{h\PYGZus{}form}
        \PYG{n}{specie}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{k+kc}{None}
        
    \PYG{k}{def} \PYG{n+nf}{energy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Computes the energy and Cv as the sum of translational\PYGZhy{}rotational, vibrational and electronic contributions}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{e} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{cv} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{298.15}
        
        \PYG{c+c1}{\PYGZsh{} Traslational \PYGZhy{} rotational }
        \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}r} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}rot} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}rot} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}
            
        \PYG{n}{e\PYGZus{}rot}  \PYG{o}{=} \PYG{n}{cv\PYGZus{}rot} \PYG{o}{*} \PYG{p}{(}\PYG{n}{T}\PYG{o}{\PYGZhy{}}\PYG{n}{T0}\PYG{p}{)}
        
        \PYG{c+c1}{\PYGZsh{} Vibrational }
        \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}vib} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
            \PYG{n}{e\PYGZus{}vib}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}vib} \PYG{o}{=} \PYG{l+m+mi}{0}
            \PYG{n}{e\PYGZus{}vib}  \PYG{o}{=} \PYG{l+m+mi}{0}
        
        \PYG{c+c1}{\PYGZsh{} Electronic}
        \PYG{n}{Z}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{Z0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{Z1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{p}{)}
        \PYG{n}{Z10}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{p}{)}
        \PYG{n}{Z2} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} 
        \PYG{n}{Z20}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} 
        \PYG{n}{e\PYGZus{}ele}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Z1} \PYG{o}{/} \PYG{n}{Z} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Z10} \PYG{o}{/} \PYG{n}{Z0}
        \PYG{n}{cv\PYGZus{}ele} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{/}\PYG{p}{(}\PYG{n}{T}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{e\PYGZus{}ele}\PYG{o}{/}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{Z2} \PYG{o}{/} \PYG{n}{Z}\PYG{p}{)}
        
        \PYG{c+c1}{\PYGZsh{} Update Cv and e values}
        \PYG{n}{cv} \PYG{o}{=} \PYG{n}{cv\PYGZus{}rot} \PYG{o}{+} \PYG{n}{cv\PYGZus{}vib} \PYG{o}{+} \PYG{n}{cv\PYGZus{}ele}
        \PYG{n}{e}  \PYG{o}{=} \PYG{n}{e\PYGZus{}rot}  \PYG{o}{+} \PYG{n}{e\PYGZus{}vib}  \PYG{o}{+} \PYG{n}{e\PYGZus{}ele} 
        \PYG{n}{e}  \PYG{o}{=} \PYG{n}{e} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{T0}   
        \PYG{n}{e}  \PYG{o}{=} \PYG{n}{e} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{h\PYGZus{}form}
        
        \PYG{k}{return} \PYG{n}{e}\PYG{p}{,} \PYG{n}{cv}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Specie variables definition}
\label{\detokenize{1_Temperature/Specie_class_definition:specie-variables-definition}}
\sphinxAtStartPar
The chemical species considered are the 11 species of the Park’s air model {[}1{]}: \(N_2, O_2, N, O, NO, N_2^+, O_2^+, N^+, O^+, NO^+, e^-\). The data used can be found in Zanardi table’s {[}2{]}.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N2} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{28.0134}\PYG{p}{,} \PYG{l+m+mi}{3395}\PYG{p}{,} \PYG{l+m+mf}{2.9}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{N2}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N2}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{7.2231565e+04}\PYG{p}{,} \PYG{l+m+mf}{8.5778626e+04}\PYG{p}{,} \PYG{l+m+mf}{8.6050267e+04}\PYG{p}{,} \PYG{l+m+mf}{9.5351186e+04}\PYG{p}{,} \PYG{l+m+mf}{9.8056357e+04}\PYG{p}{,}
                          \PYG{l+m+mf}{9.9682677e+04}\PYG{p}{,} \PYG{l+m+mf}{1.0489765e+05}\PYG{p}{,} \PYG{l+m+mf}{1.1164896e+05}\PYG{p}{,} \PYG{l+m+mf}{1.2258365e+05}\PYG{p}{,} \PYG{l+m+mf}{1.2488569e+05}\PYG{p}{,} 
                          \PYG{l+m+mf}{1.2824762e+05}\PYG{p}{,} \PYG{l+m+mf}{1.3380609e+05}\PYG{p}{,} \PYG{l+m+mf}{1.4042964e+05}\PYG{p}{,} \PYG{l+m+mf}{1.5049589e+05}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N2}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N2}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{O2} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{31.9988}\PYG{p}{,} \PYG{l+m+mf}{2239.0}\PYG{p}{,} \PYG{l+m+mf}{2.1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{O2}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O2}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mf}{1.1391560e+04}\PYG{p}{,} \PYG{l+m+mf}{1.8984739e+04}\PYG{p}{,} \PYG{l+m+mf}{4.7559736e+04}\PYG{p}{,} \PYG{l+m+mf}{4.9912421e+04}\PYG{p}{,} \PYG{l+m+mf}{5.0922686e+04}\PYG{p}{,}
                         \PYG{l+m+mf}{7.1898633e+04}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O2}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O2}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{O}  \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{15.9994}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{1.5574e+07}\PYG{p}{)}
\PYG{n}{O}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{2.2770776e+02}\PYG{p}{,} \PYG{l+m+mf}{3.2656888e+02}\PYG{p}{,} \PYG{l+m+mf}{2.2830286e+04}\PYG{p}{,} \PYG{l+m+mf}{4.8619930e+04}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{N} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{14.0067}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mf}{3.3747e+07}\PYG{p}{)}
\PYG{n}{N}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{2.7664696e+04}\PYG{p}{,} \PYG{l+m+mf}{4.1493093e+04}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{NO} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{30.0061}\PYG{p}{,} \PYG{l+m+mf}{2817.0}\PYG{p}{,} \PYG{l+m+mf}{2.5}\PYG{p}{,} \PYG{l+m+mf}{3.0091e+6}\PYG{p}{)}
\PYG{n}{NO}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{NO}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{5.4673458e+04}\PYG{p}{,} \PYG{l+m+mf}{6.3171396e+04}\PYG{p}{,} \PYG{l+m+mf}{6.5994503e+04}\PYG{p}{,} \PYG{l+m+mf}{6.9061210e+04}\PYG{p}{,} \PYG{l+m+mf}{7.0499985e+04}\PYG{p}{,}
                        \PYG{l+m+mf}{7.4910550e+04}\PYG{p}{,} \PYG{l+m+mf}{7.6288753e+04}\PYG{p}{,} \PYG{l+m+mf}{8.6761885e+04}\PYG{p}{,} \PYG{l+m+mf}{8.7144312e+04}\PYG{p}{,} \PYG{l+m+mf}{8.8860771e+04}\PYG{p}{,}
                        \PYG{l+m+mf}{8.9817556e+04}\PYG{p}{,} \PYG{l+m+mf}{8.9884459e+04}\PYG{p}{,} \PYG{l+m+mf}{9.0427021e+04}\PYG{p}{,} \PYG{l+m+mf}{9.0642838e+04}\PYG{p}{,} \PYG{l+m+mf}{9.1117633e+04}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{NO}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NO}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{N2p}\PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{28.0128514}\PYG{p}{,} \PYG{l+m+mf}{3395.0}\PYG{p}{,} \PYG{l+m+mf}{2.9}\PYG{p}{,} \PYG{l+m+mf}{5.3886e+07}\PYG{p}{)}
\PYG{n}{N2p}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} 
                         \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N2p}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{1.3189972e+04}\PYG{p}{,} \PYG{l+m+mf}{3.6633231e+04}\PYG{p}{,} \PYG{l+m+mf}{3.6688768e+04}\PYG{p}{,} \PYG{l+m+mf}{5.9853048e+04}\PYG{p}{,} \PYG{l+m+mf}{6.6183659e+04}\PYG{p}{,} 
                          \PYG{l+m+mf}{7.5989919e+04}\PYG{p}{,} \PYG{l+m+mf}{7.6255086e+04}\PYG{p}{,} \PYG{l+m+mf}{8.2010186e+04}\PYG{p}{,} \PYG{l+m+mf}{8.4168349e+04}\PYG{p}{,} \PYG{l+m+mf}{8.6326512e+04}\PYG{p}{,} 
                         \PYG{l+m+mf}{8.9204062e+04}\PYG{p}{,} \PYG{l+m+mf}{9.2081613e+04}\PYG{p}{,} \PYG{l+m+mf}{9.2225490e+04}\PYG{p}{,} \PYG{l+m+mf}{9.2937684e+04}\PYG{p}{,} \PYG{l+m+mf}{9.6397938e+04}\PYG{p}{,} \PYG{l+m+mf}{1.0359181e+05}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N2p}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N2p}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{O2p}\PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{31.9982514}\PYG{p}{,} \PYG{l+m+mi}{2239}\PYG{p}{,} \PYG{l+m+mf}{2.1}\PYG{p}{,} \PYG{l+m+mf}{3.6592e+07}\PYG{p}{)}
\PYG{n}{O2p}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O2p}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{4.7354408e+04}\PYG{p}{,} \PYG{l+m+mf}{5.8373987e+04}\PYG{p}{,} \PYG{l+m+mf}{5.8414273e+04}\PYG{p}{,} \PYG{l+m+mf}{6.2298966e+04}\PYG{p}{,} \PYG{l+m+mf}{6.7334679e+04}\PYG{p}{,}
                          \PYG{l+m+mf}{7.1219372e+04}\PYG{p}{,} \PYG{l+m+mf}{7.6542841e+04}\PYG{p}{,} \PYG{l+m+mf}{8.8196920e+04}\PYG{p}{,} \PYG{l+m+mf}{8.8916307e+04}\PYG{p}{,} \PYG{l+m+mf}{9.4239776e+04}\PYG{p}{,} \PYG{l+m+mf}{9.4959163e+04}\PYG{p}{,}
                          \PYG{l+m+mf}{9.5920265e+04}\PYG{p}{,} \PYG{l+m+mf}{9.9850999e+04}\PYG{p}{,} \PYG{l+m+mf}{1.0359181e+05}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O2p}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O2p}\PYG{l+s+s1}{\PYGZsq{}}


\PYG{n}{NOp} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{30.0055514}\PYG{p}{,} \PYG{l+m+mi}{2817}\PYG{p}{,} \PYG{l+m+mf}{2.5}\PYG{p}{,} \PYG{l+m+mf}{3.3000e+07}\PYG{p}{)}
\PYG{n}{NOp}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{NOp}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{7.5089678e+04}\PYG{p}{,} \PYG{l+m+mf}{8.5254624e+04}\PYG{p}{,} \PYG{l+m+mf}{8.9035726e+04}\PYG{p}{,} \PYG{l+m+mf}{9.7469826e+04}\PYG{p}{,} \PYG{l+m+mf}{1.0005530e+05}\PYG{p}{,} \PYG{l+m+mf}{1.0280337e+05}\PYG{p}{,} \PYG{l+m+mf}{1.0571386e+05}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{NOp}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NOp}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{Op} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{15.9988514}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{9.8056e+07}\PYG{p}{)}
\PYG{n}{Op}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{Op}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{3.8583347e+04}\PYG{p}{,} \PYG{l+m+mf}{5.8223492e+04}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{Op}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Op}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{Np} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{14.0061514}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{1.3438e+08}\PYG{p}{)}
\PYG{n}{Np}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{Np}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{7.0068352e+01}\PYG{p}{,} \PYG{l+m+mf}{1.8819180e+02}\PYG{p}{,} \PYG{l+m+mf}{2.2036569e+04}\PYG{p}{,} \PYG{l+m+mf}{4.7031835e+04}\PYG{p}{,} \PYG{l+m+mf}{6.7312522e+04}\PYG{p}{,} \PYG{l+m+mf}{1.3271908e+05}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{Np}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Np}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{em} \PYG{o}{=} \PYG{n}{specie}\PYG{p}{(}\PYG{l+m+mf}{0.00054858}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{em}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{em}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{em}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{em}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Reaction and sub\sphinxhyphen{}reaction classes}
\label{\detokenize{1_Temperature/Reaction_class_definition:reaction-and-sub-reaction-classes}}\label{\detokenize{1_Temperature/Reaction_class_definition::doc}}
\sphinxAtStartPar
Two classes for the modeling of the chemical reactions have been defined:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The dissociation reactions are grouped in classes made by many sub\sphinxhyphen{}reactions where the difference between them is the inert molecule triggering the process.

\item {} 
\sphinxAtStartPar
On the other hand some chemical reactions are written as single sub\sphinxhyphen{}reaction.

\end{enumerate}

\sphinxAtStartPar
While there is no real need for this division, this worklow allows to group together the reactions that somehow “do the same thing” to be able to include or exclude one of them by just a line of code. Despite that, all reactions may be re\sphinxhyphen{}written to be one or many variables of class sub\sphinxhyphen{}reaction with no effect on the code execution.

\sphinxAtStartPar
The definition of the parameters used to model the two classes is a little tricky and may be more user\sphinxhyphen{}friendly.


\chapter{Sub\sphinxhyphen{}reaction class definition}
\label{\detokenize{1_Temperature/Reaction_class_definition:sub-reaction-class-definition}}
\sphinxAtStartPar
A subreaction is defined by the soichometric coefficients, the reactants, the products and the reaction rate coefficients. The latter are computed as follows:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Forward reaction coefficient :       \(k_f\) is expressed as \(k_f = C_f T ^{\eta_f}e^{\frac{\theta_d}{T}}\) (coefficients from Park’s tables {[}1{]})

\item {} 
\sphinxAtStartPar
Equilibrium reaction coefficient :   \(k_c\) is computed from the polynomial interpolation by Park {[}1{]}

\item {} 
\sphinxAtStartPar
Backward reaction coefficient:       \(k_b\) is computed as \(k_b = \frac{k_f}{k_c}\)

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{subreaction}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{reactants}\PYG{p}{,} \PYG{n}{products}\PYG{p}{,} \PYG{n}{stoichr}\PYG{p}{,} \PYG{n}{stoichp}\PYG{p}{,} \PYG{n}{Cf}\PYG{p}{,} \PYG{n}{nf}\PYG{p}{,} \PYG{n}{th\PYGZus{}d}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reactants} \PYG{o}{=} \PYG{n}{reactants}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{products}  \PYG{o}{=} \PYG{n}{products}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stoichr}   \PYG{o}{=} \PYG{n}{stoichr} \PYG{c+c1}{\PYGZsh{} Stoichometric coefficient of the reactants}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stoichp}   \PYG{o}{=} \PYG{n}{stoichp} \PYG{c+c1}{\PYGZsh{} Stoichometric coefficient of the products}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf}        \PYG{o}{=} \PYG{n}{Cf}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf}        \PYG{o}{=} \PYG{n}{nf}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d}      \PYG{o}{=} \PYG{n}{th\PYGZus{}d}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}         \PYG{o}{=} \PYG{k+kc}{None} \PYG{c+c1}{\PYGZsh{} Coefficients of the polynomial used to compute Kc}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}     \PYG{o}{=} \PYG{k+kc}{None}

        
    \PYG{k}{def} \PYG{n+nf}{kf}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{kf} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*}\PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d} \PYG{o}{/} \PYG{n}{T}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kf}
        
    \PYG{k}{def} \PYG{n+nf}{kb}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{kb} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{kf}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{kc}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kb}
    
    \PYG{k}{def} \PYG{n+nf}{kc}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{Z} \PYG{o}{=} \PYG{l+m+mi}{10000} \PYG{o}{/} \PYG{n}{T} 
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}
        
        \PYG{k}{if} \PYG{n}{exponent} \PYG{o}{\PYGZlt{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{kc\PYGZus{}min}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{kc} \PYG{o}{=} \PYG{n}{kc\PYGZus{}min}
        \PYG{k}{elif} \PYG{n}{exponent} \PYG{o}{\PYGZgt{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{kc\PYGZus{}max}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{kc} \PYG{o}{=} \PYG{n}{kc\PYGZus{}max}
        \PYG{k}{else} \PYG{p}{:}
            \PYG{n}{kc} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{exponent}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kc}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Reaction class definition}
\label{\detokenize{1_Temperature/Reaction_class_definition:reaction-class-definition}}
\sphinxAtStartPar
A reaction is a list of sub\sphinxhyphen{}reactions that is defined according to what explained above. However, since the coefficient of the polynomial used to compute the equilibrium reaction coefficient do not depend on the impact body, they do not need to be repeated for every sub\sphinxhyphen{}reaction but are stored in the reaction class and automatically updated in each newly created sub\sphinxhyphen{}reaction.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{reaction}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{A}\PYG{p}{,} \PYG{n}{e\PYGZus{}mol}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{subreactions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}            \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}        \PYG{o}{=} \PYG{n}{e\PYGZus{}mol}
    
    
    \PYG{k}{def} \PYG{n+nf}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{subr}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{subr}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}
        \PYG{n}{subr}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{subreactions}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{subr}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Reaction variables definition}
\label{\detokenize{1_Temperature/Reaction_class_definition:reaction-variables-definition}}
\sphinxAtStartPar
The 47 reactions for the 11 species air model are defined below, data are extracted from Park’s tables {[}1{]}.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} The constant rate Cf is devided by 1e6 to convert from cm3/mol to m3/mol}
\PYG{c+c1}{\PYGZsh{} e\PYGZus{}mol is multiplicated by 4184 in order to convert Kcal/mol in J/mol}

\PYG{n}{O2diss} \PYG{o}{=} \PYG{n}{reaction}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.335}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.127}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.616}\PYG{p}{,} \PYG{l+m+mf}{0.093}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.005}\PYG{p}{]}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{117.98}\PYG{o}{*}\PYG{l+m+mi}{4184}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.25e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.25e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.25e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{8.25e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{O2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.32e22}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{59500}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N2diss} \PYG{o}{=} \PYG{n}{reaction}\PYG{p}{(}\PYG{p}{[} \PYG{l+m+mf}{3.898}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{12.611}\PYG{p}{,} \PYG{l+m+mf}{0.683}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.118}\PYG{p}{,} \PYG{l+m+mf}{0.006}\PYG{p}{]}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{225.00}\PYG{o}{*}\PYG{l+m+mi}{4184}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.11e22}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.11e22}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.11e22}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.10e22}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.7e21}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.7e21}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.7e21}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.7e21}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.7e21}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.7e21}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{N2diss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.11e24}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.6}\PYG{p}{,} \PYG{l+m+mi}{113200}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NOdiss} \PYG{o}{=} \PYG{n}{reaction}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.549}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{7.784}\PYG{p}{,} \PYG{l+m+mf}{0.228}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.043}\PYG{p}{,} \PYG{l+m+mf}{0.002}\PYG{p}{]}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{150.03}\PYG{o}{*}\PYG{l+m+mi}{4184}\PYG{p}{)} 
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{4.6e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{4.6e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{4.6e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{4.6e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.3e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.3e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.3e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.3e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.3e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.3e17}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{NOdiss}\PYG{o}{.}\PYG{n}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{7.36e19}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,}
                                  \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{75500}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Exchange reactions}
\PYG{n}{NO\PYGZus{}O}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{O2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.16e8}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{1.29}\PYG{p}{,} \PYG{l+m+mi}{19220}\PYG{p}{)}
\PYG{n}{NO\PYGZus{}O}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.215}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.657}\PYG{p}{,} \PYG{l+m+mf}{0.843}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.136}\PYG{p}{,} \PYG{l+m+mf}{0.007}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{NO\PYGZus{}O}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{32.05}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{O\PYGZus{}N2}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{N2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{NO}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.18e13}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{37700}\PYG{p}{)}
\PYG{n}{O\PYGZus{}N2}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{2.349}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.828}\PYG{p}{,} \PYG{l+m+mf}{0.455}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.075}\PYG{p}{,} \PYG{l+m+mf}{0.004}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O\PYGZus{}N2}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{74.97}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{O\PYGZus{}O2p}      \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{6.85e13}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.520}\PYG{p}{,} \PYG{l+m+mi}{18600}\PYG{p}{)}
\PYG{n}{O\PYGZus{}O2p}\PYG{o}{.}\PYG{n}{A}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.411}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{1.998}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.002}\PYG{p}{,} \PYG{l+m+mf}{0.005}\PYG{p}{,} \PYG{l+m+mf}{0.00}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O\PYGZus{}O2p}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}\PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{36.88}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{N2\PYGZus{}Np}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{9.85e12}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.180}\PYG{p}{,} \PYG{l+m+mi}{12100}\PYG{p}{)}
\PYG{n}{N2\PYGZus{}Np}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.963}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.116}\PYG{p}{,} \PYG{l+m+mf}{0.692}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.103}\PYG{p}{,} \PYG{l+m+mf}{0.005}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N2\PYGZus{}Np}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{24.06}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{O\PYGZus{}NOp}      \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.75e13}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{0.010}\PYG{p}{,} \PYG{l+m+mi}{51000}\PYG{p}{)}
\PYG{n}{O\PYGZus{}NOp}\PYG{o}{.}\PYG{n}{A}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.705}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{6.223}\PYG{p}{,} \PYG{l+m+mf}{0.522}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.090}\PYG{p}{,} \PYG{l+m+mf}{0.005}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O\PYGZus{}NOp}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}\PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{101.34}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{N2\PYGZus{}Op}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N2}\PYG{p}{,} \PYG{n}{Op}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{N2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{6.33e16}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.210}\PYG{p}{,} \PYG{l+m+mi}{22200}\PYG{p}{)}
\PYG{n}{N2\PYGZus{}Op}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{2.391}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.443}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.080}\PYG{p}{,} \PYG{l+m+mf}{0.027}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.002}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N2\PYGZus{}Op}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{44.23}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{N\PYGZus{}NOp}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{Np}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.21e15}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.020}\PYG{p}{,} \PYG{l+m+mi}{61100}\PYG{p}{)}
\PYG{n}{N\PYGZus{}NOp}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{2.132}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.550}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.249}\PYG{p}{,} \PYG{l+m+mf}{0.041}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.002}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N\PYGZus{}NOp}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{121.51}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{O2\PYGZus{}NOp}      \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O2}\PYG{p}{,} \PYG{n}{NOp}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{NO}\PYG{p}{,} \PYG{n}{O2p}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.03e16}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.170}\PYG{p}{,} \PYG{l+m+mi}{32400}\PYG{p}{)}
\PYG{n}{O2\PYGZus{}NOp}\PYG{o}{.}\PYG{n}{A}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{2.115}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.225}\PYG{p}{,} \PYG{l+m+mf}{0.524}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.095}\PYG{p}{,} \PYG{l+m+mf}{0.005}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O2\PYGZus{}NOp}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}\PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{64.46}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{NOp\PYGZus{}N}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{NOp}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N2p}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.7e13}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{0.400}\PYG{p}{,} \PYG{l+m+mi}{35500}\PYG{p}{)}
\PYG{n}{NOp\PYGZus{}N}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{1.746}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.838}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.013}\PYG{p}{,} \PYG{l+m+mf}{0.013}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.001}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{NOp\PYGZus{}N}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{70.60}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{c+c1}{\PYGZsh{} Associative ionization}
\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}N}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{NOp}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.53e11}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.370}\PYG{p}{,} \PYG{l+m+mi}{32000}\PYG{p}{)}
\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{6.234}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{5.536}\PYG{p}{,} \PYG{l+m+mf}{0.494}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.058}\PYG{p}{,} \PYG{l+m+mf}{0.003}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{63.69}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}O}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{O}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{O2p}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.85e11}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{0.490}\PYG{p}{,} \PYG{l+m+mi}{80600}\PYG{p}{)}
\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}O}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.904}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{13.418}\PYG{p}{,} \PYG{l+m+mf}{1.861}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.288}\PYG{p}{,} \PYG{l+m+mf}{0.015}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}O}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{160.20}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{N\PYGZus{}\PYGZus{}\PYGZus{}N}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{N}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{N2p}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{1.79e11}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{l+m+mf}{0.770}\PYG{p}{,} \PYG{l+m+mi}{67500}\PYG{p}{)}
\PYG{n}{N\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{4.488}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{9.374}\PYG{p}{,} \PYG{l+m+mf}{0.481}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.044}\PYG{p}{,} \PYG{l+m+mf}{0.002}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{134.29}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{c+c1}{\PYGZsh{} Electron impact ionization}
\PYG{n}{O\PYGZus{}ion}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{O}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{Op}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{3.9e33}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.780}\PYG{p}{,} \PYG{l+m+mi}{158500}\PYG{p}{)}
\PYG{n}{O\PYGZus{}ion}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.980}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{19.534}\PYG{p}{,} \PYG{l+m+mf}{1.244}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.190}\PYG{p}{,} \PYG{l+m+mf}{0.010}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{O\PYGZus{}ion}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{315.06}\PYG{o}{*}\PYG{l+m+mi}{4184}

\PYG{n}{N\PYGZus{}ion}       \PYG{o}{=} \PYG{n}{subreaction}\PYG{p}{(}\PYG{p}{[}\PYG{n}{N}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{n}{Np}\PYG{p}{,} \PYG{n}{em}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mf}{2.5e34}\PYG{o}{/}\PYG{l+m+mf}{1e6}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{3.820}\PYG{p}{,} \PYG{l+m+mi}{168600}\PYG{p}{)}
\PYG{n}{N\PYGZus{}ion}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.553}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{18.870}\PYG{p}{,} \PYG{l+m+mf}{0.472}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.060}\PYG{p}{,} \PYG{l+m+mf}{0.003}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{N\PYGZus{}ion}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{335.23}\PYG{o}{*}\PYG{l+m+mi}{4184}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
While sub\sphinxhyphen{}reactions are somehow general, reactions include the possible impact with all other species, thus the sub\sphinxhyphen{}reactions to be included in each reaction depend on the mixture model considered. In the following, the reactions for the 7 specie air model are defined.


\chapter{Problem class definition}
\label{\detokenize{1_Temperature/Problem_class_definition:problem-class-definition}}\label{\detokenize{1_Temperature/Problem_class_definition::doc}}
\sphinxAtStartPar
A problem class is defined so that several condition can be studied, analyzed, compared and contrasted.

\sphinxAtStartPar
The initial conditions for the post\sphinxhyphen{}shock relaxation region are obtained by assuming frozen chemistry through the shock which, in the Euler equations framework is a discontinuity whose jumps are defined by the Rankine\sphinxhyphen{}Hugoniot relations.

\sphinxAtStartPar
The variable are mixture density, velocity, temperature and mass fractions.

\sphinxAtStartPar
For the mixture model considered the the following relations hold:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(e_{mixture} = \Sigma_i e_i Y_i \)

\item {} 
\sphinxAtStartPar
\(CV_{mixture} = \Sigma_i CV_i Y_i \)

\item {} 
\sphinxAtStartPar
\(R_{mixture} = \Sigma_i R_i Y_i \)

\end{itemize}

\sphinxAtStartPar
where Y is the mass fraction of each specie (obviously \( \Sigma_i Y_i = 1\) ).


\section{Initialization}
\label{\detokenize{1_Temperature/Problem_class_definition:initialization}}
\sphinxAtStartPar
In the following the class is created and the functions to compute the thermodynamic variables are defined.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Some variables have a default value when the class is initialized. All of them will be overwritten when defining a problem, but the sigma value that represents the equivalent cross section of pure nitrogen assuming hard sphere potential.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{problem}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}     \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}     \PYG{o}{=} \PYG{l+m+mi}{300}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0}   \PYG{o}{=} \PYG{l+m+mf}{1.225}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0}     \PYG{o}{=} \PYG{l+m+mi}{3000}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sigma}     \PYG{o}{=} \PYG{l+m+mf}{3.14} \PYG{o}{*} \PYG{p}{(}\PYG{l+m+mf}{6.2} \PYG{o}{*} \PYG{l+m+mf}{1e\PYGZhy{}10}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{c+c1}{\PYGZsh{} Sigma HS nitrogen}
    
    \PYG{k}{def} \PYG{n+nf}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{specie}\PYG{p}{,} \PYG{n}{Y0}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{specie}\PYG{p}{)}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{Y0}\PYG{p}{)}
        
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{specie}\PYG{p}{)}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{[}\PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Y0}
        
    \PYG{k}{def} \PYG{n+nf}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{R} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{R} \PYG{o}{+}\PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{R}
    
    \PYG{k}{def} \PYG{n+nf}{energy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{e}\PYG{p}{,} \PYG{n}{CV} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{e1}\PYG{p}{,} \PYG{n}{CV1} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
            \PYG{n}{e}\PYG{p}{,} \PYG{n}{CV} \PYG{o}{=} \PYG{n}{e} \PYG{o}{+} \PYG{n}{e1} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{p}{,} \PYG{n}{CV} \PYG{o}{+} \PYG{n}{CV1}\PYG{o}{*}\PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{e}\PYG{p}{,} \PYG{n}{CV}        
    
    \PYG{k}{def} \PYG{n+nf}{e\PYGZus{}Y}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}Computes the derivative of energy wrt Y at constant T\PYGZsq{}\PYGZsq{}\PYGZsq{}}
        \PYG{n}{e\PYGZus{}Y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{e\PYGZus{}Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{p}{,} \PYG{n}{inutile} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{e\PYGZus{}Y}
        
    \PYG{k}{def} \PYG{n+nf}{only\PYGZus{}e}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y} \PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{e}\PYG{p}{,} \PYG{n}{CV} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{only\PYGZus{}e x : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{only e Y : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{e1}\PYG{p}{,} \PYG{n}{CV1} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
            \PYG{n}{e} \PYG{o}{=} \PYG{n}{e} \PYG{o}{+} \PYG{n}{e1} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{e}    
    
    \PYG{k}{def} \PYG{n+nf}{T\PYGZus{}from\PYGZus{}e}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{e}\PYG{p}{,} \PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{1e3}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{n}{T}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{T} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{e}\PYG{p}{,} \PYG{n}{x0} \PYG{o}{=} \PYG{n}{T0}\PYG{p}{,} 
                                            \PYG{n}{xtol}\PYG{o}{=}\PYG{l+m+mf}{1e\PYGZhy{}12}\PYG{p}{,} \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T\PYGZus{}from\PYGZus{}e did not converge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
        \PYG{k}{return} \PYG{n}{T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Reynolds\sphinxhyphen{}Hugoiniot jump relations}
\label{\detokenize{1_Temperature/Problem_class_definition:reynolds-hugoiniot-jump-relations}}
\sphinxAtStartPar
At first, the Rankine Hugoniot relations are solved for a perfect gas with the same R of the mixture and the isoentropic coefficient \(\gamma = 1.4\). 
Then, the results obtained are used as guess to initialize the non\sphinxhyphen{}linear solver.

\sphinxAtStartPar
The Rankine\sphinxhyphen{}Hugoniot relations read: 

\sphinxAtStartPar
\( \rho_0 u_0 = \rho_1 u \) 
\( \rho_0 u_0^2 + P_0 = \rho_1 u_1^2 + P_1 \) 
\( h_0^t  = e_0 + \frac{P_0}{\rho_0} + \frac{1}{2}u_0^2 = 
e_1 + \frac{P_1}{\rho_1} + \frac{1}{2} u_1^2 = h_1^t  \)

\sphinxAtStartPar
The non\sphinxhyphen{}linear equations are written in the “RHsystem” function whose solutions are found through a non\sphinxhyphen{}linear solver.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The shock is solved with the hypothesis of frozen chemistry.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{RHsystem}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{rho2}\PYG{p}{,} \PYG{n}{T2}\PYG{p}{,} \PYG{n}{u2} \PYG{o}{=} \PYG{n}{x}
    \PYG{n}{p2} \PYG{o}{=} \PYG{n}{rho2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n}{T2}
    \PYG{n}{e2}\PYG{p}{,} \PYG{n}{CV2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{,} \PYG{n}{T2}\PYG{p}{)}
    
    \PYG{n}{p0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}
    \PYG{n}{e0}\PYG{p}{,} \PYG{n}{CV0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)}
    
    \PYG{n}{out\PYGZus{}rho} \PYG{o}{=} \PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0}\PYG{p}{)}                       \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{rho2} \PYG{o}{*} \PYG{n}{u2}\PYG{p}{)}
    \PYG{n}{out\PYGZus{}mom} \PYG{o}{=} \PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+}  \PYG{n}{p0}\PYG{p}{)}            \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{rho2} \PYG{o}{*} \PYG{n}{u2}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{p2}\PYG{p}{)}
    \PYG{n}{out\PYGZus{}ene} \PYG{o}{=} \PYG{p}{(}\PYG{n}{e0} \PYG{o}{+} \PYG{n}{p0} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{e2} \PYG{o}{+} \PYG{n}{p2} \PYG{o}{/} \PYG{n}{rho2} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u2} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{p}{)}
      
    \PYG{n}{out} \PYG{o}{=} \PYG{p}{[}\PYG{n}{out\PYGZus{}rho}\PYG{p}{,} \PYG{n}{out\PYGZus{}mom}\PYG{p}{,} \PYG{n}{out\PYGZus{}ene}\PYG{p}{]}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rho2, T2, u2 : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho2}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T2}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{u2}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{out}\PYG{p}{)}\PYG{p}{)}
        
    \PYG{k}{return} \PYG{n}{out}

    
\PYG{k}{def} \PYG{n+nf}{RHjump}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Build a guess assuming perfect gas with gamma = 1.4}
    \PYG{n}{gamma} \PYG{o}{=} \PYG{l+m+mf}{1.4}
    \PYG{n}{c0} \PYG{o}{=} \PYG{p}{(}\PYG{n}{gamma} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{p0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}
    \PYG{n}{M0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{/} \PYG{n}{c0}
    \PYG{n}{M2} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{gamma} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{rho2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{/} \PYG{p}{(} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{p2} \PYG{o}{=} \PYG{n}{p0} \PYG{o}{*} \PYG{p}{(} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{gamma} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{p}{)} \PYG{o}{/} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{T2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0} \PYG{o}{*} \PYG{p}{(} \PYG{p}{(} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{gamma} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{p}{)} \PYG{o}{*} \PYG{p}{(} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{p}{)} \PYG{p}{)} \PYGZbs{}
            \PYG{o}{/} \PYG{p}{(} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{c2} \PYG{o}{=} \PYG{p}{(}\PYG{n}{gamma} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n}{T2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
    \PYG{n}{u2} \PYG{o}{=} \PYG{n}{c2} \PYG{o}{*} \PYG{n}{M2}\PYG{p}{;}
        
    \PYG{c+c1}{\PYGZsh{} Solve RH relations}
    \PYG{n}{x}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{RHsystem}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{,} \PYG{n}{x0} \PYG{o}{=} \PYG{p}{[}\PYG{n}{rho2}\PYG{p}{,} \PYG{n}{T2}\PYG{p}{,} \PYG{n}{u2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xtol}\PYG{o}{=}\PYG{n}{atol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{,} 
                                     \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RH not converged}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}
    
    \PYG{c+c1}{\PYGZsh{} Compute reference post shock mean free path}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
        \PYG{n}{mmol}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
    
    \PYG{n}{mmixt} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}
    
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp} \PYG{o}{=} \PYG{n}{Kb} \PYG{o}{*} \PYG{n}{T2} \PYG{o}{/} \PYG{n}{p2}  \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sigma}
    
    \PYG{n}{e2}\PYG{p}{,} \PYG{n}{cv2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{)}
    \PYG{n}{cp} \PYG{o}{=} \PYG{n}{cv2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}
    \PYG{n}{gamma} \PYG{o}{=} \PYG{n}{cp} \PYG{o}{/} \PYG{n}{cv2}
    \PYG{n}{c2c} \PYG{o}{=} \PYG{p}{(}\PYG{n}{gamma} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{M2c} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1} \PYG{o}{/} \PYG{n}{c2c}
    
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pre shock Mach : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{M0}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{******************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Post\PYGZhy{}shock guess values:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho    : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T      : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Speed  : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{u2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mach   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{M2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{******************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Post\PYGZhy{}shock values:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho    : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T      : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Speed  : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mach   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{M2c}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{******************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Reference mean free path : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{speed is negative!!! Look at RHjump}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{sys}\PYG{o}{.}\PYG{n}{exit}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{EXITING}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{problem}\PYG{o}{.}\PYG{n}{RHsystem} \PYG{o}{=} \PYG{n}{RHsystem}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{RHjump} \PYG{o}{=} \PYG{n}{RHjump}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
In the “RHjump” function a reference mean free path is computed to be able to compare the relaxation length in terms if mean free path for different initial conditions. It represents the mean free path just after the shock and is computed by the cross section defined in the problem class
\end{sphinxadmonition}

\begin{sphinxadmonition}{warning}{Warning:}
\sphinxAtStartPar
While the defualt value of sigma is reasonable for air (since the bi\sphinxhyphen{}atomical nitrogen is its the first specie in terms of composition both in mass and molar fractions), it is not exact. Furthermore the effects of different composition are not captured by this value, hence it shall be used with caution and only as a reference.
\end{sphinxadmonition}


\section{Computation of the chemical source terms}
\label{\detokenize{1_Temperature/Problem_class_definition:computation-of-the-chemical-source-terms}}
\sphinxAtStartPar
To compute the chemical sources for each specie \(\omega_i\), for each reaction the specie mass fraction vector is transformed by an incidence matrix in “local” molar concentrations \(\chi_i = \rho_i/M_i\) which are multiplied by the forward and backward reaction coefficients as defined before to compute the reaction rate. 
According to the Park’s definition of forward and backward coefficients, the reaction rate is computed as: 

\sphinxAtStartPar
\(R_{f,r} = k_{f,r} \Pi_{i = 0}^{N_{s}} \chi_i^{\alpha_{i,r}} \) 
and 
\(R_{b,r} = k_{b,r} \Pi_{i = 0}^{N_{s}} \chi_i^{\beta_{i,r}} \) 
Where \(\alpha_{i,r}\) and \(\beta_{i,r}\) are the stechiometric mole numbers for reactants and products respectively.





\sphinxAtStartPar
The net mass rate of production of the specie \(i\) is obtained considering all the \(N_r\) possible reactions, and it is defined as: 
\(
\omega_i = M_i \sum_{r}^{N_r} \omega_{i,r} = M_i \sum_{r}^{N_r} \left(\beta_{i,r} - \alpha_{i,r} \right) \left( R_{f,r} - R_{b,r} \right)
\)

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Altough the energy released by the reaction is computed, it is no of practical use for the way the mixture energy has been written.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{compute\PYGZus{}Sy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{rho}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{S} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{Y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}
    \PYG{n}{Se} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{c+c1}{\PYGZsh{} Recover mmol}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
        \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{,} \PYG{n}{i}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
    
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{if} \PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{reaction}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{subreactions}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{obj} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{subreactions}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}
                \PYG{c+c1}{\PYGZsh{} Add the reactants to the reactants matrix by an incidence matrix omegar}
                \PYG{n}{omegar} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegar[k][idx] = 1}
                    \PYG{n}{omegar}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
                
                \PYG{c+c1}{\PYGZsh{} Add the products to the products matrix by an incidence matrix omegap}
                \PYG{n}{omegap} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegap[k][idx] = 1}
                    \PYG{n}{omegap}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
                
                \PYG{c+c1}{\PYGZsh{} Transform the global y vector to the local n vector}
                \PYG{n}{nr\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)}
                \PYG{n}{np\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegap}\PYG{p}{)}\PYG{p}{)}
                
                \PYG{c+c1}{\PYGZsh{} Compute the reaction rate}
                \PYG{n}{w\PYGZus{}s} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kf}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{nr\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kb}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{np\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{)}
                \PYG{c+c1}{\PYGZsh{}breakpoint()}
                \PYG{c+c1}{\PYGZsh{} Update the source terms for the species equation}
                \PYG{n}{S} \PYG{o}{+}\PYG{o}{=} \PYG{n}{mmol} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{,} \PYG{n}{omegap}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{,} \PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{w\PYGZus{}s}
                \PYG{c+c1}{\PYGZsh{}Update the energy source term}
                \PYG{n}{Se} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{*} \PYG{n}{w\PYGZus{}s}
                
        \PYG{k}{elif} \PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{subreaction}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{obj} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
                
                \PYG{c+c1}{\PYGZsh{} Add the reactants to the reactants matrix by an incidence matrix omegar}
                \PYG{n}{omegar} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegar[k][idx] = 1}
                    \PYG{n}{omegar}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
                
                \PYG{c+c1}{\PYGZsh{} Add the products to the products matrix by an incidence matrix omegap}
                \PYG{n}{omegap} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegap[k][idx] = 1}
                    \PYG{n}{omegap}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}

                \PYG{c+c1}{\PYGZsh{} Transform the global y vector to the local n vector}
                \PYG{n}{nr\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)}
                \PYG{n}{np\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegap}\PYG{p}{)}\PYG{p}{)}
                
                \PYG{c+c1}{\PYGZsh{} Compute the reaction rate}
                \PYG{n}{w\PYGZus{}s} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kf}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{nr\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kb}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{np\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{)}
                
                \PYG{c+c1}{\PYGZsh{} breakpoint()}
                \PYG{c+c1}{\PYGZsh{} Update the source terms for the species equation}
                \PYG{n}{S} \PYG{o}{+}\PYG{o}{=} \PYG{n}{mmol} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{,} \PYG{n}{omegap}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{,} \PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{w\PYGZus{}s}
                \PYG{c+c1}{\PYGZsh{}Update the energy source term}
                \PYG{n}{Se} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{*} \PYG{n}{w\PYGZus{}s}
                
                
        \PYG{k}{else}\PYG{p}{:} \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Member of the reaction group of this problem are ill\PYGZhy{}defined}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Se = : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Se}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{S}\PYG{p}{,} \PYG{n}{Se}

\PYG{n}{problem}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sy} \PYG{o}{=} \PYG{n}{compute\PYGZus{}Sy}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Pre\sphinxhyphen{}shock relax chemistry funciton}
\label{\detokenize{1_Temperature/Problem_class_definition:pre-shock-relax-chemistry-funciton}}
\sphinxAtStartPar
In general, once the density and temperature of a mixture are known, the equilibrium composition can be computed by the chemical equilibrium constant. In this function, the equilibrium composition of the mixture is computed through the chemical source terms.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{pre\PYGZus{}shock\PYGZus{}relax\PYGZus{}chemistry}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{relax} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{output} \PYG{o}{=} \PYG{l+m+mi}{1}
    \PYG{n}{Y}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}
    \PYG{n}{Sy} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
    
    \PYG{k}{while} \PYG{p}{(}\PYG{n+nb}{any}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{Sy}\PYG{p}{)} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{1e\PYGZhy{}8}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{n}{Sy} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
    
        \PYG{n}{Y} \PYG{o}{+}\PYG{o}{=} \PYG{n}{relax} \PYG{o}{*} \PYG{n}{Sy} \PYG{c+c1}{\PYGZsh{} Relaxation parameter to favour convergence of chemical relaxation for mixture very far from equilibrium}
        \PYG{k}{if} \PYG{n}{output} \PYG{p}{:}
            \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{********************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{name} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ concentration : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{    Sorgente : }\PYG{l+s+s1}{\PYGZsq{}}  \PYG{o}{+} \PYG{n+nb}{str} \PYG{p}{(}\PYG{n}{Sy}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{********************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{o}{\PYGZlt{}} \PYG{l+m+mf}{1e\PYGZhy{}8}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Species not conserved in pre\PYGZhy{}shock relax}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
        \PYG{k}{if} \PYG{n+nb}{any}\PYG{p}{(}\PYG{n}{Y} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Y less than 0 in chemical relax pre \PYGZhy{} shock}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
    \PYG{k}{return} \PYG{n}{Y}

\PYG{n}{problem}\PYG{o}{.}\PYG{n}{pre\PYGZus{}shock\PYGZus{}relax\PYGZus{}chemistry} \PYG{o}{=} \PYG{n}{pre\PYGZus{}shock\PYGZus{}relax\PYGZus{}chemistry}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{warning}{Warning:}
\sphinxAtStartPar
Since in general both temperature, density and composition may be unknown or uncertain, this function prints the chemical equilibrium composition BUT DOES NOT UPDATE the inital conditions of the problem.
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This is not the most efficient way to compute chemical equilibrium composition, but given the code already written, it’s the easiest to implement.
\end{sphinxadmonition}


\section{Euler system of equation}
\label{\detokenize{1_Temperature/Problem_class_definition:euler-system-of-equation}}
\sphinxAtStartPar
The primary variables considered are density, velocity, mass fractions and temperature. 

\sphinxAtStartPar
The Euler equations read:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Mass equation: 
\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0\)

\item {} 
\sphinxAtStartPar
Momentum equation: 
\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \) 
Since \( P = P(\rho, T, Y) = \rho \Sigma_i Y_i R T \) , then \( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T} d T + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)  
The derivatives can be expressed as : 
\begin{itemize}
\item {} 
\sphinxAtStartPar
\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_i T \) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial P}{\partial T} = \rho \Sigma_i Y_i R_i\) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial P}{\partial Y_i} = \rho R_i T\) 
Hence, the momentum equation can be written as : 
\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R T \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_u \frac{\partial T}{\partial x} + \rho R T \Sigma_i \frac{Y_i}{x}\)

\end{itemize}

\item {} 
\sphinxAtStartPar
Energy equation: 
\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\) 
In analogy with the pressure, we have \( e = e (T, Y_i) \), then \( de = \frac{\partial e }{\partial T} dT + \Sigma \frac{\partial e }{\partial Y_i} dY_i\) 
The derivatives can be expressed as : 
\begin{itemize}
\item {} 
\sphinxAtStartPar
\( \frac{\partial e}{\partial T} = cv(T, Y_i) \) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial e}{\partial Y_i} = e_i(T) \) 
Hence, the energy equation can be written as : 
\( \frac{\partial T}{\partial x} = \frac{1}{cv} \left[ \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \Sigma_i e_i(T) \frac{\partial Y_i}{\partial x} \right] \)

\end{itemize}

\item {} 
\sphinxAtStartPar
Species transport equation: 
\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)

\end{itemize}

\sphinxAtStartPar
Being the equations non linear, in analogy to what done for the shock relaxation, “Euler\_system” defines the system of equations while “Euler\_x” computes the derivative of the states by a non\sphinxhyphen{}linear solver.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Euler\PYGZus{}system}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{x}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{rho}\PYG{p}{,} \PYG{n}{u}\PYG{p}{,} \PYG{n}{T} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}
    \PYG{n}{Y} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{p}{]}
    \PYG{n}{rho\PYGZus{}x}\PYG{p}{,} \PYG{n}{u\PYGZus{}x}\PYG{p}{,} \PYG{n}{T\PYGZus{}x} \PYG{o}{=} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}
    \PYG{n}{Y\PYGZus{}x} \PYG{o}{=} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{p}{]}
    
    \PYG{n}{p} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)} \PYG{o}{*} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{T} 
    
    \PYG{n}{e2}\PYG{p}{,} \PYG{n}{cv} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T} \PYG{p}{)}
    \PYG{n}{e\PYGZus{}Y}    \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}Y}\PYG{p}{(} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
    
    \PYG{n}{p\PYGZus{}x} \PYG{o}{=} \PYG{l+m+mf}{0.0}

    \PYG{k}{for} \PYG{n}{t} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{p\PYGZus{}x} \PYG{o}{+}\PYG{o}{=} \PYG{n}{rho\PYGZus{}x} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}  \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{*} \PYG{n}{T} \PYG{o}{+} \PYGZbs{}
               \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y\PYGZus{}x}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{+} \PYGZbs{}
               \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{*} \PYG{n}{T\PYGZus{}x}

    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{First term of the derivative p\PYGZus{}x: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho\PYGZus{}x} \PYG{o}{*} \PYG{n}{Y}  \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{*} \PYG{n}{T}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{n}{S}\PYG{p}{,} \PYG{n}{Se} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sy}\PYG{p}{(}\PYG{n}{rho}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system R                                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system rho\PYGZus{}x            : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Y                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Y\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system T                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system rho              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system cv               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cv}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system T\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system p                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{p}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Se               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Se}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Mass equation}
    \PYG{n}{rho\PYGZus{}xc} \PYG{o}{=} \PYG{o}{\PYGZhy{}} \PYG{n}{rho} \PYG{o}{/} \PYG{n}{u} \PYG{o}{*} \PYG{n}{u\PYGZus{}x}
    
    \PYG{c+c1}{\PYGZsh{} Momentum equation}
    \PYG{n}{u\PYGZus{}xc}  \PYG{o}{=} \PYG{o}{\PYGZhy{}}  \PYG{n}{p\PYGZus{}x} \PYG{o}{/} \PYG{n}{rho} \PYG{o}{/} \PYG{n}{u}
    
    \PYG{c+c1}{\PYGZsh{} Energy equation}
    \PYG{n}{T\PYGZus{}xc}  \PYG{o}{=} \PYG{p}{(}\PYG{n}{p} \PYG{o}{/} \PYG{n}{rho} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{rho\PYGZus{}x} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y} \PYG{o}{*} \PYG{n}{Y\PYGZus{}x}\PYG{p}{)}\PYG{p}{)} \PYG{o}{/} \PYG{n}{cv}
    
    \PYG{c+c1}{\PYGZsh{} Species equations}
    \PYG{n}{Y\PYGZus{}xc}  \PYG{o}{=} \PYG{n}{S} \PYG{o}{/} \PYG{n}{rho} \PYG{o}{/} \PYG{n}{u}
    
    \PYG{n}{x\PYGZus{}xc} \PYG{o}{=} \PYG{p}{[}\PYG{n}{rho\PYGZus{}xc}\PYG{p}{]}
    \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{u\PYGZus{}xc}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{T\PYGZus{}xc}\PYG{p}{)}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{Y\PYGZus{}xc}\PYG{p}{:}
        \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}
    
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system x\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system x\PYGZus{}c              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x\PYGZus{}xc}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system x\PYGZus{}x \PYGZhy{} x\PYGZus{}c        : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x\PYGZus{}x} \PYG{o}{\PYGZhy{}} \PYG{n}{x\PYGZus{}xc}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system S                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{S}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Se               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Se}\PYG{p}{)}\PYG{p}{)}
        
        
    \PYG{k}{return}   \PYG{n}{x\PYGZus{}x} \PYG{o}{\PYGZhy{}} \PYG{n}{x\PYGZus{}xc}
    
\PYG{k}{def} \PYG{n+nf}{Euler\PYGZus{}x}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{x\PYGZus{}spatial}\PYG{p}{,} \PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A Solving for x = }\PYG{l+s+si}{\PYGZpc{}.12e}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}}\PYG{k}{x\PYGZus{}spatial}, end=\PYGZdq{}\PYGZdq{})
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{end}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        
        \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{State values  = }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)}
        
        
        \PYG{n}{x0} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{l+m+mf}{0.0}\PYG{p}{]}
        
        \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
            \PYG{n}{x0}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
        
        \PYG{n}{x0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{x0}\PYG{p}{)}
        
        \PYG{n}{x\PYGZus{}x}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x\PYGZus{}x} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}system}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{)}\PYG{p}{,} 
                                            \PYG{n}{x0}\PYG{o}{=}\PYG{n}{x0}\PYG{p}{,}  
                                            \PYG{n}{xtol}\PYG{o}{=}\PYG{n}{atol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{,} \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler\PYGZus{}x did not converge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}    
        
        \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ier = }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{ier}\PYG{p}{)}\PYG{p}{)}
            
        
        \PYG{k}{return} \PYG{n}{x\PYGZus{}x}
    
    
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}system} \PYG{o}{=} \PYG{n}{Euler\PYGZus{}system}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}x} \PYG{o}{=} \PYG{n}{Euler\PYGZus{}x}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Solve}
\label{\detokenize{1_Temperature/Problem_class_definition:solve}}
\sphinxAtStartPar
The solve function resolves the shock and then computes the state varibles by integration of the derivatives in the spatial coordinate x.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The problem is stiff, thus an appropriate method must be chosen. In this code an implicit multi\sphinxhyphen{}step variable\sphinxhyphen{}order (1 to 5) method based on a backward differentiation formula for the derivative approximation has been chosen. The first step is a fraction of the reference post\sphinxhyphen{}shock mean free path.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{solve}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{xf} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    
    \PYG{c+c1}{\PYGZsh{} Compute post shock values to be used as initial conditions}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{RHjump}\PYG{p}{(}\PYG{p}{)}
    
    \PYG{n}{y0} \PYG{o}{=} \PYG{p}{[}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{]}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{:}
        \PYG{n}{y0}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}
    
    \PYG{n}{sol} \PYG{o}{=} \PYG{n}{itg}\PYG{o}{.}\PYG{n}{solve\PYGZus{}ivp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}x}\PYG{p}{,} 
                              \PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{xf}\PYG{p}{]}\PYG{p}{,} \PYG{n}{y0}\PYG{p}{,} \PYG{n}{method}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BDF}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{t\PYGZus{}eval}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{dense\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{first\PYGZus{}step}\PYG{o}{=}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp} \PYG{o}{/} \PYG{l+m+mf}{1e4}\PYG{p}{,}
                              \PYG{n}{events}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{vectorized}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{args}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{n}{rtol}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{n}{atol}\PYG{p}{)}
    
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y} \PYG{o}{=} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}

    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x} \PYG{o}{=} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{t}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol} \PYG{o}{=} \PYG{n}{sol}
    
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{solve} \PYG{o}{=} \PYG{n}{solve}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Post\sphinxhyphen{}processing}
\label{\detokenize{1_Temperature/Problem_class_definition:post-processing}}
\sphinxAtStartPar
Once the result in terms of state variables have been computed, the pressure, energy and molar mass fractions are recovered to be used for the visualization and analysis of the results.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{postprocess}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Post processing}
    \PYG{c+c1}{\PYGZsh{} Gather mmol of each specie}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
        \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{,} \PYG{n}{i}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
        
    \PYG{n}{e} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{p} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{e}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{/} \PYG{n}{mmol}
        \PYG{c+c1}{\PYGZsh{} Normalization of the molar fraction}
        \PYG{n}{parameter} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{parameter}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{/} \PYG{n}{parameter}
        
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}X} \PYG{o}{=} \PYG{n}{X}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e} \PYG{o}{=} \PYG{n}{e}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p} \PYG{o}{=} \PYG{n}{p}
    
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{postprocess} \PYG{o}{=} \PYG{n}{postprocess}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Plot}
\label{\detokenize{1_Temperature/Problem_class_definition:plot}}
\sphinxAtStartPar
Several plot functions have been prepared to ease analysis and comparisons. These function plot the outcome of the analysis with a double x\sphinxhyphen{}axis: the upper values represent the number of reference mean free path while the lower is the distance measured in meters from the shock.


\section{Temperature plot}
\label{\detokenize{1_Temperature/Problem_class_definition:temperature-plot}}

\subsection{Density plot}
\label{\detokenize{1_Temperature/Problem_class_definition:density-plot}}

\subsection{Velocity plot}
\label{\detokenize{1_Temperature/Problem_class_definition:velocity-plot}}

\subsection{Mass fractions plot}
\label{\detokenize{1_Temperature/Problem_class_definition:mass-fractions-plot}}

\subsection{Molar fractions plot}
\label{\detokenize{1_Temperature/Problem_class_definition:molar-fractions-plot}}

\subsection{Mass fractions log\sphinxhyphen{}plot}
\label{\detokenize{1_Temperature/Problem_class_definition:mass-fractions-log-plot}}

\subsection{Molar fractions log\sphinxhyphen{}plot}
\label{\detokenize{1_Temperature/Problem_class_definition:molar-fractions-log-plot}}

\section{Validation}
\label{\detokenize{1_Temperature/Problem_class_definition:validation}}
\sphinxAtStartPar
For validation purposes, the fluxes of conservative variables are computed, the relative error is plotted and the max values printed. 
The conservative fluxes are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Mass flux : \( \rho u\)

\item {} 
\sphinxAtStartPar
Momentum flux: \( \rho u^2 + P \)

\item {} 
\sphinxAtStartPar
Energy flux: \( \left[ \rho \left( e + \frac{1}{2} u ^ 2 \right) + P \right] u \)

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{validate}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{xmax\PYGZus{}l} \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{print\PYGZus{}max} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}For validation purpuses, the fluxes of conserved values are plotted as a function of x\PYGZsq{}\PYGZsq{}\PYGZsq{}}
    \PYG{c+c1}{\PYGZsh{} Set xmax}
    
    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{xmax}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{xmax\PYGZus{}l}\PYG{p}{:}
            \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax\PYGZus{}l} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}
            
        \PYG{k}{else}\PYG{p}{:} \PYG{n}{xmax} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
        
    \PYG{n}{x\PYGZus{}lambda} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot mass flux}

    \PYG{n}{subaxes\PYGZus{}mass}       \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{mass\PYGZus{}flux} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u}
    \PYG{n}{error\PYGZus{}mass\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{mass\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{mass\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{mass\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}mass2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mass flux [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot momentum flux}
    \PYG{n}{subaxes\PYGZus{}momentum}   \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{momentum\PYGZus{}flux} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p} 
    \PYG{n}{error\PYGZus{}momentum\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{momentum\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{momentum\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{momentum\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}momentum\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}momentum2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}momentum\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Momentum flux [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot total enthalpy flux}
    \PYG{n}{subaxes\PYGZus{}enthalpy}     \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
    \PYG{n}{enthalpy\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho} \PYG{o}{*} \PYG{p}{(} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{p}{)} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u} 
    \PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{enthalpy\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{enthalpy\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{enthalpy\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}enthalpy2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{enthalpy flux [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot sum of mass fractions}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}     \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}
    \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} 
    \PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sum of mass fractions [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{print\PYGZus{}max}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum mass flux error       : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}mass\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum momentum flux error   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}momentum\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum enthalpy flux error   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum mass frac error       : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Last value of mass flux       : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{mass\PYGZus{}flux}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Ymin                          : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{validate} \PYG{o}{=} \PYG{n}{validate}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\part{Two\sphinxhyphen{}temperatures code description}


\chapter{Two\sphinxhyphen{}temperature}
\label{\detokenize{2_Temperature/_2T_code_structure:two-temperature}}\label{\detokenize{2_Temperature/_2T_code_structure::doc}}
\sphinxAtStartPar
The main classes of the code are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Specie}\): contains specie data such as energy level and degeneracy and allows to compute the energy of a specie at a given temperature

\item {} 
\sphinxAtStartPar
\(\textbf{Reaction and sub-reaction}\): contain the reaction data such as reactants, products, exponents etc. and allows to compute the forward and backward coefficients

\item {} 
\sphinxAtStartPar
\(\textbf{Problem}\): contains the problem information such as initial mixture composition, speed, temperature, etc. and allows to compute the mixture properties for a given state, solve the chemical relaxation problem and plot the results.

\end{itemize}

\sphinxAtStartPar
Each of these classes will be explained in details in the following pages.


\chapter{Two temperature}
\label{\detokenize{2_Temperature/_2T_code_structure:id1}}
\sphinxAtStartPar
The two temperature extends the classes prepared for the one temperature mixture model distinguishing the effects of roto\sphinxhyphen{}translational and vibro\sphinxhyphen{}electronic temperatures which represent two different flow variables. 
While in general the energy is a combination of the four energy which thermalize differently, the approximation of tranlational\sphinxhyphen{}rotational and vibro\sphinxhyphen{}electronic temperatures is common since the themalization of each couple of degrees of freedom. 

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Appropriate \_2T functions are defined just where needed. The correspective one temperature version are still present in general.
\end{sphinxadmonition}


\chapter{Required packages and global constants}
\label{\detokenize{2_Temperature/_2T_code_structure:required-packages-and-global-constants}}
\sphinxAtStartPar
Firstly, some relevant python packages are imporoted and some useful constants are set. From the next page on the first lines will be hidden, they usually serve the same purpuse as here and eventually add some tolerance parameter or load the results of the previous page.

\sphinxAtStartPar
The function “find letter” is defined in order to distinguish the differents chemical reaction considered and compute the corresponding forward and backward reaction coefficient. See {\hyperref[\detokenize{2_Temperature/_2T_code_structure:Chemical-reaction-class-definition}]{\emph{Chemical reaction class definition}}}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{find\PYGZus{}letter}\PYG{p}{(}\PYG{n}{letter}\PYG{p}{,} \PYG{n}{lst}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{n+nb}{any}\PYG{p}{(}\PYG{n}{letter} \PYG{o+ow}{in} \PYG{n}{word} \PYG{k}{for} \PYG{n}{word} \PYG{o+ow}{in} \PYG{n}{lst}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\chapter{Specie class definition}
\label{\detokenize{2_Temperature/_2T_Specie_class_definition:specie-class-definition}}\label{\detokenize{2_Temperature/_2T_Specie_class_definition::doc}}
\sphinxAtStartPar
In analogy with the one temperature model, for each specie a common framework is defined which allows to compute thermodynamic derivatives, energy, temperature and other relevant values for the subsequent calculations starting from the data provided by Park {[}1{]} and Zanardi {[}2{]}. However, the distinction between translational\sphinxhyphen{}rotational and vibro\sphinxhyphen{}electronic temperature shall be highlighted.

\sphinxAtStartPar
Assuming that the different contributions can be computed indipendently, the energy and CVs are defined as the sum of the translational\sphinxhyphen{}rotational, vibrational and electronic contributions which are calculated as:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Translational-rotational}\) :
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
If the molecule is monoatomic, it has no rotational dofs, then \( CV^t_s = \frac{3}{2} R_{gas} \) where \(R_{gas} = \frac{\Re_u}{M_s}\)

\item {} 
\sphinxAtStartPar
If the molecule is not monoatomic, the rotational contribution must be added \( CV^{tr}_s = CV^t_s + R_{gas} \)

\end{enumerate}

\sphinxAtStartPar
Then, energy is computed as \(e^{tr}_s = CV^{rt}_s  T^{tr}\)

\item {} 
\sphinxAtStartPar
\(\textbf{Vibrational}\) :
The contribution of vibrational dofs to energy is computed by assuming armhonic oscillator potential. The energy becomes: \(e^{v}_s = R_{gas} \frac{\theta^v_s}{e^{\frac{\theta^v_s}{T^v}-1}} \) 
The analytical expression for the specific heat at constant volume is computed by deriving with respect to T, leading to the expression: 
\(CV^{v}_s = R_{gas} \frac{(\theta^v_s/T^v)^2 e^{\theta^v_s/T^v}} {(e^{\theta^v_s/T^v}-1)^2}\)

\item {} 
\sphinxAtStartPar
\(\textbf{Electronic}\) :
Given the i\sphinxhyphen{}th energy level degeneracy \(g_{s,i}\) and the characteristic electronic temperature of specie s for the j\sphinxhyphen{}th level \(\theta^{el}_{s,j}\) (Zanardi’s tables), the energy of the electronic energy levels is computed as: \( e^{el}_s = R_{gas}T^2 \frac{\partial}{\partial T} log(Z) = \frac{R_{gas}}{Z^{el}} \sum_i g_{s,i} \theta^{el}_{s,i} e^{-\frac{\theta^{el}_{s,i}}{T^{el}}}\) 
Whereas:  \(Z^{el} = \sum_i g_{s,i} e^{-\frac{\theta^{el}_{s,i}}{T^{el}}}\)

\sphinxAtStartPar
Analogously with the vibrational contribution the expression for the specific heat is obtained deriving the formula with respect to T: \(CV^{el}_s = \frac{R_{gas}}{(T^{el})^2} \left [ \frac{1}{Z^{el}} \sum_i g_{s,i} \left( \theta^{el}_{s,i}\right)^2 e^{-\frac{\theta^{el}_{s,i}}{T^{el}}} - \left( \frac{e^{el}_s}{R_{gas}} \right)^2 \right ] \)

\end{itemize}

\sphinxAtStartPar
All energies are written as energy whose reference temperature is \(T_0 = 298.15 K\). 

\sphinxAtStartPar
Hence, the energy associated to each specie \(i\) is computed as:
\(
e^{tot}_i = \int_{T_0}^{T^t}CV^{t}_i dT + \int_{T_0}^{T^r}CV^{r}_i dT + \int_{T_0}^{T^v}CV^{v}_i dT + \int_{T_0}^{T^e}CV^{e}_i dT - R_i T_0 + \Delta h^0_{f,i}
\)

\sphinxAtStartPar
For the two\sphinxhyphen{}temperature model has been assumed that:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(T^t = T^r = T^{tr} \)

\item {} 
\sphinxAtStartPar
\(T^v = T^{el} = T^{ve} \)

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{specie}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{th\PYGZus{}v}\PYG{p}{,} \PYG{n}{th\PYGZus{}r}\PYG{p}{,} \PYG{n}{h\PYGZus{}form} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v} \PYG{o}{=} \PYG{n}{th\PYGZus{}v}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}r} \PYG{o}{=} \PYG{n}{th\PYGZus{}r}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e0} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}rot} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}vib} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}ele} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e} \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{=} \PYG{n}{mmol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}3}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{=} \PYG{n}{Ru}\PYG{o}{/}\PYG{p}{(}\PYG{n}{mmol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}3}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{h\PYGZus{}form} \PYG{o}{=} \PYG{n}{h\PYGZus{}form}
        \PYG{n}{specie}\PYG{o}{.}\PYG{n}{name} \PYG{o}{=} \PYG{k+kc}{None}
    
    \PYG{k}{def} \PYG{n+nf}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Computes the energy and Cv as the sum of translational\PYGZhy{}rotational, vibrational and electronic contributions}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{e\PYGZus{}tr} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{e\PYGZus{}ve} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{cv\PYGZus{}tr} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{cv\PYGZus{}ve} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{298.15}
        
        \PYG{c+c1}{\PYGZsh{} Traslational \PYGZhy{} rotational }
        \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}r} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}rot} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}rot} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}
            
        \PYG{n}{e\PYGZus{}rot}  \PYG{o}{=} \PYG{n}{cv\PYGZus{}rot} \PYG{o}{*} \PYG{p}{(}\PYG{n}{T}\PYG{o}{\PYGZhy{}}\PYG{n}{T0}\PYG{p}{)}
        
        \PYG{c+c1}{\PYGZsh{} Vibrational }
        \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}vib} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
            \PYG{n}{e\PYGZus{}vib}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{cv\PYGZus{}vib} \PYG{o}{=} \PYG{l+m+mi}{0}
            \PYG{n}{e\PYGZus{}vib}  \PYG{o}{=} \PYG{l+m+mi}{0}
        
        \PYG{c+c1}{\PYGZsh{} Electronic}
        \PYG{n}{Z}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{Z0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{Z1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{p}{)}
        \PYG{n}{Z10}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{p}{)}
        \PYG{n}{Z2} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} 
        \PYG{n}{Z20}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} 
        
        \PYG{n}{e\PYGZus{}ele}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Z1} \PYG{o}{/} \PYG{n}{Z} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Z10} \PYG{o}{/} \PYG{n}{Z0}
        \PYG{n}{cv\PYGZus{}ele} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{/}\PYG{p}{(}\PYG{n}{Tv}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{e\PYGZus{}ele}\PYG{o}{/}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{Z2} \PYG{o}{/} \PYG{n}{Z}\PYG{p}{)}
        
        \PYG{c+c1}{\PYGZsh{} Update Cv and e values}
        \PYG{n}{cv\PYGZus{}tr} \PYG{o}{=} \PYG{n}{cv\PYGZus{}rot} 
        \PYG{n}{cv\PYGZus{}ve} \PYG{o}{=} \PYG{n}{cv\PYGZus{}vib} \PYG{o}{+} \PYG{n}{cv\PYGZus{}ele}
        \PYG{n}{e\PYGZus{}tr}  \PYG{o}{=} \PYG{n}{e\PYGZus{}rot}  
        \PYG{n}{e\PYGZus{}ve}  \PYG{o}{=} \PYG{n}{e\PYGZus{}vib}  \PYG{o}{+} \PYG{n}{e\PYGZus{}ele} 
        \PYG{n}{e\PYGZus{}tr}  \PYG{o}{=} \PYG{n}{e\PYGZus{}tr} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{h\PYGZus{}form} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{T0}
        
        \PYG{k}{return} \PYG{n}{e\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e\PYGZus{}ve}\PYG{p}{,} \PYG{n}{cv\PYGZus{}tr}\PYG{p}{,} \PYG{n}{cv\PYGZus{}ve}
    
    \PYG{k}{def} \PYG{n+nf}{energy\PYGZus{}vib\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Computes the energy and Cv as the sum of vibrational and electronic contributions}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{n}{e\PYGZus{}ve} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{298.15}
        
        \PYG{c+c1}{\PYGZsh{} Vibrational }
        \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
            \PYG{n}{e\PYGZus{}vib}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{e\PYGZus{}vib}  \PYG{o}{=} \PYG{l+m+mi}{0}
            
        \PYG{c+c1}{\PYGZsh{} Electronic}
        \PYG{n}{Z}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{Z0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{Z1} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{p}{)}
        \PYG{n}{Z10}\PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}g} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{o}{/}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{electro\PYGZus{}th}\PYG{p}{)}

        \PYG{n}{e\PYGZus{}ele}  \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Z1} \PYG{o}{/} \PYG{n}{Z} \PYG{o}{\PYGZhy{}} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Z10} \PYG{o}{/} \PYG{n}{Z0}

        
        \PYG{n}{e\PYGZus{}ve}  \PYG{o}{=} \PYG{n}{e\PYGZus{}vib}  \PYG{o}{+} \PYG{n}{e\PYGZus{}ele} 
        
        \PYG{k}{return} \PYG{n}{e\PYGZus{}ve}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Importing species data}
\label{\detokenize{2_Temperature/_2T_Specie_class_definition:importing-species-data}}
\sphinxAtStartPar
Similar to the 1T model, the 11 chemical species of Park’s air model are imported: \(N_2, O_2, N, O, NO, N_2^+, O_2^+, N^+, O^+, NO^+, e^-\). Species are defined as objects of class specie and properties are defined according to the tables in Zanardi {[}2{]}.


\chapter{Reaction and sub\sphinxhyphen{}reaction classes}
\label{\detokenize{2_Temperature/_2T_Reaction_class_definition:reaction-and-sub-reaction-classes}}\label{\detokenize{2_Temperature/_2T_Reaction_class_definition::doc}}
\sphinxAtStartPar
Two classes for the modeling of the chemical reactions have been defined in accordance with the one temperature model.


\chapter{Chemical reaction class definition}
\label{\detokenize{2_Temperature/_2T_Reaction_class_definition:chemical-reaction-class-definition}}
\sphinxAtStartPar
A reaction is defined by the stochiometric coefficients, the reactants, the products and the reaction rate coefficients. The latter are computed as follows:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Forward reaction coefficient}\) :       \(k_f\) can be expressed through the modified Arrhenius equation: \(k_f = C_f T ^{\eta_f}e^{-\frac{\theta_d}{T}}\)  (coefficients from Park’s tables {[}1{]})

\item {} 
\sphinxAtStartPar
\(\textbf{Equilibrium reaction coefficient}\) :   \(k_c\) is computed from the fitted fouth\sphinxhyphen{}order polynomial interpolation by Park {[}1{]}: \(k_c = exp(A_i + A_2Z + A_3Z^2 + A_4Z^3 + A_5Z^4)\) 
Where: \(Z = \frac{10000}{T}\)

\item {} 
\sphinxAtStartPar
\(\textbf{Backward reaction coefficient}\):       \(k_b\) is computed as \(k_b = \frac{k_f}{k_c}\)


\end{itemize}

\sphinxAtStartPar
The two\sphinxhyphen{}temperature model by Park {[}1{]} consider four different groups of reactions that need to be treated differently. They can be distinguished between: impact dissociations, exchange reactions, associative ionizations (or, in reverse, dissociative ricombinations) and elctron\sphinxhyphen{}impact ionizations. The impact dissociations must be subdivided further into heavy\sphinxhyphen{}particle impact dissociations and electron\sphinxhyphen{}impact dissociations. 
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Heavy-particle impact dissociation}\) : 
\(
AB + M \rightleftharpoons A + B + M
\) 
The forward reaction occurs mostly as a result of vibrational ladder\sphinxhyphen{}climbing process, that is the successive excitation of vibrational energy levels in the molecule AB. The final parting process occurs mostly from the levels close to the dissociation limit, that is, from the levels that are located within an energy \(K_bT\) from the dissociation limit. The rate coefficient is approximately proportional, therefore to the population of the vibrational level \(K_bT\) below the dissociation limit \(D' = D - K_bT\), resulting proportional to  \(exp(− D' /(K_b T_v)) = exp(− (D - K_bT) /(K_b T_v)) = exp(− \theta^d /(T_v) + T/T^v)\). The rate of parting of the molecules from this level is dictated mostly by the kinetic energy of the impacting particles \(K_bT\) hence its rate is proportional to \(exp(−(K_b T)/(K_b T)) = exp(−1)\). The preexponential factor T expresses the dependence of the collision frequence and cross sections on he collision energy, both of which are dictated by the translational temperature T. Therefore the expression for \(k_f\) becomes:
\(k_f = C T exp(- \theta^d/T^v - 1 + T/T^v)\) 
The reverse rate of this process are dictated only by the translational temperature of the particles involved:
\(k_b = k_b(T)\)

\item {} 
\sphinxAtStartPar
\(\textbf{Electron-impact dissociation}\) : 
\(
AB + e^- \rightleftharpoons A + B + e^-
\) 
In this case \(T\) must be replaced by the electron temperature, which in the two\sphinxhyphen{}temperature formulation by Park {[}1{]} is the same as \(T^v\): 
\(k_f = C T^v exp(- \theta^d/T^v)\) 
The reverse rate coefficient depends on \(\sqrt{T T^v}\), hence: 
\(k_b = k_b(\sqrt{T T^v})\)

\item {} 
\sphinxAtStartPar
\(\textbf{Exchange reaction}\):
\(
AB + C \rightleftharpoons A + BC
\) 
Similar considerations as heavy\sphinxhyphen{}particle impact dissociation can be made, therefore the forward and backward reaction coefficents have the same expressions as described before.

\item {} 
\sphinxAtStartPar
\(\textbf{Associative ionization}\):
\(
A + B \rightleftharpoons AB^+ + e^-
\) 
In this case the initial state contains no molecules, hence the coefficient of the forward rate must be  function only of heavy\sphinxhyphen{}particle translational temperature \(T\):
\(k_f = C T exp(- \theta^d/T)\) 
While the reverse rate is dictated mostly by the vibrational energy of the molecule \(AB^+\) and the translational temperature of \(e^-\), which is set equal to \(T^v\):
\(k_b = k_b(T^v)\)

\item {} 
\sphinxAtStartPar
\(\textbf{Elctron-impact ionization}\):
\(
A + e^- \rightleftharpoons A^+ + e^- + e^-
\) 
In this process the atom \(A\) can be considered to be at rest because of its very small thermal velocity. Both the forward and reverse rate coefficients are functions of the electron temperature only:
\(k_f = C T^v exp(- \theta^d/T^v)\) 
\(k_b = k_b(T^v)\)

\end{itemize}

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_show-lines}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{subreaction}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{reactants}\PYG{p}{,} \PYG{n}{products}\PYG{p}{,} \PYG{n}{stoichr}\PYG{p}{,} \PYG{n}{stoichp}\PYG{p}{,} \PYG{n}{Cf}\PYG{p}{,} \PYG{n}{nf}\PYG{p}{,} \PYG{n}{th\PYGZus{}d}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reactants} \PYG{o}{=} \PYG{n}{reactants}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{products}  \PYG{o}{=} \PYG{n}{products}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stoichr}   \PYG{o}{=} \PYG{n}{stoichr} \PYG{c+c1}{\PYGZsh{} Stoichometric coefficient ordered as [reactants, products]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{stoichp}   \PYG{o}{=} \PYG{n}{stoichp}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf}        \PYG{o}{=} \PYG{n}{Cf}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf}        \PYG{o}{=} \PYG{n}{nf}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d}      \PYG{o}{=} \PYG{n}{th\PYGZus{}d}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}         \PYG{o}{=} \PYG{k+kc}{None}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}     \PYG{o}{=} \PYG{k+kc}{None}

        
    \PYG{k}{def} \PYG{n+nf}{kf}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{kf} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*}\PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d} \PYG{o}{/} \PYG{n}{T}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kf}
        
    \PYG{k}{def} \PYG{n+nf}{kb}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{kb} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{kf}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{kc}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kb}
    
    \PYG{k}{def} \PYG{n+nf}{kc}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{Z} \PYG{o}{=} \PYG{l+m+mi}{10000} \PYG{o}{/} \PYG{n}{T} 
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}
        
        \PYG{k}{if} \PYG{n}{exponent} \PYG{o}{\PYGZlt{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{kc\PYGZus{}min}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{kc} \PYG{o}{=} \PYG{n}{kc\PYGZus{}min}
        \PYG{k}{elif} \PYG{n}{exponent} \PYG{o}{\PYGZgt{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{kc\PYGZus{}max}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{kc} \PYG{o}{=} \PYG{n}{kc\PYGZus{}max}
        \PYG{k}{else} \PYG{p}{:}
            \PYG{n}{kc} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{exponent}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kc}
    
    \PYG{c+c1}{\PYGZsh{} 2 Temperature}
    \PYG{k}{def} \PYG{n+nf}{kf\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{prod} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n}{react} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{prod}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{products}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{react}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
        
        \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{em}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{react}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{find\PYGZus{}letter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{p}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{prod}\PYG{p}{)}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} A + em \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} Ap + em + em }
                \PYG{n}{kf\PYGZus{}2T} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf} \PYG{o}{*} \PYG{n}{Tv} \PYG{o}{*}\PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d} \PYG{o}{/} \PYG{n}{Tv}\PYG{p}{)}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} AB + em \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} A + B + em }
                \PYG{n}{kf\PYGZus{}2T} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf} \PYG{o}{*} \PYG{n}{Tv} \PYG{o}{*}\PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d} \PYG{o}{/} \PYG{n}{Tv}\PYG{p}{)}  
        \PYG{k}{else}\PYG{p}{:}
            \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{em}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{prod}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} A + B \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} ABp + em }
                \PYG{n}{kf\PYGZus{}2T} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*}\PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d} \PYG{o}{/} \PYG{n}{T}\PYG{p}{)}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} AB + M \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} A + B + M }
                \PYG{n}{kf\PYGZus{}2T} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Cf} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*}\PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nf} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{th\PYGZus{}d} \PYG{o}{/} \PYG{n}{Tv} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{o}{+} \PYG{n}{T} \PYG{o}{/} \PYG{n}{Tv}\PYG{p}{)}                
        \PYG{k}{return} \PYG{n}{kf\PYGZus{}2T}
        
    \PYG{k}{def} \PYG{n+nf}{kb\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{kb\PYGZus{}2T} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{kf\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{o}{/}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{kc\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kb\PYGZus{}2T}
    
    \PYG{k}{def} \PYG{n+nf}{kc\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{prod} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n}{react} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{prod}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{products}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{react}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{name}\PYG{p}{)}
        
        \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{em}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{react}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{find\PYGZus{}letter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{p}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{prod}\PYG{p}{)}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} A + em \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} Ap + em + em }
                \PYG{n}{Z} \PYG{o}{=} \PYG{l+m+mi}{10000} \PYG{o}{/} \PYG{n}{Tv}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} AB + em \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} A + B + em }
                \PYG{n}{Z} \PYG{o}{=} \PYG{l+m+mi}{10000} \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{T} \PYG{o}{*} \PYG{n}{Tv}\PYG{p}{)}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{k}{if} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{em}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o+ow}{in} \PYG{n}{prod}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} A + B \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} ABp + em }
                \PYG{n}{Z} \PYG{o}{=} \PYG{l+m+mi}{10000} \PYG{o}{/} \PYG{n}{Tv}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{} AB + M \PYGZlt{}\PYGZhy{}\PYGZhy{}\PYGZgt{} A + B + M }
                \PYG{n}{Z} \PYG{o}{=} \PYG{l+m+mi}{10000} \PYG{o}{/} \PYG{n}{T}  
        
        \PYG{n}{exponent} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{o}{*}\PYG{n}{Z}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}
        
        \PYG{k}{if} \PYG{n}{exponent} \PYG{o}{\PYGZlt{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{kc\PYGZus{}min}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{kc\PYGZus{}2T} \PYG{o}{=} \PYG{n}{kc\PYGZus{}min}
        \PYG{k}{elif} \PYG{n}{exponent} \PYG{o}{\PYGZgt{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{kc\PYGZus{}max}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{kc\PYGZus{}2T} \PYG{o}{=} \PYG{n}{kc\PYGZus{}max}
        \PYG{k}{else} \PYG{p}{:}
            \PYG{n}{kc\PYGZus{}2T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{exponent}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{kc\PYGZus{}2T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\chapter{Reaction class definition}
\label{\detokenize{2_Temperature/_2T_Reaction_class_definition:reaction-class-definition}}
\sphinxAtStartPar
The reaction class definition follows.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{reaction}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{A}\PYG{p}{,} \PYG{n}{e\PYGZus{}mol}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{subreactions} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}            \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}        \PYG{o}{=} \PYG{n}{e\PYGZus{}mol}
    
    
    \PYG{k}{def} \PYG{n+nf}{add\PYGZus{}subreaction}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{subr}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{subr}\PYG{o}{.}\PYG{n}{A}     \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{A}
        \PYG{n}{subr}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{subreactions}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{subr}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Importing reactions data}
\label{\detokenize{2_Temperature/_2T_Reaction_class_definition:importing-reactions-data}}
\sphinxAtStartPar
Reactions data are taken from Park’s tables {[}1{]} and are the same as in the one temperature model.


\chapter{Problem class definition}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:problem-class-definition}}\label{\detokenize{2_Temperature/_2T_Problem_class_definition::doc}}
\sphinxAtStartPar
In the same manner of the one temperature, the problem class is a container for mixture thermodynamics, initial conditions, solution and plot functions.


\section{Thermodynamics}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:thermodynamics}}
\sphinxAtStartPar
On one hand many thermodynamic functions are the same as their one temperature equivalent, on the other hand it is necessary to define appropriate functions for the computation of the translational\sphinxhyphen{}rotational energy form the translational\sphinxhyphen{}rotational temperature and the same for the vibro\sphinxhyphen{}electronic.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{problem}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}     \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}     \PYG{o}{=} \PYG{l+m+mi}{300}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0}   \PYG{o}{=} \PYG{l+m+mf}{1.225}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0}     \PYG{o}{=} \PYG{l+m+mi}{3000}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sigma}     \PYG{o}{=} \PYG{l+m+mf}{3.14} \PYG{o}{*} \PYG{p}{(}\PYG{l+m+mf}{6.2} \PYG{o}{*} \PYG{l+m+mf}{1e\PYGZhy{}10}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{c+c1}{\PYGZsh{} Sigma HS nitrogen}
    
    \PYG{k}{def} \PYG{n+nf}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{specie}\PYG{p}{,} \PYG{n}{Y0}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{count}\PYG{p}{(}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{:}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{specie}\PYG{p}{)}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{Y0}\PYG{p}{)}
        
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{specie}\PYG{p}{)}
            \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{[}\PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Y0}
        
    \PYG{k}{def} \PYG{n+nf}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{R} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{R} \PYG{o}{+}\PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{R} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{R}
    
    \PYG{k}{def} \PYG{n+nf}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{e\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e\PYGZus{}ve}\PYG{p}{,} \PYG{n}{cv\PYGZus{}tr}\PYG{p}{,} \PYG{n}{cv\PYGZus{}ve} \PYG{o}{=} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{e1\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e1\PYGZus{}ve}\PYG{p}{,} \PYG{n}{cv1\PYGZus{}tr}\PYG{p}{,} \PYG{n}{cv1\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}
            \PYG{n}{e\PYGZus{}tr}  \PYG{o}{=} \PYG{n}{e\PYGZus{}tr} \PYG{o}{+} \PYG{n}{e1\PYGZus{}tr} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
            \PYG{n}{cv\PYGZus{}tr} \PYG{o}{=} \PYG{n}{cv\PYGZus{}tr} \PYG{o}{+} \PYG{n}{cv1\PYGZus{}tr} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
            \PYG{n}{e\PYGZus{}ve}  \PYG{o}{=} \PYG{n}{e\PYGZus{}ve} \PYG{o}{+} \PYG{n}{e1\PYGZus{}ve} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
            \PYG{n}{cv\PYGZus{}ve} \PYG{o}{=} \PYG{n}{cv\PYGZus{}ve} \PYG{o}{+} \PYG{n}{cv1\PYGZus{}ve} \PYG{o}{*}\PYG{n}{Y} \PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{e\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e\PYGZus{}ve}\PYG{p}{,} \PYG{n}{cv\PYGZus{}tr}\PYG{p}{,} \PYG{n}{cv\PYGZus{}ve}
    
    \PYG{k}{def} \PYG{n+nf}{e\PYGZus{}Y\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}Computes the derivative of energy 2T wrt Y at constant T\PYGZsq{}\PYGZsq{}\PYGZsq{}}
        \PYG{n}{e\PYGZus{}Y\PYGZus{}tr} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{e\PYGZus{}Y\PYGZus{}ve} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y\PYGZus{}tr}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{e\PYGZus{}Y\PYGZus{}tr}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{p}{,} \PYG{n}{e\PYGZus{}Y\PYGZus{}ve}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{p}{,} \PYG{n}{useless\PYGZus{}tr}\PYG{p}{,} \PYG{n}{useless\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{e\PYGZus{}Y\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e\PYGZus{}Y\PYGZus{}ve}
    
    \PYG{k}{def} \PYG{n+nf}{e\PYGZus{}Y\PYGZus{}v}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}Computes the derivative of vibrational\PYGZhy{}electronic energy wrt Y at constant T\PYGZsq{}\PYGZsq{}\PYGZsq{}}
        \PYG{n}{e\PYGZus{}Y\PYGZus{}v} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y\PYGZus{}v}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{e\PYGZus{}Y\PYGZus{}v}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}vib\PYGZus{}2T}\PYG{p}{(}\PYG{n}{Tv}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{e\PYGZus{}Y\PYGZus{}v}
    
    \PYG{k}{def} \PYG{n+nf}{only\PYGZus{}e\PYGZus{}tr}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}Computes the translational\PYGZhy{}rotational energy\PYGZsq{}\PYGZsq{}\PYGZsq{}}
        \PYG{n}{e\PYGZus{}tr} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{only\PYGZus{}e x : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{only e Y : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{e1\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e1\PYGZus{}ve}\PYG{p}{,} \PYG{n}{cv1\PYGZus{}tr}\PYG{p}{,} \PYG{n}{cv1\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
            \PYG{n}{e\PYGZus{}tr} \PYG{o}{=} \PYG{n}{e\PYGZus{}tr} \PYG{o}{+} \PYG{n}{e1\PYGZus{}tr} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{e\PYGZus{}tr}
    
    \PYG{k}{def} \PYG{n+nf}{only\PYGZus{}e\PYGZus{}ve}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}Computes the vibrational\PYGZhy{}electronic energy\PYGZsq{}\PYGZsq{}\PYGZsq{}}
        \PYG{n}{e\PYGZus{}ve} \PYG{o}{=} \PYG{l+m+mi}{0}
        \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{only\PYGZus{}e x : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{only e Y : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{e1\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}vib\PYGZus{}2T}\PYG{p}{(}\PYG{n}{Tv}\PYG{p}{)}
            \PYG{n}{e\PYGZus{}ve} \PYG{o}{=} \PYG{n}{e\PYGZus{}ve} \PYG{o}{+} \PYG{n}{e1\PYGZus{}ve} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{x}\PYG{p}{]}
        \PYG{k}{return} \PYG{n}{e\PYGZus{}ve}
    
    \PYG{k}{def} \PYG{n+nf}{T\PYGZus{}from\PYGZus{}e\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{e\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e\PYGZus{}ve}\PYG{p}{,} \PYG{n}{T0\PYGZus{}tr} \PYG{o}{=} \PYG{l+m+mf}{1e3}\PYG{p}{,} \PYG{n}{T0\PYGZus{}ve} \PYG{o}{=} \PYG{l+m+mf}{1e3}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{n}{T\PYGZus{}tr}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier\PYGZus{}tr}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{T} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e\PYGZus{}tr}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{e\PYGZus{}tr}\PYG{p}{,} \PYG{n}{x0} \PYG{o}{=} \PYG{n}{T0\PYGZus{}tr}\PYG{p}{,}
                                            \PYG{n}{xtol}\PYG{o}{=}\PYG{n}{atol} \PYG{o}{*} \PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{,} \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{n}{T\PYGZus{}ve}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier\PYGZus{}ve}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{Tv} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e\PYGZus{}ve}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{e\PYGZus{}ve}\PYG{p}{,} \PYG{n}{x0} \PYG{o}{=} \PYG{n}{T0\PYGZus{}ve}\PYG{p}{,}
                                            \PYG{n}{xtol}\PYG{o}{=}\PYG{n}{atol} \PYG{o}{*} \PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{,} \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier\PYGZus{}tr}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T\PYGZus{}tr\PYGZus{}from\PYGZus{}e did not converge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier\PYGZus{}ve}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T\PYGZus{}ve\PYGZus{}from\PYGZus{}e did not converge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
        \PYG{k}{return} \PYG{n}{T\PYGZus{}tr}\PYG{p}{,} \PYG{n}{T\PYGZus{}ve}
    
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{RH jump relations}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:rh-jump-relations}}
\sphinxAtStartPar
The Rankine\sphinxhyphen{}Hugoniot relations are the same and read: 

\sphinxAtStartPar
\( \rho_0 u_0 = \rho_1 u_1 \) 
\( \rho_0 u_0^2 + P_0 = \rho_1 u_1^2 + P_1 \) 
\( h_0^t  = e_0 + \frac{P_0}{\rho_0} + \frac{1}{2}u_0^2 = 
e_1 + \frac{P_1}{\rho_1} + \frac{1}{2} u_1^2 = h_1^t \) 
\( Y_{i_0} = Y_{i_1} \) 

\sphinxAtStartPar
Where \(P = \rho \sum_{i}^{N_s} Y_i R_i T \) and \(e = e^{tr} + e^{ve}\) 
The non\sphinxhyphen{}linear equations are written in the “RHsystem” function whose solutions are found through a non\sphinxhyphen{}linear solver.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The shock is solved with the hypothesis of frozen chemistry and constant vibrational\sphinxhyphen{}electronic temperature.
\end{sphinxadmonition}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{RHsystem\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{rho2}\PYG{p}{,} \PYG{n}{T2}\PYG{p}{,} \PYG{n}{u2} \PYG{o}{=} \PYG{n}{x}
    \PYG{n}{p2} \PYG{o}{=} \PYG{n}{rho2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n}{T2}
    \PYG{n}{e2\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e2\PYGZus{}ve}\PYG{p}{,} \PYG{n}{CV2\PYGZus{}tr}\PYG{p}{,} \PYG{n}{CV2\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{,} \PYG{n}{T2}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)}
    
    \PYG{n}{p0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}
    \PYG{n}{e0\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e0\PYGZus{}ve}\PYG{p}{,} \PYG{n}{CV0\PYGZus{}tr}\PYG{p}{,} \PYG{n}{CV0\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)}
    
    \PYG{n}{out\PYGZus{}rho} \PYG{o}{=} \PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0}\PYG{p}{)}                                  \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{rho2} \PYG{o}{*} \PYG{n}{u2}\PYG{p}{)}
    \PYG{n}{out\PYGZus{}mom} \PYG{o}{=} \PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+}  \PYG{n}{p0}\PYG{p}{)}                       \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{rho2} \PYG{o}{*} \PYG{n}{u2}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n}{p2}\PYG{p}{)}
    \PYG{n}{out\PYGZus{}ene} \PYG{o}{=} \PYG{p}{(}\PYG{n}{e0\PYGZus{}tr} \PYG{o}{+} \PYG{n}{e0\PYGZus{}ve} \PYG{o}{+} \PYG{n}{p0} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{e2\PYGZus{}tr} \PYG{o}{+} \PYG{n}{e2\PYGZus{}ve} \PYG{o}{+} \PYG{n}{p2} \PYG{o}{/} \PYG{n}{rho2} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u2} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{p}{)}
      
    \PYG{n}{out} \PYG{o}{=} \PYG{p}{[}\PYG{n}{out\PYGZus{}rho}\PYG{p}{,} \PYG{n}{out\PYGZus{}mom}\PYG{p}{,} \PYG{n}{out\PYGZus{}ene}\PYG{p}{]}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rho2, T2, u2 : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho2}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T2}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{u2}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{out}\PYG{p}{)}\PYG{p}{)}
        
    \PYG{k}{return} \PYG{n}{out}

    
\PYG{k}{def} \PYG{n+nf}{RHjump\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Build a guess assuming perfect gas with gamma = 1.4}
    \PYG{n}{gamma} \PYG{o}{=} \PYG{l+m+mf}{1.4}
    \PYG{n}{c0} \PYG{o}{=} \PYG{p}{(}\PYG{n}{gamma} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{p0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}
    \PYG{n}{M0} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{/} \PYG{n}{c0}
    \PYG{n}{M2} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{gamma} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{rho2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{*} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{/} \PYG{p}{(} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{p2} \PYG{o}{=} \PYG{n}{p0} \PYG{o}{*} \PYG{p}{(} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{gamma} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{p}{)} \PYG{o}{/} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{T2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0} \PYG{o}{*} \PYG{p}{(} \PYG{p}{(} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{gamma} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{\PYGZhy{}} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{p}{)} \PYG{o}{*} \PYG{p}{(} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{p}{)} \PYG{p}{)} \PYGZbs{}
            \PYG{o}{/} \PYG{p}{(} \PYG{p}{(} \PYG{n}{gamma} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{M0} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{p}{)}\PYG{p}{;} 
    \PYG{n}{c2} \PYG{o}{=} \PYG{p}{(}\PYG{n}{gamma} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n}{T2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{;}
    \PYG{n}{u2} \PYG{o}{=} \PYG{n}{c2} \PYG{o}{*} \PYG{n}{M2}\PYG{p}{;}
        
    \PYG{c+c1}{\PYGZsh{} Solve RH relations}
    \PYG{n}{x}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{RHsystem\PYGZus{}2T}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{,} \PYG{n}{x0} \PYG{o}{=} \PYG{p}{[}\PYG{n}{rho2}\PYG{p}{,} \PYG{n}{T2}\PYG{p}{,} \PYG{n}{u2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xtol}\PYG{o}{=}\PYG{n}{atol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{,} 
                                     \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RH not converged}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
            
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}
    
    \PYG{c+c1}{\PYGZsh{} Compute reference post shock mean free path}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
        \PYG{n}{mmol}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
    
    \PYG{n}{mmixt} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}
    
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp} \PYG{o}{=} \PYG{n}{Kb} \PYG{o}{*} \PYG{n}{T2} \PYG{o}{/} \PYG{n}{p2}  \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sigma}
    
    \PYG{n}{e2}\PYG{p}{,} \PYG{n}{cv2} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{)}
    \PYG{n}{cp} \PYG{o}{=} \PYG{n}{cv2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)}
    \PYG{n}{gamma} \PYG{o}{=} \PYG{n}{cp} \PYG{o}{/} \PYG{n}{cv2}
    \PYG{n}{c2c} \PYG{o}{=} \PYG{p}{(}\PYG{n}{gamma} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{M2c} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1} \PYG{o}{/} \PYG{n}{c2c}
    
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Pre shock Mach : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{M0}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{******************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Post\PYGZhy{}shock guess values:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho    : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T      : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Speed  : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{u2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mach   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{M2}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{******************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Post\PYGZhy{}shock values:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rho    : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T      : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tv     : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Speed  : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mach   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{M2c}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{******************************}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Reference mean free path : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{if} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{speed is negative!!! Look at RHjump}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{sys}\PYG{o}{.}\PYG{n}{exit}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{EXITING}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{problem}\PYG{o}{.}\PYG{n}{RHsystem\PYGZus{}2T} \PYG{o}{=} \PYG{n}{RHsystem\PYGZus{}2T}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{RHjump\PYGZus{}2T} \PYG{o}{=} \PYG{n}{RHjump\PYGZus{}2T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Computation of the chemical source terms}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:computation-of-the-chemical-source-terms}}
\sphinxAtStartPar
The chemical source terms are computed in the same manner as the one temperaturee model but the forward and backward reaction rates depend both on the translational\sphinxhyphen{}rotational and vibrational\sphinxhyphen{}electronic temperature according to Park’s model {[}1{]}.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{compute\PYGZus{}Sy\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{rho}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{S} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{Y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}
    \PYG{n}{Se} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{c+c1}{\PYGZsh{} Recover mmol}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
        \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{,} \PYG{n}{i}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
    
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{if} \PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{reaction}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{subreactions}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{obj} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{subreactions}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}
                \PYG{c+c1}{\PYGZsh{} Add the reactants to the reactants matrix by an incidence matrix omegar}
                \PYG{n}{omegar} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegar[k][idx] = 1}
                    \PYG{n}{omegar}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
                
                \PYG{c+c1}{\PYGZsh{} Add the products to the products matrix by an incidence matrix omegap}
                \PYG{n}{omegap} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegap[k][idx] = 1}
                    \PYG{n}{omegap}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
                
                \PYG{c+c1}{\PYGZsh{} Transform the global y vector to the local X vector}
                \PYG{n}{chi\PYGZus{}r\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)}
                \PYG{n}{chi\PYGZus{}p\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegap}\PYG{p}{)}\PYG{p}{)}
                
                \PYG{c+c1}{\PYGZsh{} Compute the reaction rate}
                \PYG{n}{R\PYGZus{}s} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kf\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{chi\PYGZus{}r\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kb\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{chi\PYGZus{}p\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{)}
                \PYG{c+c1}{\PYGZsh{}breakpoint()}
                \PYG{c+c1}{\PYGZsh{} Update the source terms for the species equation}
                \PYG{n}{S} \PYG{o}{+}\PYG{o}{=} \PYG{n}{mmol} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{,} \PYG{n}{omegap}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{,} \PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{R\PYGZus{}s}
                \PYG{c+c1}{\PYGZsh{}Update the energy source term}
                \PYG{n}{Se} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{*} \PYG{n}{R\PYGZus{}s}
                \PYG{c+c1}{\PYGZsh{} S += mmol * (np.matmul(np.transpose(omegap), obj.stoichp) \PYGZhy{} np.matmul(  np.transpose(omegar), obj.stoichr)) * w\PYGZus{}s}
                
        \PYG{k}{elif} \PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{subreaction}\PYG{p}{)}\PYG{p}{:}
                \PYG{n}{obj} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{reaction}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
                
                \PYG{c+c1}{\PYGZsh{} Add the reactants to the reactants matrix by an incidence matrix omegar}
                \PYG{n}{omegar} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{reactants}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegar[k][idx] = 1}
                    \PYG{n}{omegar}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
                
                \PYG{c+c1}{\PYGZsh{} Add the products to the products matrix by an incidence matrix omegap}
                \PYG{n}{omegap} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{[}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
                
                \PYG{k}{for} \PYG{n}{k} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{idx} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{o}{.}\PYG{n}{index}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{products}\PYG{p}{[}\PYG{n}{k}\PYG{p}{]}\PYG{p}{)}
                    \PYG{c+c1}{\PYGZsh{} omegap[k][idx] = 1}
                    \PYG{n}{omegap}\PYG{p}{[}\PYG{n}{k}\PYG{p}{,} \PYG{n}{idx}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}

                \PYG{c+c1}{\PYGZsh{} Transform the global y vector to the local X vector}
                \PYG{n}{chi\PYGZus{}r\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)}
                \PYG{n}{chi\PYGZus{}p\PYGZus{}l} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{n}{omegap}\PYG{p}{)}\PYG{p}{)}
                
                \PYG{c+c1}{\PYGZsh{} Compute the reaction rate}
                \PYG{n}{R\PYGZus{}s} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kf\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{chi\PYGZus{}r\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{kb\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{prod}\PYG{p}{(}\PYG{n}{chi\PYGZus{}p\PYGZus{}l} \PYG{o}{*}\PYG{o}{*} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{)}
                
                \PYG{c+c1}{\PYGZsh{} breakpoint()}
                \PYG{c+c1}{\PYGZsh{} Update the source terms for the species equation}
                \PYG{n}{S} \PYG{o}{+}\PYG{o}{=} \PYG{n}{mmol} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(}\PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichp}\PYG{p}{,} \PYG{n}{omegap}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{matmul}\PYG{p}{(} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{stoichr}\PYG{p}{,} \PYG{n}{omegar}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{n}{R\PYGZus{}s}
                \PYG{c+c1}{\PYGZsh{}Update the energy source term}
                \PYG{n}{Se} \PYG{o}{=} \PYG{n}{obj}\PYG{o}{.}\PYG{n}{e\PYGZus{}mol} \PYG{o}{*} \PYG{n}{R\PYGZus{}s}
                
                
        \PYG{k}{else}\PYG{p}{:} \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Member of the reaction group of this problem are ill\PYGZhy{}defined}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Se = : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Se}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{S}\PYG{p}{,} \PYG{n}{Se}


\PYG{n}{problem}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sy\PYGZus{}2T} \PYG{o}{=} \PYG{n}{compute\PYGZus{}Sy\PYGZus{}2T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Now the reaction rates \(R_{i,j}\) depend on the type of reaction considered as described above
\end{sphinxadmonition}


\section{Computation of the Vibrational\sphinxhyphen{}Translational Energy transfer and Chemical\sphinxhyphen{}Vibrational Coupling}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling}}
\sphinxAtStartPar
The source term \(S_v\) is taken into account in order to study the evolution of the vibrational\sphinxhyphen{}elecronic energy term introducted by the two\sphinxhyphen{}temperature model.
\( S_v = S_{c-v} + S_{v-t} \) 
Where:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\mathbf{S_{c-v}}\) is the vibrational energy lost or gained due to the chemical reactions. 
\( S_{c-v} = \sum_{i}^{N_s} \omega_i e^{ve}_i \) 

\item {} 
\sphinxAtStartPar
\(\mathbf{S_{v-t}} \) is the vibrational energy relaxation term between vibrational and translational energy modes due to collisions.
The energy exchange rate is modeled using the Landau\sphinxhyphen{}Teller model as: 
\( S_{v-t} = \sum_i \rho_i \frac{e^{ve,*}_i - e^{ve}_i}{\tau_i} \) 
Where \(e^{ve,*}_i\) is the vibrational\sphinxhyphen{}electronic energy of species \(i\) at the translational\sphinxhyphen{}rotational temperature \(T^{tr}\) and \(\tau_i\) is the characteristic relaxation time. For a mixture: 
\( \tau_i = \frac{\sum_r X_r}{\sum_r X_r/\tau_{ir}} \) 
\( X_i = \frac{Y_i}{M_i} \left( \sum_{r}\frac{Y_r}{M_r} \right)^{-1} \) 
\(\tau_{ir}\) is obtained from the Millikan and White’s semiempirical correlation: 
\( \tau_{ir} = \tau_{ir}^{MW} = \frac{101325}{p} exp \left[ A_{ir} \left(\left(T^{tr}\right)^{-1/3} - B_{ir} \right) - 18.42 \right] \) 
Where:
\( A_{ir} = 1.16 \cdot 10^{-3} \mu_{ir}^{1/2} \theta_{v,i}^{4/3} \) 
\( B_{ir} = 0.015 \mu_{ir}^{1/4} \) 
\( \mu_{ir} = \frac{M_i M_r}{M_i + M_r} \) 

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{compute\PYGZus{}Sv}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{rho}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{,} \PYG{n}{Sy}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{Y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Recover mmol}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} Recover theta\PYGZus{}v}
    \PYG{n}{th\PYGZus{}v} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{mmol}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol}
        \PYG{n}{th\PYGZus{}v}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{.}\PYG{n}{th\PYGZus{}v}
    
    \PYG{c+c1}{\PYGZsh{} Recover Pressure}
    \PYG{n}{p} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)} \PYG{o}{*} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{T} 
    
    \PYG{n}{ts} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{e\PYGZus{}v\PYGZus{}eq} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{e\PYGZus{}v} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{Svt} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{Y} \PYG{o}{*} \PYG{n}{mmol}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{X} \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute v\PYGZhy{}e and chemical source terms}
    \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} xr = Y[j] / mmol[j] / (np.sum(Y/mmol))}
        \PYG{n}{xr} \PYG{o}{=} \PYG{n}{X}
        \PYG{n}{mu\PYGZus{}sr} \PYG{o}{=} \PYG{n}{mmol}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{*} \PYG{n}{mmol} \PYG{o}{/} \PYG{p}{(}\PYG{n}{mmol}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{+} \PYG{n}{mmol}\PYG{p}{)}     \PYG{c+c1}{\PYGZsh{} reduced molecular weight of colliding species}
        \PYG{n}{A\PYGZus{}sr} \PYG{o}{=} \PYG{l+m+mf}{1.16e\PYGZhy{}3} \PYG{o}{*} \PYG{n}{mu\PYGZus{}sr}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{n}{th\PYGZus{}v}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)} 
        \PYG{n}{B\PYGZus{}sr} \PYG{o}{=} \PYG{l+m+mf}{0.015} \PYG{o}{*} \PYG{n}{mu\PYGZus{}sr}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}
        \PYG{n}{tau\PYGZus{}sr} \PYG{o}{=} \PYG{l+m+mi}{101325} \PYG{o}{/} \PYG{n}{p} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{A\PYGZus{}sr} \PYG{o}{*} \PYG{p}{(}\PYG{n}{T}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{B\PYGZus{}sr}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{18.42}\PYG{p}{)}
        \PYG{n}{ts}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{xr}\PYG{p}{)} \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{xr} \PYG{o}{/} \PYG{n}{tau\PYGZus{}sr}\PYG{p}{)}     
        \PYG{n}{e\PYGZus{}v}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}vib\PYGZus{}2T}\PYG{p}{(}\PYG{n}{Tv}\PYG{p}{)}
        \PYG{n}{e\PYGZus{}v\PYGZus{}eq}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{o}{.}\PYG{n}{energy\PYGZus{}vib\PYGZus{}2T}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
        \PYG{n}{Svt}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{*} \PYG{p}{(}\PYG{n}{e\PYGZus{}v\PYGZus{}eq}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]} \PYG{o}{\PYGZhy{}} \PYG{n}{e\PYGZus{}v}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{)} \PYG{o}{/} \PYG{n}{ts}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}  
        
        
    \PYG{n}{Sc} \PYG{o}{=} \PYG{n}{Sy} \PYG{o}{*} \PYG{n}{e\PYGZus{}v}
    \PYG{n}{Sv} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{Svt}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{Sc}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sv = : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Sv}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{Sv}

\PYG{n}{problem}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sv} \PYG{o}{=} \PYG{n}{compute\PYGZus{}Sv}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{2 Temperature version (Temperature version)}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:temperature-version-temperature-version}}

\subsection{Euler system of equation, 2 temperature version}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:euler-system-of-equation-2-temperature-version}}
\sphinxAtStartPar
The equations read:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Mass equation}\): 
\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0 \Longrightarrow \frac{\partial \rho}{\partial x} = - \frac{\rho}{u} \frac{\partial u}{\partial x} \)

\item {} 
\sphinxAtStartPar
\(\textbf{Momentum equation}\): 
\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \) 
Since \( P = P(\rho, T^{tr}, Y) = \rho \Sigma_i Y_i R_i T^{tr} \) , then \( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T^{tr}} d T^{tr} + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)  
The derivatives can be expressed as : 
\begin{itemize}
\item {} 
\sphinxAtStartPar
\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_i T^{tr} \) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial P}{\partial T^{tr}} = \rho \Sigma_i Y_i R_i\) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial P}{\partial Y_i} = \rho R_i T^{tr}\) 
Hence, the momentum equation can be written as : 
\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R_i T^{tr} \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_i \frac{\partial T^{tr}}{\partial x} + \rho R T^{tr} \Sigma_i \frac{\partial Y_i}{\partial x}\)

\end{itemize}

\end{itemize}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The momentum equation can be rewritten also as:
\(\frac{\partial u}{\partial x} =\frac{- \sum_i \frac{\partial p}{\partial Y_i} \frac{\partial Y_i}{\partial x} + \frac{\partial p}{\partial T} \left( \sum_i \frac{\partial e}{\partial Y_i} \frac{\partial Y_i}{\partial x} + \frac{\partial e}{\partial T^v} \frac{\partial T^v}{\partial x} \right) \left( \frac{\partial e}{\partial T} \right)^{-1}}{\rho u - \frac{\rho}{u} \frac{\partial P}{\partial \rho} - \frac{p}{\rho u} \frac{\partial P}{\partial T} \left( \frac{\partial e}{\partial T} \right)^{-1}} \)
\end{sphinxadmonition}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\textbf{Energy equation}\): 
\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\) 
Expressing the dependence of e on the thermodynamic variables: \( e = e (T, T^v, Y_i) \), then 
\( de = \frac{\partial e }{\partial T} dT + \frac{\partial e }{\partial T^v} dT^v + \Sigma \frac{\partial e }{\partial Y_i} dY_i\) 

\sphinxAtStartPar
The derivatives can be expressed as : 
\begin{itemize}
\item {} 
\sphinxAtStartPar
\( \frac{\partial e}{\partial T} = cv^{tr} (T, Y_i) \) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial e}{\partial T^v} = \frac{\partial e^v}{\partial T^v} = cv^v (T^v, Y_i) \) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial e}{\partial Y_i} = e_i(T) \) 

\item {} 
\sphinxAtStartPar
\( \frac{\partial e^v}{\partial Y_i} = e^v_i(T^v) \) 
Hence, the energy equation can be written as : 
\( \frac{\partial T}{\partial x} = \left [ \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \frac{\partial e}{\partial T^v} \frac{\partial T^v}{\partial x} - \Sigma_i \frac{\partial e}{\partial Y_i} \frac{\partial Y_i}{\partial x} \right ] \left( \frac{\partial e}{\partial T} \right)^{-1}\) 

\end{itemize}

\item {} 
\sphinxAtStartPar
\(\textbf{Vibrational energy equation}\): 
\( \rho u \frac{\partial e^v}{\partial x} = S_v \) 
Expressing the dependence of \(e^v = e^v (T^v, Y_i)\) on the thermodynamic variables:
\( de^v = \frac{\partial e^v }{\partial T^v} dT^v + \Sigma \frac{\partial e^v }{\partial Y_i} dY_i\) 
\( \frac{\partial T^v}{\partial x} = \left [ \frac{S_v}{\rho u} - \Sigma_i \frac{\partial e^v}{\partial Y_i} \frac{\partial Y_i}{\partial x} \right ] \left( \frac{\partial e^v}{\partial T^v} \right)^{-1}\)

\item {} 
\sphinxAtStartPar
\(\textbf{Species transport equation}\): 
\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Euler\PYGZus{}system\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{x}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{rho}\PYG{p}{,} \PYG{n}{u}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}
    \PYG{n}{Y} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{p}{]}
    \PYG{n}{rho\PYGZus{}x}\PYG{p}{,} \PYG{n}{u\PYGZus{}x}\PYG{p}{,} \PYG{n}{T\PYGZus{}x}\PYG{p}{,} \PYG{n}{Tv\PYGZus{}x} \PYG{o}{=} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}
    \PYG{n}{Y\PYGZus{}x} \PYG{o}{=} \PYG{n}{x\PYGZus{}x}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{p}{]}    
    
    \PYG{n}{p\PYGZus{}x} \PYG{o}{=} \PYG{l+m+mi}{0}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{t} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
        \PYG{n}{p\PYGZus{}x} \PYG{o}{+}\PYG{o}{=} \PYG{n}{rho\PYGZus{}x} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}  \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{*} \PYG{n}{T} \PYG{o}{+} \PYGZbs{}
               \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y\PYGZus{}x}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{+} \PYGZbs{}
               \PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{n}{t}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{*} \PYG{n}{T\PYGZus{}x}
    
    \PYG{n}{e2\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e2\PYGZus{}ve}\PYG{p}{,} \PYG{n}{cv\PYGZus{}tr}\PYG{p}{,} \PYG{n}{cv\PYGZus{}ve} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy\PYGZus{}2T}\PYG{p}{(} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv} \PYG{p}{)}
    \PYG{n}{e\PYGZus{}Y\PYGZus{}tr}\PYG{p}{,} \PYG{n}{e\PYGZus{}Y\PYGZus{}ve}             \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}Y\PYGZus{}2T}\PYG{p}{(} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}
    \PYG{n}{e\PYGZus{}Y\PYGZus{}v}                      \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{e\PYGZus{}Y\PYGZus{}v}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}
    \PYG{n}{e\PYGZus{}Y\PYGZus{}tot} \PYG{o}{=} \PYG{n}{e\PYGZus{}Y\PYGZus{}tr} \PYG{o}{+} \PYG{n}{e\PYGZus{}Y\PYGZus{}ve} 
    \PYG{n}{e\PYGZus{}tr\PYGZus{}T} \PYG{o}{=} \PYG{n}{cv\PYGZus{}tr}
    \PYG{n}{e\PYGZus{}ve\PYGZus{}Tv} \PYG{o}{=} \PYG{n}{cv\PYGZus{}ve}
    \PYG{n}{p\PYGZus{}Y} \PYG{o}{=} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{T} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n}{mmol}
    \PYG{n}{p\PYGZus{}T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{rho} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{)}
    \PYG{n}{p\PYGZus{}rho} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{T} \PYG{o}{*} \PYG{n}{Y} \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n}{mmol}\PYG{p}{)}
    
        
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{First term of the derivative p\PYGZus{}x: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho\PYGZus{}x} \PYG{o}{*} \PYG{n}{Y}  \PYG{o}{*} \PYG{n}{Ru} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{mmol} \PYG{o}{*} \PYG{n}{T}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{n}{p} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)} \PYG{o}{*} \PYG{n}{rho} \PYG{o}{*} \PYG{n}{T}  

    \PYG{n}{S}\PYG{p}{,} \PYG{n}{Se} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sy\PYGZus{}2T}\PYG{p}{(}\PYG{n}{rho}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{)}
    \PYG{n}{Svt} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{compute\PYGZus{}Sv}\PYG{p}{(}\PYG{n}{rho}\PYG{p}{,} \PYG{n}{T}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{,} \PYG{n}{Tv}\PYG{p}{,} \PYG{n}{S}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system R                                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system rho\PYGZus{}x            : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Y                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Y\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Y\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system T                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Tv                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Tv}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system rho              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{rho}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system cv               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{cv}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system T\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{T\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Tv\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Tv\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system p                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{p}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Se               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Se}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Svt               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Svt}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} Mass equation}
    \PYG{n}{rho\PYGZus{}xc} \PYG{o}{=} \PYG{o}{\PYGZhy{}} \PYG{n}{rho} \PYG{o}{/} \PYG{n}{u} \PYG{o}{*} \PYG{n}{u\PYGZus{}x}
    
    \PYG{c+c1}{\PYGZsh{} Momentum equation}
    \PYG{c+c1}{\PYGZsh{} u\PYGZus{}xc  = \PYGZhy{}  p\PYGZus{}x / rho / u}
    \PYG{n}{u\PYGZus{}xc}  \PYG{o}{=} \PYG{p}{(}\PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{inner}\PYG{p}{(}\PYG{n}{p\PYGZus{}Y}\PYG{p}{,} \PYG{n}{Y\PYGZus{}x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{p\PYGZus{}T} \PYG{o}{/} \PYG{n}{e\PYGZus{}tr\PYGZus{}T} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{inner}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y\PYGZus{}tot}\PYG{p}{,} \PYG{n}{Y\PYGZus{}x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{e\PYGZus{}ve\PYGZus{}Tv} \PYG{o}{*} \PYG{n}{Tv\PYGZus{}x}\PYG{p}{)} \PYG{p}{)}\PYG{o}{/} \PYGZbs{}
            \PYG{p}{(}\PYG{n}{rho} \PYG{o}{*} \PYG{n}{u} \PYG{o}{\PYGZhy{}} \PYG{n}{rho} \PYG{o}{/} \PYG{n}{u} \PYG{o}{*} \PYG{n}{p\PYGZus{}rho} \PYG{o}{\PYGZhy{}} \PYG{n}{p} \PYG{o}{/} \PYG{p}{(}\PYG{n}{rho} \PYG{o}{*} \PYG{n}{u}\PYG{p}{)} \PYG{o}{*} \PYG{n}{p\PYGZus{}T} \PYG{o}{/} \PYG{n}{e\PYGZus{}tr\PYGZus{}T} \PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Energy equation                                           \PYGZsh{} new term : de\PYGZus{}ve/dTv * dTv/dx}
    \PYG{n}{T\PYGZus{}xc}  \PYG{o}{=} \PYG{p}{(}\PYG{n}{p} \PYG{o}{/} \PYG{p}{(}\PYG{n}{rho} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{n}{rho\PYGZus{}x} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y\PYGZus{}tot} \PYG{o}{*} \PYG{n}{Y\PYGZus{}x}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{e\PYGZus{}ve\PYGZus{}Tv} \PYG{o}{*} \PYG{n}{Tv\PYGZus{}x}\PYG{p}{)} \PYG{o}{/} \PYG{n}{e\PYGZus{}tr\PYGZus{}T}
    \PYG{n}{Tv\PYGZus{}xc} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Svt} \PYG{o}{/} \PYG{p}{(}\PYG{n}{rho} \PYG{o}{*} \PYG{n}{u}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{e\PYGZus{}Y\PYGZus{}v} \PYG{o}{*} \PYG{n}{Y\PYGZus{}x}\PYG{p}{)}\PYG{p}{)} \PYG{o}{/} \PYG{n}{e\PYGZus{}ve\PYGZus{}Tv}
    
    \PYG{c+c1}{\PYGZsh{} Species equations}
    \PYG{n}{Y\PYGZus{}xc}  \PYG{o}{=} \PYG{n}{S} \PYG{o}{/} \PYG{n}{rho} \PYG{o}{/} \PYG{n}{u}
    
    \PYG{n}{x\PYGZus{}xc} \PYG{o}{=} \PYG{p}{[}\PYG{n}{rho\PYGZus{}xc}\PYG{p}{]}
    \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{u\PYGZus{}xc}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{T\PYGZus{}xc}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{Tv\PYGZus{}xc}\PYG{p}{)}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{Y\PYGZus{}xc}\PYG{p}{:}
        \PYG{n}{x\PYGZus{}xc}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}
    
    
    \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system x\PYGZus{}x              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x\PYGZus{}x}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system x\PYGZus{}c              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x\PYGZus{}xc}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system x\PYGZus{}x \PYGZhy{} x\PYGZus{}c        : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x\PYGZus{}x} \PYG{o}{\PYGZhy{}} \PYG{n}{x\PYGZus{}xc}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system S                : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{S}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Se               : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Se}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler system Svt              : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{Svt}\PYG{p}{)}\PYG{p}{)}
        
        
    \PYG{k}{return}   \PYG{n}{x\PYGZus{}x} \PYG{o}{\PYGZhy{}} \PYG{n}{x\PYGZus{}xc}
    
\PYG{k}{def} \PYG{n+nf}{Euler\PYGZus{}x\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{x\PYGZus{}spatial}\PYG{p}{,} \PYG{n}{x}\PYG{p}{,} \PYG{n}{x0} \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
        
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Solving for x = }\PYG{l+s+si}{\PYGZpc{}.12e}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}}\PYG{k}{x\PYGZus{}spatial}, end=\PYGZdq{}\PYGZdq{})
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{end}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        
        
        \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{State values  = }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)}
        
        \PYG{k}{if} \PYG{n}{x0} \PYG{o}{==} \PYG{k+kc}{None}\PYG{p}{:}
            \PYG{n}{a} \PYG{o}{=} \PYG{l+m+mf}{0.15}
            \PYG{n}{x0} \PYG{o}{=} \PYG{p}{[}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{,} \PYG{p}{(} \PYG{n}{a} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1} \PYG{o}{+} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{a}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{)}\PYG{p}{]}
            \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{:}
                \PYG{n}{x0}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}
        
        \PYG{n}{x0} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{x0}\PYG{p}{)}
        
        \PYG{n}{x\PYGZus{}x}\PYG{p}{,} \PYG{n}{infodict}\PYG{p}{,} \PYG{n}{ier}\PYG{p}{,} \PYG{n}{mesg} \PYG{o}{=} \PYG{n}{opt}\PYG{o}{.}\PYG{n}{fsolve}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x\PYGZus{}x} \PYG{p}{:} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}system\PYGZus{}2T}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{x\PYGZus{}x}\PYG{p}{)}\PYG{p}{,} 
                                            \PYG{n}{x0}\PYG{o}{=}\PYG{n}{x0}\PYG{p}{,} \PYG{n}{xtol}\PYG{o}{=}\PYG{n}{atol}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}2}\PYG{p}{,} \PYG{n}{full\PYGZus{}output}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{ier}\PYG{p}{:}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Euler\PYGZus{}x did not converge}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}    
        
        \PYG{k}{if} \PYG{n}{debug}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} print(\PYGZsq{}x\PYGZus{}x = \PYGZsq{} + str(x\PYGZus{}x))}
            \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ier = }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{ier}\PYG{p}{)}\PYG{p}{)}
            
            
        \PYG{k}{return} \PYG{n}{x\PYGZus{}x}
    
    
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}system\PYGZus{}2T} \PYG{o}{=} \PYG{n}{Euler\PYGZus{}system\PYGZus{}2T}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}x\PYGZus{}2T} \PYG{o}{=} \PYG{n}{Euler\PYGZus{}x\PYGZus{}2T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Solve, 2 temperature version}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:solve-2-temperature-version}}
\sphinxAtStartPar
The solve function is analogous to the one temperature version.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{solve\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{xf} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{:}
    
    \PYG{c+c1}{\PYGZsh{} Compute post shock values to be used as initial conditions}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{RHjump\PYGZus{}2T}\PYG{p}{(}\PYG{p}{)}
    
    \PYG{n}{y0} \PYG{o}{=} \PYG{p}{[}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{rho1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{u1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T1}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{T0}\PYG{p}{]}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Y0}\PYG{p}{:}
        \PYG{n}{y0}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{i}\PYG{p}{)}
                                                                                    \PYG{c+c1}{\PYGZsh{} True}
    \PYG{n}{sol} \PYG{o}{=} \PYG{n}{itg}\PYG{o}{.}\PYG{n}{solve\PYGZus{}ivp}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{Euler\PYGZus{}x\PYGZus{}2T}\PYG{p}{,} 
                              \PYG{p}{[}\PYG{l+m+mf}{0.0}\PYG{p}{,} \PYG{n}{xf}\PYG{p}{]}\PYG{p}{,} \PYG{n}{y0}\PYG{p}{,} \PYG{n}{method}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BDF}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{t\PYGZus{}eval}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{dense\PYGZus{}output}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{first\PYGZus{}step}\PYG{o}{=}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp} \PYG{o}{/} \PYG{l+m+mf}{1e5}\PYG{p}{,}
                              \PYG{n}{events}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{vectorized}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{rtol}\PYG{o}{=}\PYG{n}{rtol}\PYG{p}{,} \PYG{n}{atol}\PYG{o}{=}\PYG{n}{atol}\PYG{p}{)}
    
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Tv}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y} \PYG{o}{=} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{:}\PYG{p}{,}\PYG{p}{:}\PYG{p}{]}

    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x} \PYG{o}{=} \PYG{n}{sol}\PYG{o}{.}\PYG{n}{t}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol} \PYG{o}{=} \PYG{n}{sol}
    
    \PYG{c+c1}{\PYGZsh{} Compute energy}
    \PYG{n}{e\PYGZus{}tr} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{e\PYGZus{}ve} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{p} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{e\PYGZus{}tr}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e\PYGZus{}tr}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{e\PYGZus{}ve}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e\PYGZus{}ve}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Tv}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e\PYGZus{}tr} \PYG{o}{=} \PYG{n}{e\PYGZus{}tr}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e\PYGZus{}ve} \PYG{o}{=} \PYG{n}{e\PYGZus{}ve}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p} \PYG{o}{=} \PYG{n}{p}
    
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{solve\PYGZus{}2T} \PYG{o}{=} \PYG{n}{solve\PYGZus{}2T}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Post\sphinxhyphen{}processing}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:post-processing}}
\sphinxAtStartPar
Once the result in terms of state variables have been computed, the pressure, energy and molar mass fractions are recovered to be used for the visualization and analysis of the results.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{postprocess}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} Post processing}
    \PYG{c+c1}{\PYGZsh{} Gather mmol of each specie}
    \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{specie}\PYG{p}{:}
        \PYG{n}{mmol} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{mmol}\PYG{p}{,} \PYG{n}{i}\PYG{o}{.}\PYG{n}{mmol}\PYG{p}{)}
        
    \PYG{n}{e} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{p} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{X} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{e}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{only\PYGZus{}e}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{p}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{R}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}T}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}
        \PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{/} \PYG{n}{mmol}
        \PYG{c+c1}{\PYGZsh{} Normalization of the molar fraction}
        \PYG{n}{parameter} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{} print(str(parameter))}
        \PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{X}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{i}\PYG{p}{]} \PYG{o}{/} \PYG{n}{parameter}
        
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}X} \PYG{o}{=} \PYG{n}{X}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e} \PYG{o}{=} \PYG{n}{e}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p} \PYG{o}{=} \PYG{n}{p}
    
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{postprocess} \PYG{o}{=} \PYG{n}{postprocess}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:plot}}
\sphinxAtStartPar
Several plot functions have been prepared to ease analysis and comparisons. These function plot the outcome of the analysis with a double x\sphinxhyphen{}axis: the upper values represent the number of reference mean free path while the lower is the distance measured in meters from the shock.


\subsection{Temperature plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:temperature-plot}}

\subsection{Density plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:density-plot}}

\subsection{Velocity plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:velocity-plot}}

\subsection{Mass fractions plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:mass-fractions-plot}}

\subsection{Molar fractions plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:molar-fractions-plot}}

\subsection{Mass fractions log\sphinxhyphen{}plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:mass-fractions-log-plot}}

\subsection{Molar fractions log\sphinxhyphen{}plot}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:molar-fractions-log-plot}}

\section{Validation}
\label{\detokenize{2_Temperature/_2T_Problem_class_definition:validation}}
\sphinxAtStartPar
For validation purposes, the fluxes of conservative variables are computed, the relative error is plotted and the max values printed. 
The conservative fluxes are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Mass flux : \( \rho u\)

\item {} 
\sphinxAtStartPar
Momentum flux: \( \rho u^2 + P \)

\item {} 
\sphinxAtStartPar
Energy flux: \( ( \rho ( e + \frac{1}{2} u ^ 2 ) + P ) u \)

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{validate\PYGZus{}2T}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{xmax\PYGZus{}l} \PYG{o}{=} \PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{print\PYGZus{}max} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}For validation purpuses, the fluxes of conserved values are plotted as a function of x\PYGZsq{}\PYGZsq{}\PYGZsq{}}
    \PYG{c+c1}{\PYGZsh{} Set xmax}
    
    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{xmax}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{xmax\PYGZus{}l}\PYG{p}{:}
            \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax\PYGZus{}l} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}
            
        \PYG{k}{else}\PYG{p}{:} \PYG{n}{xmax} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
        
    \PYG{n}{x\PYGZus{}lambda} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot mass flux}

    \PYG{n}{subaxes\PYGZus{}mass}       \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{mass\PYGZus{}flux} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u}
    \PYG{n}{error\PYGZus{}mass\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{mass\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{mass\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{mass\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}mass2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mass flux [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot momentum flux}
    \PYG{n}{subaxes\PYGZus{}momentum}   \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{momentum\PYGZus{}flux} \PYG{o}{=} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p} 
    \PYG{n}{error\PYGZus{}momentum\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{momentum\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{momentum\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{momentum\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}momentum\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}momentum2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}momentum\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Momentum flux [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
    \PYG{n}{subaxes\PYGZus{}momentum2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}momentum}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot total enthalpy flux}
    \PYG{n}{subaxes\PYGZus{}enthalpy}     \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}
    \PYG{n}{enthalpy\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}rho} \PYG{o}{*} \PYG{p}{(} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e\PYGZus{}tr} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}e\PYGZus{}ve} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2} \PYG{p}{)} \PYG{o}{+} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}p}\PYG{p}{)} \PYG{o}{*} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}u} 
    \PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{enthalpy\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{enthalpy\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{enthalpy\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}enthalpy2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{enthalpy flux [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
    \PYG{n}{subaxes\PYGZus{}enthalpy2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}enthalpy}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Compute and plot sum of mass fractions}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}     \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplot}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{)}
    \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)} 
    \PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux} \PYG{o}{=} \PYG{p}{(} \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux} \PYG{o}{\PYGZhy{}} \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{p}{)} \PYG{o}{/} \PYG{n}{mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}x}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2} \PYG{o}{=} \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{twiny}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x\PYGZus{}lambda}\PYG{p}{,} \PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{,} \PYG{n}{ls}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} Set labels etc.}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{/} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{mfp}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x [m]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{set\PYGZus{}xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x / reference mfp [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{set\PYGZus{}ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sum of mass fractions [\PYGZhy{}]}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac2}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{subaxes\PYGZus{}mass\PYGZus{}frac}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
    
    \PYG{k}{if} \PYG{n}{print\PYGZus{}max}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum mass flux error       : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}mass\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum momentum flux error   : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}momentum\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum energy flux error     : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}enthalpy\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum mass frac error       : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{max}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{error\PYGZus{}mass\PYGZus{}frac\PYGZus{}flux}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Last value of mass flux       : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{mass\PYGZus{}flux}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Ymin                          : }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{min}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sol\PYGZus{}Y}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{plot\PYGZus{}2T} \PYG{o}{=} \PYG{n}{plot\PYGZus{}2T}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho} \PYG{o}{=} \PYG{n}{plot\PYGZus{}rho}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u} \PYG{o}{=} \PYG{n}{plot\PYGZus{}u}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{plot\PYGZus{}Y} \PYG{o}{=} \PYG{n}{plot\PYGZus{}Y}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{plot\PYGZus{}X} \PYG{o}{=} \PYG{n}{plot\PYGZus{}X}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}Y} \PYG{o}{=} \PYG{n}{logplot\PYGZus{}Y}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X} \PYG{o}{=} \PYG{n}{logplot\PYGZus{}X}
\PYG{n}{problem}\PYG{o}{.}\PYG{n}{validate\PYGZus{}2T} \PYG{o}{=} \PYG{n}{validate\PYGZus{}2T} 
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\part{Results}


\chapter{Results}
\label{\detokenize{Results/Results:results}}\label{\detokenize{Results/Results::doc}}
\sphinxAtStartPar
In the following the results of several case studies are presented:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Standard air at \(60 km\) altitude, free stream velocity of \(6 km/s\)
\begin{itemize}
\item {} 
\sphinxAtStartPar
11 species one\sphinxhyphen{}temperature mixture model

\item {} 
\sphinxAtStartPar
11 species two\sphinxhyphen{}temperature mixture model

\item {} 
\sphinxAtStartPar
7 species two\sphinxhyphen{}temperature mixture model

\end{itemize}

\item {} 
\sphinxAtStartPar
Standard air at \(40 km\) altitude, free stream velocity of \(6 km/s\)
\begin{itemize}
\item {} 
\sphinxAtStartPar
11 species one\sphinxhyphen{}temperature mixture model

\end{itemize}

\item {} 
\sphinxAtStartPar
Standard air at \(80 km\) altitude, free stream velocity of \(6 km/s\)
\begin{itemize}
\item {} 
\sphinxAtStartPar
11 species one\sphinxhyphen{}temperature mixture model

\end{itemize}

\item {} 
\sphinxAtStartPar
Air at the free\sphinxhyphen{}stream conditions presented in Expermental Methods for Studying Post Shock Relaxation {[}3{]}, Queensland University
\begin{itemize}
\item {} 
\sphinxAtStartPar
11 species two\sphinxhyphen{}temperature mixture model

\item {} 
\sphinxAtStartPar
7 species two\sphinxhyphen{}temperature mixture model

\end{itemize}

\end{enumerate}


\section{Standard air at \protect\(60 km\protect\) altitude, free stream velocity of \protect\(6 km/s\protect\)}
\label{\detokenize{Results/Results:standard-air-at-60-km-altitude-free-stream-velocity-of-6-km-s}}

\subsection{11 specie problem one\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:specie-problem-one-temperature-mixture-model}}
\sphinxAtStartPar
As a first test case we compute the chemical relaxation post\sphinxhyphen{}shock at 60 km of altitude with a free\sphinxhyphen{}stream velocity of \(u_0 = 6km/s\), which represents a typical velocity value for the reentry trajectory of space vehicles. The values of temperature and density are taken from the U.S. Standard Atmosphere Air Properties.
The composition of the gas in terms of mass fraction is assumed to be equal to \(79\% \: N_2\) and \(21\% \: O_2\). 
All the 11 species and the 47 reactions of Park’s model {[}1{]} are considered. 
The solution is computed for both one\sphinxhyphen{}temperature and two\sphinxhyphen{}temperature mixture models, then the results are compared and analyzed.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}11specie} \PYG{o}{=} \PYG{n}{problem}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add species }
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{O2}\PYG{p}{,} \PYG{l+m+mf}{0.21}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{N2}\PYG{p}{,} \PYG{l+m+mf}{0.79}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{NO}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,}  \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{O}\PYG{p}{,}  \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{O2p}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{NOp}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{N2p}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{Np}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{Op}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{em}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add reactions}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O2diss}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N2diss}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{NOdiss}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{NO\PYGZus{}O}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}N2}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}O2p}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N2\PYGZus{}Np}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}NOp} \PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N2\PYGZus{}Op}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N\PYGZus{}NOp}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O2\PYGZus{}NOp}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{NOp\PYGZus{}N}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}O}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}ion}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N\PYGZus{}ion}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set ic}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{T0}     \PYG{o}{=} \PYG{l+m+mf}{273.15} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{26.13} 
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{rho0}   \PYG{o}{=} \PYG{l+m+mf}{3.097e\PYGZhy{}4}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{u0}     \PYG{o}{=} \PYG{l+m+mi}{6000}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-output}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Solve}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{11 species two\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:species-two-temperature-mixture-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}11specie\PYGZus{}2T} \PYG{o}{=} \PYG{n}{cp}\PYG{o}{.}\PYG{n}{deepcopy}\PYG{p}{(}\PYG{n}{\PYGZus{}11specie}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{solve\PYGZus{}2T}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Pre shock Mach : 18.977626837981823
******************************
Post\PYGZhy{}shock guess values:
rho    : 0.0018327556843828609
T      : 17531.821544944738
Speed  : 1013.883091911242
Mach   : 0.380654589983921
******************************
Post\PYGZhy{}shock values:
rho    : 0.0018327556843828602
T      : 17531.82154494475
Tv     : 247.01999999999998
Speed  : 1013.8830919112426
Mach   : 0.4200041813142019
******************************
Reference mean free path : 2.1592729644619046e\PYGZhy{}05

Solving for x = 1.000000000000e+00
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Plot}
\label{\detokenize{Results/Results:plot}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_9_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
The plot above represents the temperature, density, molar fractions and velocity of the flow. Dotted lines are the solution of the one\sphinxhyphen{}temperature model. 

\sphinxAtStartPar
The flow proprerties reach the equilibrium after less than 50 reference mean free paths. For the hypotesis made the vibrational\sphinxhyphen{}electronic temperature past the shock is the same as its pre\sphinxhyphen{}shock value. For this reason, the energy jump across the shock affects mainly the kinetic energy of the flow and its roto\sphinxhyphen{}translational temperature, resulting in values higher than those obtained with the one\sphinxhyphen{}temperature model. Post\sphinxhyphen{}shock speed is rapidly reduced from over \(1000 m/s\) to about \(730 m/s\) (in 10 reference mean free path) as the kinetic energy is consumed in favor of chemical reactions, leading to an increase of the gas density. Then they all relax until they reach the equilibrium values that is the same of the one temperature model. 
The plot of the evolution of the molar fractions shows that the dissociation reactions are slower in the two\sphinxhyphen{}temperature model than in the one\sphinxhyphen{}temperature model because the vibrational temperature, initially much lower than the roto\sphinxhyphen{}translational one, appears to the exponent of the forward reaction coefficient that describes these reactions.


\subsubsection{Validate}
\label{\detokenize{Results/Results:validate}}
\sphinxAtStartPar
The validation plots show that the flux of the conservative variables are constant up to a small tolerance for both mixture models.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{validate}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Maximum mass flux error       : 1.2743367155109934e\PYGZhy{}11
Maximum momentum flux error   : 1.8302061867015884e\PYGZhy{}11
Maximum enthalpy flux error   : 7.530491418568231e\PYGZhy{}06
Maximum mass frac error       : 8.053557820630886e\PYGZhy{}13
Last value of mass flux       : 1.858200000023658
Ymin                          : 0.0
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Results_15_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}11specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{validate\PYGZus{}2T}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Maximum mass flux error       : 3.36163008837126e\PYGZhy{}11
Maximum momentum flux error   : 3.3447399890898415e\PYGZhy{}11
Maximum energy flux error     : 5.468170935252123e\PYGZhy{}06
Maximum mass frac error       : 3.402833570476105e\PYGZhy{}13
Last value of mass flux       : 1.8582000000624601
Ymin                          : \PYGZhy{}3.8923675370333667e\PYGZhy{}72
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Results_16_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{7 species two\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:id1}}
\sphinxAtStartPar
The same problem is studied by 7 species model.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T} \PYG{o}{=} \PYG{n}{problem}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add species }
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{O2}\PYG{p}{,} \PYG{l+m+mf}{0.21}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{N2}\PYG{p}{,} \PYG{l+m+mf}{0.79}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{NO}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,}  \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{O}\PYG{p}{,}  \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{NOp}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{add\PYGZus{}specie\PYGZus{}ic}\PYG{p}{(}\PYG{n}{em}\PYG{p}{,}  \PYG{l+m+mf}{0.0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Add reactions}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O2diss\PYGZus{}7s}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{N2diss\PYGZus{}7s}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{NOdiss\PYGZus{}7s}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{NO\PYGZus{}O}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}N2}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{reaction}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{O\PYGZus{}\PYGZus{}\PYGZus{}N}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Set ic}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{T0}     \PYG{o}{=} \PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{T0}     
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{rho0}   \PYG{o}{=} \PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{rho0} 
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{u0}     \PYG{o}{=} \PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{u0}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{solve\PYGZus{}2T}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Pre shock Mach : 18.977626837981823
******************************
Post\PYGZhy{}shock guess values:
rho    : 0.0018327556843828609
T      : 17531.821544944738
Speed  : 1013.883091911242
Mach   : 0.380654589983921
******************************
Post\PYGZhy{}shock values:
rho    : 0.0018327556843828602
T      : 17531.82154494475
Tv     : 247.01999999999998
Speed  : 1013.8830919112426
Mach   : 0.4200041813142019
******************************
Reference mean free path : 2.1592729644619046e\PYGZhy{}05

Solving for x = 1.000000000000e+00
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Plot}
\label{\detokenize{Results/Results:id2}}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_22_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
For the condition considered there is no remarkable difference between the two models but in the molar fractions, where the 11 species model allows production of small amounts of ionized molecules.


\section{Standard air at \protect\(40 km\protect\) altitude, free stream velocity of \protect\(6 km/s\protect\)}
\label{\detokenize{Results/Results:standard-air-at-40-km-altitude-free-stream-velocity-of-6-km-s}}
\sphinxAtStartPar
To study how the flow in the relaxation zone behaves if the pre\sphinxhyphen{}shock mach number is about the same but the average molecular free path is lower, a flow with free\sphinxhyphen{}stream velocity of 6 km/s (typical value of space vehicles re\sphinxhyphen{}entry velocity) is analyzed but with the conditions of density and temperature at 40 km altitude.


\subsection{11 species two\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:id3}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{low\PYGZus{}altitude} \PYG{o}{=} \PYG{n}{cp}\PYG{o}{.}\PYG{n}{deepcopy}\PYG{p}{(}\PYG{n}{\PYGZus{}11specie}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} at 40 km of altitude}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{273.15} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{22.8}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{=} \PYG{l+m+mf}{3.996e\PYGZhy{}3}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{=} \PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{u0}

\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Pre shock Mach : 18.850990022482666
******************************
Post\PYGZhy{}shock guess values:
rho    : 0.02364333250562184
T      : 17534.963959261022
Speed  : 1014.0702455670773
Mach   : 0.3806907392903729
******************************
Post\PYGZhy{}shock values:
rho    : 0.03290941899249966
T      : 13317.44513933993
Speed  : 728.5452230397748
Mach   : 0.33856225872955314
******************************
Reference mean free path : 1.673799494555518e\PYGZhy{}06

A Solving for x = 1.000000000000e+00
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mf}{5e\PYGZhy{}3}
\PYG{n}{xmax\PYGZus{}l} \PYG{o}{=} \PYG{l+m+mf}{3e7}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{)}

\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{plot\PYGZus{}T}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{low\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}

\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{plot\PYGZus{}T}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,} \PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_28_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
While the values of velocity and temperature of the post\sphinxhyphen{}shock flow are very similar, their evolution as well as density values are noticeably different. The free mean molecular path is smaller, as well as the average collision time, which leads to a shorter relaxation region. To allow a more appropriate comparison, results are compared on a spatial coordiante scaled on mean free paths.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_30_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
The upper plots show the temperature evolution in physical space (meters). The lower plots instead show the temperature evolution in terms on number of reference mean free paths. Despite the different initial conditions, the extension of the relaxation region measured in terms of mean free paths is approximately the same.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_32_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
The arguments aforementioned hold for the mass fractions evolution. Furthermore, in a flow where all atoms and molecules are in the gaseous phase, a greater pressure shifts the chemical equilibrium in the direction in which there is a lower number of atoms and molecules. For this reason in the case of higher density there is a higher concentration of molecules such as \(NO, O_2, N_2\).


\section{Standard air at \protect\(80 km\protect\) altitude, free stream velocity of \protect\(6 km/s\protect\)}
\label{\detokenize{Results/Results:standard-air-at-80-km-altitude-free-stream-velocity-of-6-km-s}}
\sphinxAtStartPar
A further study is made considering as initial conditions those of the air at the altitude of 80km. This analysis allows to investigate how the flow behaves in case of larger mean free paths and a higher pre\sphinxhyphen{}shock mach number.


\subsection{11 species two\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:id4}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{high\PYGZus{}altitude} \PYG{o}{=} \PYG{n}{cp}\PYG{o}{.}\PYG{n}{deepcopy}\PYG{p}{(}\PYG{n}{\PYGZus{}11specie}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} at 80 km of altitude}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{T0} \PYG{o}{=} \PYG{l+m+mf}{273.15} \PYG{o}{\PYGZhy{}} \PYG{l+m+mf}{74.51}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{rho0} \PYG{o}{=} \PYG{l+m+mf}{1.846e\PYGZhy{}5}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{u0} \PYG{o}{=} \PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{u0}

\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{solve}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Pre shock Mach : 21.162872144357774
******************************
Post\PYGZhy{}shock guess values:
rho    : 0.00010953712483461731
T      : 17486.162983264207
Speed  : 1011.1640246832204
Mach   : 0.3801290496550789
******************************
Post\PYGZhy{}shock values:
rho    : 0.00015234301903586223
T      : 13287.505690929016
Speed  : 727.0434884447383
Mach   : 0.3381727767484634
******************************
Reference mean free path : 0.00036128571073294367

A Solving for x = 1.000000000000e+00
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}1}
\PYG{n}{xmax\PYGZus{}l} \PYG{o}{=} \PYG{l+m+mf}{3e7}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{)}

\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{plot\PYGZus{}T}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{high\PYGZus{}altitude}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}

\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{plot\PYGZus{}T}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,} \PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_38_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
As expected the relaxation region is longer, more physical space (meters) is required to achieve equilibrium.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_42_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
In accordance with what explained before, a lower density shifts the equilibrium towards a greater number of atoms and molecules.


\section{Air at the free\sphinxhyphen{}stream conditions presented in Expermental Methods for Studying Post Shock Relaxation {[}3{]}, Queensland University}
\label{\detokenize{Results/Results:air-at-the-free-stream-conditions-presented-in-expermental-methods-for-studying-post-shock-relaxation-3-queensland-university}}
\sphinxAtStartPar
To study the effect of higher temperature, the pre\sphinxhyphen{}shock conditions reported in Expermental Methods for Studying Post Shock Relaxation {[}3{]}, are used as reference, despite the different configuration. In this case, a hypersonic flow at high temperature and low density that simulates a re\sphinxhyphen{}entry into the Earth’s atmosphere is analyzed.


\subsection{11 species two\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:id5}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q} \PYG{o}{=} \PYG{n}{cp}\PYG{o}{.}\PYG{n}{deepcopy}\PYG{p}{(}\PYG{n}{\PYGZus{}11specie}\PYG{p}{)}

\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{T0}     \PYG{o}{=} \PYG{l+m+mi}{2242}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{rho0}   \PYG{o}{=} \PYG{l+m+mi}{147}\PYG{o}{/}\PYG{l+m+mf}{287.05}\PYG{o}{/}\PYG{l+m+mi}{2242}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{u0}     \PYG{o}{=} \PYG{l+m+mf}{11.3}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mf}{1.4}\PYG{o}{*}\PYG{l+m+mi}{287}\PYG{o}{*}\PYG{l+m+mi}{2242}\PYG{p}{)} 

\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{solve\PYGZus{}2T}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Pre shock Mach : 11.260044859663642
******************************
Post\PYGZhy{}shock guess values:
rho    : 0.0013184928800620583
T      : 57387.77872917684
Speed  : 1858.0080880741618
Mach   : 0.38556233671715295
******************************
Post\PYGZhy{}shock values:
rho    : 0.0013184928800620578
T      : 57387.77872917686
Tv     : 2242
Speed  : 1858.0080880741627
Mach   : 0.4070895015889073
******************************
Reference mean free path : 3.0014722563883104e\PYGZhy{}05

Solving for x = 1.000000000000e+00
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mf}{1.5e\PYGZhy{}3}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{sharey} \PYG{o}{=} \PYG{k+kc}{True}\PYG{p}{)}

\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Air, 60 km}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{set\PYGZus{}title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Queensland expansion tube}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{\PYGZus{}11specie\PYGZus{}2T}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_48_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The high temperature promotes dissociation and ionization. Since the composition of mixture changes abruptly and at the equilibrium the molar fraction of \(N_2\) is \(X_{N_2}\sim 20\%\), the mean free path of the mixture is quite different from the reference value, thus the outcome of the computation is shown in physical space.


\subsection{7 species two\sphinxhyphen{}temperature mixture model}
\label{\detokenize{Results/Results:id6}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q} \PYG{o}{=} \PYG{n}{cp}\PYG{o}{.}\PYG{n}{deepcopy}\PYG{p}{(}\PYG{n}{\PYGZus{}7specie\PYGZus{}2T}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{T0}     \PYG{o}{=} \PYG{l+m+mi}{2242}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{rho0}   \PYG{o}{=} \PYG{l+m+mi}{147}\PYG{o}{/}\PYG{l+m+mf}{287.05}\PYG{o}{/}\PYG{l+m+mi}{2242}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{u0}     \PYG{o}{=} \PYG{l+m+mf}{11.3}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mf}{1.4}\PYG{o}{*}\PYG{l+m+mi}{287}\PYG{o}{*}\PYG{l+m+mi}{2242}\PYG{p}{)} 

\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{solve\PYGZus{}2T}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{postprocess}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Pre shock Mach : 11.260044859663642
******************************
Post\PYGZhy{}shock guess values:
rho    : 0.0013184928800620583
T      : 57387.77872917684
Speed  : 1858.0080880741618
Mach   : 0.38556233671715295
******************************
Post\PYGZhy{}shock values:
rho    : 0.0013184928800620578
T      : 57387.77872917686
Tv     : 2242
Speed  : 1858.0080880741627
Mach   : 0.4070895015889073
******************************
Reference mean free path : 3.0014722563883104e\PYGZhy{}05

Solving for x = 1.000000000000e+00
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_52_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
While the 7 specie mixture model at low temeperature is reliable, at high temperature, when molar fractions of ionized molecules become relevant, the description of mixture is incomplete.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}3}
\PYG{n}{xmax\PYGZus{}l} \PYG{o}{=} \PYG{l+m+mf}{3e7}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{)}

\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{plot\PYGZus{}2T}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}
\PYG{n}{\PYGZus{}7specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{)}

\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{plot\PYGZus{}2T}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rho}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{logplot\PYGZus{}X}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,}\PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{\PYGZus{}11specie\PYGZus{}Q}\PYG{o}{.}\PYG{n}{plot\PYGZus{}u}\PYG{p}{(}\PYG{n}{ax}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,} \PYG{n}{xmax} \PYG{o}{=} \PYG{n}{xmax}\PYG{p}{,} \PYG{n}{ls} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{tight\PYGZus{}layout}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Results_54_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
The above mentioned fact becomes evident from the comparison of the two models, where not only the molar fraction of the ionized species are missing, but also the flow variables, such as temperature, density and velocity, tend to different equilibrium values.







\renewcommand{\indexname}{Index}
\printindex
\end{document}