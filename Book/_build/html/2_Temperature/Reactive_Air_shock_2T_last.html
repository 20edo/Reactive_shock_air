
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reactive air shock &#8212; Reactive air shock assignment</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/Logo_Politecnico_Milano.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Reactive air shock assignment</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  One temperature code description
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/1T_code_structure.html">
   One temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/Specie_class_definition.html">
   Specie class definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/Reaction_class_definition.html">
   Reaction and sub-reaction classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/Problem_class_definition.html">
   Problem class definition
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Two-temperatures code description
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_code_structure.html">
   Two-temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_Specie_class_definition.html">
   Specie class definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_Reaction_class_definition.html">
   Reaction and sub-reaction classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_Problem_class_definition.html">
   Problem class definition
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Results
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Results/Results.html">
   Results
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/2_Temperature/Reactive_Air_shock_2T_last.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/20edo/Reactive_shock_air/master?urlpath=tree/Book/2_Temperature/Reactive_Air_shock_2T_last.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Reactive air shock
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specie-class-definition">
     Specie class definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-species-data">
     Importing species data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chemical-reaction-class-definition">
   Chemical reaction class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-reactions-data">
     Importing reactions data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-class-definition">
   Problem class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rh-jump-relations">
     RH jump relations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
     Computation of the chemical source terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling">
     Computation of the Vibrational-Translational Energy transfer and Chemical-Vibrational Coupling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-shock-relax-chemistry-funciton">
     Pre-shock relax chemistry funciton
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-version">
     Temperature version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-temperature-version">
       Euler system of equation and solve function, temperature version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-temperature-version">
       Solve, temperature version
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-version-temperature-version">
     2 Temperature version (Temperature version)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-2-temperature-version">
       Euler system of equation, 2 temperature version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-2-temperature-version">
       Solve, 2 temperature version
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specie-problem">
   11 specie problem
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-altitude-density">
     Effect of altitude (density)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-velocity">
     Effect of velocity
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-composition">
     Effect of composition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#o2-dissociation">
   O2 Dissociation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reactive air shock</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Reactive air shock
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specie-class-definition">
     Specie class definition
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-species-data">
     Importing species data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chemical-reaction-class-definition">
   Chemical reaction class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-reactions-data">
     Importing reactions data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-class-definition">
   Problem class definition
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rh-jump-relations">
     RH jump relations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
     Computation of the chemical source terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling">
     Computation of the Vibrational-Translational Energy transfer and Chemical-Vibrational Coupling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pre-shock-relax-chemistry-funciton">
     Pre-shock relax chemistry funciton
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-version">
     Temperature version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-and-solve-function-temperature-version">
       Euler system of equation and solve function, temperature version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-temperature-version">
       Solve, temperature version
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-version-temperature-version">
     2 Temperature version (Temperature version)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#euler-system-of-equation-2-temperature-version">
       Euler system of equation, 2 temperature version
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solve-2-temperature-version">
       Solve, 2 temperature version
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specie-problem">
   11 specie problem
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-altitude-density">
     Effect of altitude (density)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-velocity">
     Effect of velocity
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effect-of-composition">
     Effect of composition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#o2-dissociation">
   O2 Dissociation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="reactive-air-shock">
<h1>Reactive air shock<a class="headerlink" href="#reactive-air-shock" title="Permalink to this headline">¶</a></h1>
<p>In this report a code to compute the chemical relaxation past a shock is developed. [Aggiungere cose]</p>
<p>Firstly, as python is used, the required packages are imported and global variables are defined.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">itg</span>
</pre></div>
</div>
</div>
</div>
<p>Here the finction “find letter” is defined in order to distinguish the different forward rate constant <span class="math notranslate nohighlight">\(k_c\)</span> according to the chemical reaction considered. See <a class="reference external" href="#Chemical-reaction-class-definition">Chemical reaction class definition</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_letter</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">letter</span> <span class="ow">in</span> <span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Kb</span>  <span class="o">=</span> <span class="mf">1.3806503e-23</span><span class="p">;</span>  <span class="c1"># Boltzmann constant [J/K]</span>
<span class="n">amu</span> <span class="o">=</span> <span class="mf">1.66053904020e-24</span><span class="p">;</span> <span class="c1"># 1/Avogadro&#39;s number [mol]</span>
<span class="n">Ru</span> <span class="o">=</span> <span class="n">Kb</span><span class="o">/</span><span class="n">amu</span> <span class="c1">#[J/(K*mol)]</span>

<span class="c1"># I set minimum and maximum values for the equilibrium constant Kc </span>
<span class="c1"># in order to avoid convergence problem due to too big or too small numerical values</span>
<span class="n">kc_min</span> <span class="o">=</span> <span class="mf">1e-20</span>
<span class="n">kc_max</span> <span class="o">=</span> <span class="mf">1e20</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">#rtol = 1e-3</span>
<span class="c1">#atol = 1e-6</span>
<span class="n">rtol</span> <span class="o">=</span> <span class="mf">1e-12</span>
<span class="n">atol</span> <span class="o">=</span> <span class="mf">1e-12</span>
<span class="n">debug</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># tolleranze per la soluzione due sistemi</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="specie-class-definition">
<h2>Specie class definition<a class="headerlink" href="#specie-class-definition" title="Permalink to this headline">¶</a></h2>
<p>For each specie a common framework is defined which allows to compute thermodynamic derivatives, energy, temperature and other relevant values for the subsequent calculations starting from the data provided by Park and Zanardi.</p>
<p>Assuming that the different contributions can be computed indipendently, the energy and CVs are defined as the sum of the translational-rotational, vibrational and electronic contributions which are calculated as:</p>
<ul>
<li><p>Translational-rotational :</p>
<ol class="simple">
<li><p>If the molecule is monoatomic, it has no rotational dofs, then <span class="math notranslate nohighlight">\( CV^t_s = \frac{3}{2} R_{gas} \)</span> where <span class="math notranslate nohighlight">\(R_{gas} = \frac{\Re_u}{M_s}\)</span></p></li>
<li><p>If the molecule is not monoatomic, the rotational contribution must be added <span class="math notranslate nohighlight">\( CV^{tr}_s = CV^t_s + R_{gas} \)</span></p></li>
</ol>
<p>Then, energy is computed as $<span class="math notranslate nohighlight">\(e^{tr}_s = CV^{rt}_s  T^{tr}\)</span>$</p>
</li>
<li><p>Vibrational :
The contribution of vibrational dofs to energy is computed by assuming armhonic oscillator potential. The energy becomes: $<span class="math notranslate nohighlight">\(e^{v}_s = R_{gas} \frac{\theta^v_s}{e^{\frac{\theta^v_s}{T^v}-1}} \)</span><span class="math notranslate nohighlight">\( 
  The analytical expression for the specific heat at constant volume is computed by deriving with respect to T, leading to the expression: &lt;br&gt; 
  \)</span><span class="math notranslate nohighlight">\(CV^{v}_s = R_{gas} \frac{(\theta^v_s/T^v)^2 e^{\theta^v_s/T^v}} {(e^{\theta^v_s/T^v}-1)^2}\)</span>$</p></li>
<li><p>Electronic :
Given the i-th energy level degeneracy <span class="math notranslate nohighlight">\(g_{s,i}\)</span> and the characteristic electronic temperature of specie s for the j-th level <span class="math notranslate nohighlight">\(\theta^{el}_{s,j}\)</span> (Zanardi’s tables), the energy of the electronic energy levels is computed as: $<span class="math notranslate nohighlight">\( e^{el}_s = R_{gas}T^2 \frac{\partial}{\partial T} log(Z) = \frac{R_{gas}}{Z^{el}} \sum_i g_{s,i} \theta^{el}_{s,i} e^{-\frac{\theta^{el}_{s,i}}{T^{el}}}\)</span><span class="math notranslate nohighlight">\(
  Whereas:  \)</span><span class="math notranslate nohighlight">\(Z^{el} = \sum_i g_{s,i} e^{-\frac{\theta^{el}_{s,i}}{T^{el}}}\)</span>$</p>
<p>Analogously with the vibrational contribution the expression for the specific heat is obtained deriving the formula with respect to T: $<span class="math notranslate nohighlight">\(CV^{el}_s = \frac{R_{gas}}{(T^{el})^2} \left [ \frac{1}{Z^{el}} \sum_i g_{s,i} \left( \theta^{el}_{s,i}\right)^2 e^{-\frac{\theta^{el}_{s,i}}{T^{el}}} - \left( \frac{e^{el}_s}{R_{gas}} \right)^2 \right ] \)</span>$</p>
</li>
</ul>
<p>All energies are written as energy whose reference temperature is <span class="math notranslate nohighlight">\(T_0 = 298.15 K\)</span>. <br></p>
<p>In this way the energy associated to each specie <span class="math notranslate nohighlight">\(i\)</span> is computed as:
$<span class="math notranslate nohighlight">\(
e^{tot}_i = \int_{T_0}^{T}CV^{(t,r,v,e)}_i dT - R_i T_0 + \Delta h^0_{f,i}
\)</span>$</p>
<p>For the two-temperature model has been assumed that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T^t = T^r = T^{tr} \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(T^v = T^{el} = T^{ve} \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">specie</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">th_v</span><span class="p">,</span> <span class="n">th_r</span><span class="p">,</span> <span class="n">h_form</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_v</span> <span class="o">=</span> <span class="n">th_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_r</span> <span class="o">=</span> <span class="n">th_r</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_rot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_vib</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_ele</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mmol</span> <span class="o">=</span> <span class="n">mmol</span><span class="o">*</span><span class="mf">1e-3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">Ru</span><span class="o">/</span><span class="p">(</span><span class="n">mmol</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_form</span> <span class="o">=</span> <span class="n">h_form</span>
        <span class="n">specie</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="s1">&#39;Computes the energy and Cv as the sum of translational-rotational, vibrational and electronic contributions&#39;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">T0</span> <span class="o">=</span> <span class="mf">298.15</span>
        
        <span class="c1"># Traslational - rotational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cv_rot</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv_rot</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
            
        <span class="n">e_rot</span>  <span class="o">=</span> <span class="n">cv_rot</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">T0</span><span class="p">)</span>
        
        <span class="c1"># Vibrational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cv_vib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv_vib</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Electronic</span>
        <span class="c1"># Z  = np.sum(self.electro_g * np.exp(-self.electro_th/T))</span>
        <span class="c1"># Z0 = np.sum(self.electro_g * np.exp(-self.electro_th/T0))</span>
        <span class="c1"># Z1 = np.sum(self.electro_g * np.exp(-self.electro_th/T) * self.electro_th)</span>
        <span class="c1"># Z10= np.sum(self.electro_g * np.exp(-self.electro_th/T0) * self.electro_th)</span>
        <span class="c1"># Z2 = np.sum(self.electro_g * np.exp(-self.electro_th/T) * self.electro_th**2) </span>
        <span class="c1"># Z20= np.sum(self.electro_g * np.exp(-self.electro_th/T0) * self.electro_th**2) </span>
        <span class="n">Z</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T</span><span class="p">))</span>
        <span class="n">Z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">))</span>
        <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z10</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
        <span class="n">Z20</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
        <span class="n">e_ele</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z1</span> <span class="o">/</span> <span class="n">Z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z10</span> <span class="o">/</span> <span class="n">Z0</span>
        <span class="n">cv_ele</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">e_ele</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Z2</span> <span class="o">/</span> <span class="n">Z</span><span class="p">)</span>
        
        <span class="c1"># Update Cv and e values</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">cv_rot</span> <span class="o">+</span> <span class="n">cv_vib</span> <span class="o">+</span> <span class="n">cv_ele</span>
        <span class="n">e</span>  <span class="o">=</span> <span class="n">e_rot</span>  <span class="o">+</span> <span class="n">e_vib</span>  <span class="o">+</span> <span class="n">e_ele</span> 
        <span class="n">e</span>  <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T0</span>                         <span class="c1"># Additional term to transform in sensible energy</span>
        <span class="n">e</span>  <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_form</span>
        
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">cv</span>
    
    <span class="k">def</span> <span class="nf">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="s1">&#39;Computes the energy and Cv as the sum of translational-rotational, vibrational and electronic contributions&#39;</span>
        <span class="n">e_tr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">e_ve</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cv_tr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">cv_ve</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">T0</span> <span class="o">=</span> <span class="mf">298.15</span>
        
        <span class="c1"># Traslational - rotational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_r</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cv_rot</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv_rot</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span>
            
        <span class="n">e_rot</span>  <span class="o">=</span> <span class="n">cv_rot</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="n">T0</span><span class="p">)</span>
        
        <span class="c1"># Vibrational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cv_vib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">Tv</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cv_vib</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Electronic</span>
        <span class="n">Z</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">Tv</span><span class="p">))</span>
        <span class="n">Z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">))</span>
        <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z10</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
        <span class="n">Z20</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
        <span class="n">e_ele</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z1</span> <span class="o">/</span> <span class="n">Z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z10</span> <span class="o">/</span> <span class="n">Z0</span>
        <span class="n">cv_ele</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">Tv</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">e_ele</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Z2</span> <span class="o">/</span> <span class="n">Z</span><span class="p">)</span>
        
        <span class="c1"># Update Cv and e values</span>
        <span class="n">cv_tr</span> <span class="o">=</span> <span class="n">cv_rot</span> 
        <span class="n">cv_ve</span> <span class="o">=</span> <span class="n">cv_vib</span> <span class="o">+</span> <span class="n">cv_ele</span>
        <span class="n">e_tr</span>  <span class="o">=</span> <span class="n">e_rot</span>  
        <span class="n">e_ve</span>  <span class="o">=</span> <span class="n">e_vib</span>  <span class="o">+</span> <span class="n">e_ele</span> 
        <span class="n">e_tr</span>  <span class="o">=</span> <span class="n">e_tr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">h_form</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T0</span>      <span class="c1"># Additional term to transform in sensible energy</span>
        
        <span class="k">return</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span>
    
    <span class="k">def</span> <span class="nf">energy_vib_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="s1">&#39;Computes the energy and Cv as the sum of vibrational and electronic contributions&#39;</span>
        <span class="n">e_ve</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">T0</span> <span class="o">=</span> <span class="mf">298.15</span>
        
        <span class="c1"># Vibrational </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">th_v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">th_v</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">e_vib</span>  <span class="o">=</span> <span class="mi">0</span>
            
        <span class="c1"># Electronic</span>
        <span class="n">Z</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">Tv</span><span class="p">))</span>
        <span class="n">Z0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">))</span>
        <span class="n">Z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>
        <span class="n">Z10</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="o">/</span><span class="n">T0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">electro_th</span><span class="p">)</span>

        <span class="n">e_ele</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z1</span> <span class="o">/</span> <span class="n">Z</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Z10</span> <span class="o">/</span> <span class="n">Z0</span>

        
        <span class="n">e_ve</span>  <span class="o">=</span> <span class="n">e_vib</span>  <span class="o">+</span> <span class="n">e_ele</span> 
        
        <span class="k">return</span> <span class="n">e_ve</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="importing-species-data">
<h2>Importing species data<a class="headerlink" href="#importing-species-data" title="Permalink to this headline">¶</a></h2>
<p>Species are defined as objects of class specie and properties are defined according to the tables in Zanardi.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N2</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">28.0134</span><span class="p">,</span> <span class="mi">3395</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">N2</span><span class="o">.</span><span class="n">electro_g</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">N2</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.2231565e+04</span><span class="p">,</span> <span class="mf">8.5778626e+04</span><span class="p">,</span> <span class="mf">8.6050267e+04</span><span class="p">,</span> <span class="mf">9.5351186e+04</span><span class="p">,</span> <span class="mf">9.8056357e+04</span><span class="p">,</span>
                          <span class="mf">9.9682677e+04</span><span class="p">,</span> <span class="mf">1.0489765e+05</span><span class="p">,</span> <span class="mf">1.1164896e+05</span><span class="p">,</span> <span class="mf">1.2258365e+05</span><span class="p">,</span> <span class="mf">1.2488569e+05</span><span class="p">,</span> 
                          <span class="mf">1.2824762e+05</span><span class="p">,</span> <span class="mf">1.3380609e+05</span><span class="p">,</span> <span class="mf">1.4042964e+05</span><span class="p">,</span> <span class="mf">1.5049589e+05</span><span class="p">])</span>
<span class="n">N2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;N2&#39;</span>

<span class="n">O2</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">31.9988</span><span class="p">,</span> <span class="mf">2239.0</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">O2</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">O2</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1391560e+04</span><span class="p">,</span> <span class="mf">1.8984739e+04</span><span class="p">,</span> <span class="mf">4.7559736e+04</span><span class="p">,</span> <span class="mf">4.9912421e+04</span><span class="p">,</span> <span class="mf">5.0922686e+04</span><span class="p">,</span>
                         <span class="mf">7.1898633e+04</span><span class="p">])</span>
<span class="n">O2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span>

<span class="n">O</span>  <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">15.9994</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5574e+07</span><span class="p">)</span>
<span class="n">O</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">O</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.2770776e+02</span><span class="p">,</span> <span class="mf">3.2656888e+02</span><span class="p">,</span> <span class="mf">2.2830286e+04</span><span class="p">,</span> <span class="mf">4.8619930e+04</span><span class="p">])</span>
<span class="n">O</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">14.0067</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.3747e+07</span><span class="p">)</span>
<span class="n">N</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">N</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.7664696e+04</span><span class="p">,</span> <span class="mf">4.1493093e+04</span><span class="p">])</span>
<span class="n">N</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span>

<span class="n">NO</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">30.0061</span><span class="p">,</span> <span class="mf">2817.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0091e+6</span><span class="p">)</span>
<span class="n">NO</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">NO</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.4673458e+04</span><span class="p">,</span> <span class="mf">6.3171396e+04</span><span class="p">,</span> <span class="mf">6.5994503e+04</span><span class="p">,</span> <span class="mf">6.9061210e+04</span><span class="p">,</span> <span class="mf">7.0499985e+04</span><span class="p">,</span>
                        <span class="mf">7.4910550e+04</span><span class="p">,</span> <span class="mf">7.6288753e+04</span><span class="p">,</span> <span class="mf">8.6761885e+04</span><span class="p">,</span> <span class="mf">8.7144312e+04</span><span class="p">,</span> <span class="mf">8.8860771e+04</span><span class="p">,</span>
                        <span class="mf">8.9817556e+04</span><span class="p">,</span> <span class="mf">8.9884459e+04</span><span class="p">,</span> <span class="mf">9.0427021e+04</span><span class="p">,</span> <span class="mf">9.0642838e+04</span><span class="p">,</span> <span class="mf">9.1117633e+04</span><span class="p">])</span>
<span class="n">NO</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span>

<span class="n">N2p</span><span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">28.0128514</span><span class="p">,</span> <span class="mf">3395.0</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">5.3886e+07</span><span class="p">)</span>
<span class="n">N2p</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> 
                         <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">N2p</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3189972e+04</span><span class="p">,</span> <span class="mf">3.6633231e+04</span><span class="p">,</span> <span class="mf">3.6688768e+04</span><span class="p">,</span> <span class="mf">5.9853048e+04</span><span class="p">,</span> <span class="mf">6.6183659e+04</span><span class="p">,</span> 
                          <span class="mf">7.5989919e+04</span><span class="p">,</span> <span class="mf">7.6255086e+04</span><span class="p">,</span> <span class="mf">8.2010186e+04</span><span class="p">,</span> <span class="mf">8.4168349e+04</span><span class="p">,</span> <span class="mf">8.6326512e+04</span><span class="p">,</span> 
                         <span class="mf">8.9204062e+04</span><span class="p">,</span> <span class="mf">9.2081613e+04</span><span class="p">,</span> <span class="mf">9.2225490e+04</span><span class="p">,</span> <span class="mf">9.2937684e+04</span><span class="p">,</span> <span class="mf">9.6397938e+04</span><span class="p">,</span> <span class="mf">1.0359181e+05</span><span class="p">])</span>
<span class="n">N2p</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;N2p&#39;</span>

<span class="n">O2p</span><span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">31.9982514</span><span class="p">,</span> <span class="mi">2239</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.6592e+07</span><span class="p">)</span>
<span class="n">O2p</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">O2p</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.7354408e+04</span><span class="p">,</span> <span class="mf">5.8373987e+04</span><span class="p">,</span> <span class="mf">5.8414273e+04</span><span class="p">,</span> <span class="mf">6.2298966e+04</span><span class="p">,</span> <span class="mf">6.7334679e+04</span><span class="p">,</span>
                          <span class="mf">7.1219372e+04</span><span class="p">,</span> <span class="mf">7.6542841e+04</span><span class="p">,</span> <span class="mf">8.8196920e+04</span><span class="p">,</span> <span class="mf">8.8916307e+04</span><span class="p">,</span> <span class="mf">9.4239776e+04</span><span class="p">,</span> <span class="mf">9.4959163e+04</span><span class="p">,</span>
                          <span class="mf">9.5920265e+04</span><span class="p">,</span> <span class="mf">9.9850999e+04</span><span class="p">,</span> <span class="mf">1.0359181e+05</span><span class="p">])</span>
<span class="n">O2p</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;O2p&#39;</span>

<span class="n">NOp</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">30.0055514</span><span class="p">,</span> <span class="mi">2817</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.3000e+07</span><span class="p">)</span>
<span class="n">NOp</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">NOp</span><span class="o">.</span><span class="n">electro_th</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.5089678e+04</span><span class="p">,</span> <span class="mf">8.5254624e+04</span><span class="p">,</span> <span class="mf">8.9035726e+04</span><span class="p">,</span> <span class="mf">9.7469826e+04</span><span class="p">,</span> <span class="mf">1.0005530e+05</span><span class="p">,</span> <span class="mf">1.0280337e+05</span><span class="p">,</span> <span class="mf">1.0571386e+05</span><span class="p">])</span>
<span class="n">NOp</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NOp&#39;</span>

<span class="n">Op</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">15.9988514</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">9.8056e+07</span><span class="p">)</span>
<span class="n">Op</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">Op</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.8583347e+04</span><span class="p">,</span> <span class="mf">5.8223492e+04</span><span class="p">])</span>
<span class="n">Op</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Op&#39;</span>

<span class="n">Np</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">14.0061514</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.3438e+08</span><span class="p">)</span>
<span class="n">Np</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">Np</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.0068352e+01</span><span class="p">,</span> <span class="mf">1.8819180e+02</span><span class="p">,</span> <span class="mf">2.2036569e+04</span><span class="p">,</span> <span class="mf">4.7031835e+04</span><span class="p">,</span> <span class="mf">6.7312522e+04</span><span class="p">,</span> <span class="mf">1.3271908e+05</span><span class="p">])</span>
<span class="n">Np</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Np&#39;</span>

<span class="n">em</span> <span class="o">=</span> <span class="n">specie</span><span class="p">(</span><span class="mf">0.00054858</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">em</span><span class="o">.</span><span class="n">electro_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">em</span><span class="o">.</span><span class="n">electro_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">em</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;em&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="chemical-reaction-class-definition">
<h1>Chemical reaction class definition<a class="headerlink" href="#chemical-reaction-class-definition" title="Permalink to this headline">¶</a></h1>
<p>A reaction is defined by the stochiometric coefficients, the reactants, the products and the reaction rate coefficients. The latter are computed as follows:</p>
<ul class="simple">
<li><p>Forward reaction coefficient :       <span class="math notranslate nohighlight">\(k_f\)</span> is expressed as <span class="math notranslate nohighlight">\(k_f = C_f T ^{\eta_f}e^{-\frac{\theta_d}{T}}\)</span> (coefficients from Park’s tables)</p></li>
<li><p>Equilibrium reaction coefficient :   <span class="math notranslate nohighlight">\(k_c\)</span> is computed from the fitted fouth-order polynomial interpolation by Park: $<span class="math notranslate nohighlight">\(k_c = exp(A_i + A_2Z + A_3Z^2 + A_4Z^3 + A_5Z^4)\)</span><span class="math notranslate nohighlight">\(
Where: \)</span><span class="math notranslate nohighlight">\(Z = \frac{10000}{T}\)</span>$</p></li>
<li><p>Backward reaction coefficient:       <span class="math notranslate nohighlight">\(k_b\)</span> is computed as <span class="math notranslate nohighlight">\(k_b = \frac{k_f}{k_c}\)</span>
<br></p></li>
</ul>
<p>The two-temperature model by Park consider four different groups of reactions that need to be treated differently. They can be distinguished between: the impact dissociation, the exchange reactions, the associative ionization (or, in reverse, dissociative ricombination) and the elctron-impact ionization. The impact dissociation must be subdivided further into heavy-particle impact dissociation and electron-impact dissociation. <br></p>
<ul class="simple">
<li><p>Heavy-particle impact dissociation : <br>
$<span class="math notranslate nohighlight">\(
AB + M \rightleftharpoons A + B + M
\)</span><span class="math notranslate nohighlight">\(
The forward reaction occurs mostly as a result of vibrational ladder-climbing process, that is the successive excitation of vibrational energy levels in the molecule AB. The final parting process occurs mostly from the levels close to the dissociation limit, that is, from the levels that are located within an energy \)</span>K_bT<span class="math notranslate nohighlight">\( from the dissociation limit. The rate coefficient is approximately proportional, therefore to the population of the vibrational level \)</span>K_bT<span class="math notranslate nohighlight">\( below the dissociation limit \)</span>D’ = D - K_bT<span class="math notranslate nohighlight">\(, resulting proportional to  \)</span>exp(− D’ /(K_b T_v)) = exp(− (D - K_bT) /(K_b T_v)) = exp(− \theta^d /(T_v) + T/T^v)<span class="math notranslate nohighlight">\(. The rate of parting of the molecules from this level is dictated mostly by the kinetic energy of the impacting particles \)</span>K_bT<span class="math notranslate nohighlight">\( hence its rate is proportional to \)</span>exp(−(K_b T)/(K_b T)) = exp(−1)<span class="math notranslate nohighlight">\(. The preexponential factor T expresses the dependence of the collision frequence and cross sections on he collision energy, both of which are dictated by the translational temperature T. Therefore the expression for \)</span>k_f<span class="math notranslate nohighlight">\( becomes: 
\)</span>k_f = C T exp(- \theta^d/T^v - 1 + T/T^v)<span class="math notranslate nohighlight">\( &lt;br&gt;
The reverse rate of this process are dictated only by the translational temperature of the particles involved:
\)</span>k_b = k_b(T)$</p></li>
<li><p>Electron-impact dissociation : <br>
$<span class="math notranslate nohighlight">\(
AB + e^- \rightleftharpoons A + B + e^-
\)</span><span class="math notranslate nohighlight">\(
In this case \)</span>T<span class="math notranslate nohighlight">\( must be replaced by the electron temperature, which in the two-temperature formulation by Park is the same as \)</span>T^v<span class="math notranslate nohighlight">\(:
\)</span><span class="math notranslate nohighlight">\(k_f = C T^v exp(- \theta^d/T^v)\)</span><span class="math notranslate nohighlight">\(
The reverse rate coefficient depends on \)</span>\sqrt{T T^v}<span class="math notranslate nohighlight">\(, hence:
\)</span>k_b = k_b(\sqrt{T T^v})$</p></li>
<li><p>Exchange reaction:
$<span class="math notranslate nohighlight">\(
AB + C \rightleftharpoons A + BC
\)</span>$
Similar considerations as heavy-particle impact dissociation can be made, therefore the forward and backward reaction coefficents have the same expressions as described before.</p></li>
<li><p>Associative ionization:
$<span class="math notranslate nohighlight">\(
A + B \rightleftharpoons AB^+ + e^-
\)</span><span class="math notranslate nohighlight">\(
In this case the initial state contains no molecules, hence the coefficient of the forward rate must be  function only of heavy-particle translational temperature \)</span>T<span class="math notranslate nohighlight">\(: 
\)</span>k_f = C T exp(- \theta^d/T)<span class="math notranslate nohighlight">\( &lt;br&gt;
While the reverse rate is dictated mostly by the vibrational energy of the molecule \)</span>AB^+<span class="math notranslate nohighlight">\( and the translational temperature of \)</span>e^-<span class="math notranslate nohighlight">\(, which is set equal to \)</span>T^v<span class="math notranslate nohighlight">\(:
\)</span>k_b = k_b(T^v)$</p></li>
<li><p>Elctron-impact ionization:
$<span class="math notranslate nohighlight">\(
A + e^- \rightleftharpoons A^+ + e^- + e^-
\)</span><span class="math notranslate nohighlight">\(
In this process the atom \)</span>A<span class="math notranslate nohighlight">\( can be considered to be at rest because of its very small thermal velocity. Both the forward and reverse rate coefficients are functions of the electron temperature only:
\)</span>k_f = C T^v exp(- \theta^d/T^v)<span class="math notranslate nohighlight">\( &lt;br&gt;
\)</span>k_b = k_b(T^v)$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">subreaction</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">stoichr</span><span class="p">,</span> <span class="n">stoichp</span><span class="p">,</span> <span class="n">Cf</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">th_d</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactants</span> <span class="o">=</span> <span class="n">reactants</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">products</span>  <span class="o">=</span> <span class="n">products</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stoichr</span>   <span class="o">=</span> <span class="n">stoichr</span> <span class="c1"># Stoichometric coefficient ordered as [reactants, products]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stoichp</span>   <span class="o">=</span> <span class="n">stoichp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span>        <span class="o">=</span> <span class="n">Cf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nf</span>        <span class="o">=</span> <span class="n">nf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">th_d</span>      <span class="o">=</span> <span class="n">th_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span>         <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_mol</span>     <span class="o">=</span> <span class="kc">None</span>

        
    <span class="k">def</span> <span class="nf">kf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">kf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span> <span class="o">*</span> <span class="n">T</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kf</span>
        
    <span class="k">def</span> <span class="nf">kb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">kb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">kc</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kb</span>
    
    <span class="k">def</span> <span class="nf">kc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="n">T</span> 
        <span class="n">exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">4</span>
        
        <span class="k">if</span> <span class="n">exponent</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kc_min</span><span class="p">):</span>
            <span class="n">kc</span> <span class="o">=</span> <span class="n">kc_min</span>
        <span class="k">elif</span> <span class="n">exponent</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kc_max</span><span class="p">):</span>
            <span class="n">kc</span> <span class="o">=</span> <span class="n">kc_max</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">kc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kc</span>
    
    <span class="c1"># 2 Temperature</span>
    <span class="k">def</span> <span class="nf">kf_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="n">prod</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">react</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
            <span class="n">prod</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
            <span class="n">react</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;em&#39;</span> <span class="ow">in</span> <span class="n">react</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">find_letter</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="n">prod</span><span class="p">):</span>
                <span class="c1"># A + em &lt;--&gt; Ap + em + em </span>
                <span class="n">kf_2T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span> <span class="o">*</span> <span class="n">Tv</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">/</span> <span class="n">Tv</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># AB + em &lt;--&gt; A + B + em </span>
                <span class="n">kf_2T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span> <span class="o">*</span> <span class="n">Tv</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">/</span> <span class="n">Tv</span><span class="p">)</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;em&#39;</span> <span class="ow">in</span> <span class="n">prod</span><span class="p">:</span>
                <span class="c1"># A + B &lt;--&gt; ABp + em </span>
                <span class="n">kf_2T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span> <span class="o">*</span> <span class="n">T</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># AB + M &lt;--&gt; A + B + M </span>
                <span class="n">kf_2T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cf</span> <span class="o">*</span> <span class="n">T</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">th_d</span> <span class="o">/</span> <span class="n">Tv</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">T</span> <span class="o">/</span> <span class="n">Tv</span><span class="p">)</span>                
        <span class="k">return</span> <span class="n">kf_2T</span>
        
    <span class="k">def</span> <span class="nf">kb_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="n">kb_2T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kf_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">kc_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kb_2T</span>
    
    <span class="k">def</span> <span class="nf">kc_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="n">prod</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">react</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
            <span class="n">prod</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
            <span class="n">react</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;em&#39;</span> <span class="ow">in</span> <span class="n">react</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">find_letter</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="n">prod</span><span class="p">):</span>
                <span class="c1"># A + em &lt;--&gt; Ap + em + em </span>
                <span class="n">Z</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="n">Tv</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># AB + em &lt;--&gt; A + B + em </span>
                <span class="n">Z</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">Tv</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;em&#39;</span> <span class="ow">in</span> <span class="n">prod</span><span class="p">:</span>
                <span class="c1"># A + B &lt;--&gt; ABp + em </span>
                <span class="n">Z</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="n">Tv</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># AB + M &lt;--&gt; A + B + M </span>
                <span class="n">Z</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">/</span> <span class="n">T</span>  
        
        <span class="n">exponent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">Z</span><span class="o">**</span><span class="mi">4</span>
        
        <span class="k">if</span> <span class="n">exponent</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kc_min</span><span class="p">):</span>
            <span class="n">kc_2T</span> <span class="o">=</span> <span class="n">kc_min</span>
        <span class="k">elif</span> <span class="n">exponent</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">kc_max</span><span class="p">):</span>
            <span class="n">kc_2T</span> <span class="o">=</span> <span class="n">kc_max</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">kc_2T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kc_2T</span>
    
    
<span class="k">class</span> <span class="nc">reaction</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">e_mol</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subreactions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span>            <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e_mol</span>        <span class="o">=</span> <span class="n">e_mol</span>
    
    
    <span class="k">def</span> <span class="nf">add_subreaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subr</span><span class="p">):</span>
        <span class="n">subr</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span>
        <span class="n">subr</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_mol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subreactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="importing-reactions-data">
<h2>Importing reactions data<a class="headerlink" href="#importing-reactions-data" title="Permalink to this headline">¶</a></h2>
<p>Reactions data are taken from Park’s tables</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># I devide the constant rate Cf for 1e6 to convert from cm3/mol to m3/mol</span>
<span class="c1"># I also multiplicate e_mol for 4184 in order to convert Kcal/mol in J/mol</span>

<span class="c1">###O2diss = reaction([1.335, -4.127, 0.616, 0.093, -0.005], -117.98*4184)</span>
<span class="n">O2diss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span><span class="mf">1.335</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.127</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.616</span><span class="p">,</span> <span class="mf">0.093</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.005</span><span class="p">],</span> <span class="o">-</span><span class="mf">117.98</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">8.25e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
<span class="n">O2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.32e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">59500</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N2diss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span> <span class="mf">3.898</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.611</span><span class="p">,</span> <span class="mf">0.683</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.118</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">],</span> <span class="o">-</span><span class="mf">225.00</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.10e22</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">3.7e21</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
<span class="n">N2diss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.11e24</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">1.6</span><span class="p">,</span> <span class="mi">113200</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NOdiss</span> <span class="o">=</span> <span class="n">reaction</span><span class="p">([</span><span class="mf">1.549</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.784</span><span class="p">,</span> <span class="mf">0.228</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.043</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">],</span> <span class="o">-</span><span class="mf">150.03</span><span class="o">*</span><span class="mi">4184</span><span class="p">)</span> 
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.6e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.3e17</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
<span class="n">NOdiss</span><span class="o">.</span><span class="n">add_subreaction</span><span class="p">(</span><span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">7.36e19</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span>
                                  <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">75500</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Exchange reactions</span>
<span class="n">NO_O</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">NO</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">O2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.16e8</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mi">19220</span><span class="p">)</span>
<span class="n">NO_O</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.215</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.657</span><span class="p">,</span> <span class="mf">0.843</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.136</span><span class="p">,</span> <span class="mf">0.007</span><span class="p">])</span>
<span class="n">NO_O</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">32.05</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O_N2</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">N2</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">NO</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">3.18e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">37700</span><span class="p">)</span>
<span class="n">O_N2</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.349</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.828</span><span class="p">,</span> <span class="mf">0.455</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">])</span>
<span class="n">O_N2</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">74.97</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O_O2p</span>      <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="n">O2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">6.85e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.520</span><span class="p">,</span> <span class="mi">18600</span><span class="p">)</span>
<span class="n">O_O2p</span><span class="o">.</span><span class="n">A</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.411</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.998</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.00</span><span class="p">])</span>
<span class="n">O_O2p</span><span class="o">.</span><span class="n">e_mol</span><span class="o">=</span> <span class="o">-</span><span class="mf">36.88</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N2_Np</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">9.85e12</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.180</span><span class="p">,</span> <span class="mi">12100</span><span class="p">)</span>
<span class="n">N2_Np</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.963</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.116</span><span class="p">,</span> <span class="mf">0.692</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.103</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">])</span>
<span class="n">N2_Np</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">24.06</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O_NOp</span>      <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">NO</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.75e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">,</span> <span class="mi">51000</span><span class="p">)</span>
<span class="n">O_NOp</span><span class="o">.</span><span class="n">A</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.705</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.223</span><span class="p">,</span> <span class="mf">0.522</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.090</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">])</span>
<span class="n">O_NOp</span><span class="o">.</span><span class="n">e_mol</span><span class="o">=</span> <span class="o">-</span><span class="mf">101.34</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N2_Op</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N2</span><span class="p">,</span> <span class="n">Op</span><span class="p">],</span> <span class="p">[</span><span class="n">O</span><span class="p">,</span> <span class="n">N2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">6.33e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.210</span><span class="p">,</span> <span class="mi">22200</span><span class="p">)</span>
<span class="n">N2_Op</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.391</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.443</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.080</span><span class="p">,</span> <span class="mf">0.027</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">])</span>
<span class="n">N2_Op</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">44.23</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N_NOp</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">NO</span><span class="p">,</span> <span class="n">Np</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">2.21e15</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.020</span><span class="p">,</span> <span class="mi">61100</span><span class="p">)</span>
<span class="n">N_NOp</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.132</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.550</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.249</span><span class="p">,</span> <span class="mf">0.041</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002</span><span class="p">])</span>
<span class="n">N_NOp</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">121.51</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O2_NOp</span>      <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O2</span><span class="p">,</span> <span class="n">NOp</span><span class="p">],</span> <span class="p">[</span><span class="n">NO</span><span class="p">,</span> <span class="n">O2p</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.03e16</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.170</span><span class="p">,</span> <span class="mi">32400</span><span class="p">)</span>
<span class="n">O2_NOp</span><span class="o">.</span><span class="n">A</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.115</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.225</span><span class="p">,</span> <span class="mf">0.524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.095</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">])</span>
<span class="n">O2_NOp</span><span class="o">.</span><span class="n">e_mol</span><span class="o">=</span> <span class="o">-</span><span class="mf">64.46</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">NOp_N</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">NOp</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N2p</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.7e13</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.400</span><span class="p">,</span> <span class="mi">35500</span><span class="p">)</span>
<span class="n">NOp_N</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.746</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.838</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.013</span><span class="p">,</span> <span class="mf">0.013</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.001</span><span class="p">])</span>
<span class="n">NOp_N</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">70.60</span><span class="o">*</span><span class="mi">4184</span>

<span class="c1"># Associative ionization</span>
<span class="n">O___N</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">NOp</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.53e11</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.370</span><span class="p">,</span> <span class="mi">32000</span><span class="p">)</span>
<span class="n">O___N</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">6.234</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.536</span><span class="p">,</span> <span class="mf">0.494</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.058</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">])</span>
<span class="n">O___N</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">63.69</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">O___O</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">O</span><span class="p">],</span> <span class="p">[</span><span class="n">O2p</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">3.85e11</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.490</span><span class="p">,</span> <span class="mi">80600</span><span class="p">)</span>
<span class="n">O___O</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">3.904</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.418</span><span class="p">,</span> <span class="mf">1.861</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.288</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">])</span>
<span class="n">O___O</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">160.20</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N___N</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">],</span> <span class="p">[</span><span class="n">N2p</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">1.79e11</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="mf">0.770</span><span class="p">,</span> <span class="mi">67500</span><span class="p">)</span>
<span class="n">N___N</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">4.488</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.374</span><span class="p">,</span> <span class="mf">0.481</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.044</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">])</span>
<span class="n">N___N</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">134.29</span><span class="o">*</span><span class="mi">4184</span>

<span class="c1"># Electron impact ionization</span>
<span class="n">O_ion</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">O</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">Op</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">3.9e33</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.780</span><span class="p">,</span> <span class="mi">158500</span><span class="p">)</span>
<span class="n">O_ion</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.980</span><span class="p">,</span> <span class="o">-</span><span class="mf">19.534</span><span class="p">,</span> <span class="mf">1.244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.190</span><span class="p">,</span> <span class="mf">0.010</span><span class="p">])</span>
<span class="n">O_ion</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">315.06</span><span class="o">*</span><span class="mi">4184</span>

<span class="n">N_ion</span>       <span class="o">=</span> <span class="n">subreaction</span><span class="p">([</span><span class="n">N</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="n">Np</span><span class="p">,</span> <span class="n">em</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mf">2.5e34</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.820</span><span class="p">,</span> <span class="mi">168600</span><span class="p">)</span>
<span class="n">N_ion</span><span class="o">.</span><span class="n">A</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">2.553</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.870</span><span class="p">,</span> <span class="mf">0.472</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.060</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">])</span>
<span class="n">N_ion</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">335.23</span><span class="o">*</span><span class="mi">4184</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="problem-class-definition">
<h1>Problem class definition<a class="headerlink" href="#problem-class-definition" title="Permalink to this headline">¶</a></h1>
<p>We define a class problem so that several condition can be studied, analyzed, compared and contrasted.</p>
<p>The initial conditions for the shock relaxation region are obtained by assuming frozen chemistry through the shock which, in the Euler equations framework is a discontinuity whose jumps are defined by the Rankine-Hugoniot relations.</p>
<p>The variable are mixture density, velocity, temperture and mixture mass fractions.</p>
<p>For the mixture considered the the following relations hold:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e_{mixture} = \Sigma_i e_i Y_i \)</span> where <span class="math notranslate nohighlight">\(e_i = e_i^{t} + e_i^{r} + e_i^{v} + e_i^{e}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(CV_{mixture} = \Sigma_i CV_i Y_i \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{mixture} = \Sigma_i R_i Y_i \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">problem</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specie</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>     <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mi">300</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">1.225</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">3000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>     <span class="o">=</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="mf">6.2</span> <span class="o">*</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1"># Sigma HS nitrogen</span>
    
    <span class="k">def</span> <span class="nf">add_specie_ic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specie</span><span class="p">,</span> <span class="n">Y0</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">specie</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y0</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y0</span>
        
    <span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">R</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">R</span>
    
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">CV1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">CV</span> <span class="o">+</span> <span class="n">CV1</span><span class="o">*</span><span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">CV</span>
    
    <span class="k">def</span> <span class="nf">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">e1_tr</span><span class="p">,</span> <span class="n">e1_ve</span><span class="p">,</span> <span class="n">cv1_tr</span><span class="p">,</span> <span class="n">cv1_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
            <span class="n">e_tr</span>  <span class="o">=</span> <span class="n">e_tr</span> <span class="o">+</span> <span class="n">e1_tr</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">cv_tr</span> <span class="o">=</span> <span class="n">cv_tr</span> <span class="o">+</span> <span class="n">cv1_tr</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">e_ve</span>  <span class="o">=</span> <span class="n">e_ve</span> <span class="o">+</span> <span class="n">e1_ve</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">cv_ve</span> <span class="o">=</span> <span class="n">cv_ve</span> <span class="o">+</span> <span class="n">cv1_ve</span> <span class="o">*</span><span class="n">Y</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span>
    
    <span class="k">def</span> <span class="nf">e_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of energy wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="c1"># e_Y = np.zeros(np.shape(self.Y0))</span>
        <span class="n">e_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y</span><span class="p">)):</span>
            <span class="n">e_Y</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">inutile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y</span>
    
    <span class="k">def</span> <span class="nf">e_Y_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of energy 2T wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="n">e_Y_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="n">e_Y_ve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y_tr</span><span class="p">)):</span>
            <span class="n">e_Y_tr</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">e_Y_ve</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">useless_tr</span><span class="p">,</span> <span class="n">useless_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y_tr</span><span class="p">,</span> <span class="n">e_Y_ve</span>
    
    <span class="k">def</span> <span class="nf">e_Y_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of vibrational-electronic energy wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="n">e_Y_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y_v</span><span class="p">)):</span>
            <span class="n">e_Y_v</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y_v</span>
        
    <span class="k">def</span> <span class="nf">only_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span> <span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">CV1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e</span>    
    
    <span class="k">def</span> <span class="nf">only_e_tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e_tr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1_tr</span><span class="p">,</span> <span class="n">e1_ve</span><span class="p">,</span> <span class="n">cv1_tr</span><span class="p">,</span> <span class="n">cv1_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
            <span class="n">e_tr</span> <span class="o">=</span> <span class="n">e_tr</span> <span class="o">+</span> <span class="n">e1_tr</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e_tr</span>
    
    <span class="k">def</span> <span class="nf">only_e_ve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="n">e_ve</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span>
            <span class="n">e_ve</span> <span class="o">=</span> <span class="n">e_ve</span> <span class="o">+</span> <span class="n">e1_ve</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e_ve</span>
    
    <span class="k">def</span> <span class="nf">T_from_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">T0</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
        
        <span class="n">T</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">T</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0</span><span class="p">,</span> 
                                            <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_from_e did not converge&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">T</span>
    
    <span class="k">def</span> <span class="nf">T_from_e_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">T0_tr</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">T0_ve</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
        
        <span class="n">T_tr</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier_tr</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">T</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_tr</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0_tr</span><span class="p">,</span>
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span> <span class="o">*</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">T_ve</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier_ve</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Tv</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_ve</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">-</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0_ve</span><span class="p">,</span>
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span> <span class="o">*</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier_tr</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_tr_from_e did not converge&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier_ve</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_ve_from_e did not converge&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">T_tr</span><span class="p">,</span> <span class="n">T_ve</span>
    
</pre></div>
</div>
</div>
</div>
<div class="section" id="rh-jump-relations">
<h2>RH jump relations<a class="headerlink" href="#rh-jump-relations" title="Permalink to this headline">¶</a></h2>
<p>Firstly, the Rankine Hugoniot relations are solved for a perfect gas with the same R of the mixture and the isoentropic coefficient <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>. <br>
Then, the results obtained are used as guess to initialize the non-linear solver. The Rankine-Hugoniot relations read: <br></p>
<p>\begin{cases}
\rho_0 u_0 = \rho_1 u_1 \
\rho_0 u_0^2 + P_0 = \rho_1 u_1^2 + P_1 \
h_0^t  = e_0 + \frac{P_0}{\rho_0} + \frac{1}{2}u_0^2 =
e_1 + \frac{P_1}{\rho_1} + \frac{1}{2} u_1^2 = h_1^t  \
Y_{i_0} = Y_{i_1}
\end{cases}
Whereas <span class="math notranslate nohighlight">\(P = \rho \sum_{i}^{N_s} Y_i R_i T \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RHsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">rho2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span>
    <span class="n">e2</span><span class="p">,</span> <span class="n">CV2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
    
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">e0</span><span class="p">,</span> <span class="n">CV0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">out_rho</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">)</span>                       <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="n">out_mom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>  <span class="n">p0</span><span class="p">)</span>            <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
    <span class="n">out_ene</span> <span class="o">=</span> <span class="p">(</span><span class="n">e0</span> <span class="o">+</span> <span class="n">p0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">-</span> <span class="p">(</span><span class="n">e2</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">/</span> <span class="n">rho2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u2</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>
      
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">out_rho</span><span class="p">,</span> <span class="n">out_mom</span><span class="p">,</span> <span class="n">out_ene</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rho2, T2, u2 : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">out</span>

    
<span class="k">def</span> <span class="nf">RHjump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Build a guess assuming perfect gas with gamma = 1.4</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">M0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">/</span> <span class="n">c0</span>
    <span class="n">M2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">p2</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
    <span class="n">T2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">);</span> 
    <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">M2</span><span class="p">;</span>
        
    <span class="c1"># Solve RH relations</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RHsystem</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> 
                                     <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># , epsfcn=1e-8, factor = 0.1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RH not converged&#39;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Compute reference post shock mean free path</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    <span class="n">mmixt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mmol</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">=</span> <span class="n">Kb</span> <span class="o">*</span> <span class="n">T2</span> <span class="o">/</span> <span class="n">p2</span>  <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cv2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">cp</span> <span class="o">/</span> <span class="n">cv2</span>
    <span class="n">c2c</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">M2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">/</span> <span class="n">c2c</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre shock Mach : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock guess values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tv     : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2c</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reference mean free path : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speed is negative!!! Look at RHjump&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;EXITING&quot;</span><span class="p">)</span>
        
<span class="k">def</span> <span class="nf">RHsystem_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">rho2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span>
    <span class="n">e2_tr</span><span class="p">,</span> <span class="n">e2_ve</span><span class="p">,</span> <span class="n">CV2_tr</span><span class="p">,</span> <span class="n">CV2_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">e0_tr</span><span class="p">,</span> <span class="n">e0_ve</span><span class="p">,</span> <span class="n">CV0_tr</span><span class="p">,</span> <span class="n">CV0_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">out_rho</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">)</span>                                  <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="n">out_mom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>  <span class="n">p0</span><span class="p">)</span>                       <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
    <span class="n">out_ene</span> <span class="o">=</span> <span class="p">(</span><span class="n">e0_tr</span> <span class="o">+</span> <span class="n">e0_ve</span> <span class="o">+</span> <span class="n">p0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">-</span> <span class="p">(</span><span class="n">e2_tr</span> <span class="o">+</span> <span class="n">e2_ve</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">/</span> <span class="n">rho2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u2</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>
      
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">out_rho</span><span class="p">,</span> <span class="n">out_mom</span><span class="p">,</span> <span class="n">out_ene</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rho2, T2, u2 : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">out</span>

    
<span class="k">def</span> <span class="nf">RHjump_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Build a guess assuming perfect gas with gamma = 1.4</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">M0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">/</span> <span class="n">c0</span>
    <span class="n">M2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">p2</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
    <span class="n">T2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">);</span> 
    <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">M2</span><span class="p">;</span>
        
    <span class="c1"># Solve RH relations</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RHsystem_2T</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> 
                                     <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># , epsfcn=1e-8, factor = 0.1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RH not converged&#39;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Compute reference post shock mean free path</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    <span class="n">mmixt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mmol</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">=</span> <span class="n">Kb</span> <span class="o">*</span> <span class="n">T2</span> <span class="o">/</span> <span class="n">p2</span>  <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cv2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">cp</span> <span class="o">/</span> <span class="n">cv2</span>
    <span class="n">c2c</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">M2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">/</span> <span class="n">c2c</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre shock Mach : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock guess values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tv     : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2c</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reference mean free path : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speed is negative!!! Look at RHjump&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;EXITING&quot;</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">RHsystem</span> <span class="o">=</span> <span class="n">RHsystem</span>
<span class="n">problem</span><span class="o">.</span><span class="n">RHjump</span> <span class="o">=</span> <span class="n">RHjump</span>
<span class="n">problem</span><span class="o">.</span><span class="n">RHsystem_2T</span> <span class="o">=</span> <span class="n">RHsystem_2T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">RHjump_2T</span> <span class="o">=</span> <span class="n">RHjump_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computation-of-the-chemical-source-terms">
<h2>Computation of the chemical source terms<a class="headerlink" href="#computation-of-the-chemical-source-terms" title="Permalink to this headline">¶</a></h2>
<p>The reactions considered are those for the 11-species air model and they can be subdivided in four groups (see <a class="reference external" href="#Chemical-reaction-class-definition">Chemical reaction class definition</a>), for a total of 47 reactions. <br>
To compute the chemical sources for each specie <span class="math notranslate nohighlight">\(\omega_i\)</span>, for each reaction the specie mass fraction vector is transformed in “local” molar concentrations <span class="math notranslate nohighlight">\(\chi_i = \rho_i/M_i\)</span> which are multiplied by the forward and backward reaction coefficients as defined before to compute the reaction rate. <br>
According to the Park’s definition of forward and backward coefficients, the reaction rate is computed as: <br></p>
<div class="math notranslate nohighlight">
\[R_{f,r} = k_{f,r} \Pi_{i = 0}^{N_{s}} \chi_i^{\alpha_{i,r}} $$ &lt;br&gt;
and &lt;br&gt;
$$R_{b,r} = k_{b,r} \Pi_{i = 0}^{N_{s}} \chi_i^{\beta_{i,r}} \]</div>
<p>Where <span class="math notranslate nohighlight">\(\alpha_{i,r}\)</span> and <span class="math notranslate nohighlight">\(\beta_{i,r}\)</span> are the stechiometric mole numbers for reactants and products respectively.</p>
<!-- Finally, the generated/destroyed species are expressed in terms of "global" mass fraction rate and summed for each reaction and sub-reaction. -->
<!-- [Aggiungere] and the released energy is computed -->
<p>The net mass rate of production of the specie <span class="math notranslate nohighlight">\(i\)</span> is obtained considering all the <span class="math notranslate nohighlight">\(N_r\)</span> possible reactions, and it is defined as:
$<span class="math notranslate nohighlight">\(
\omega_i = M_i \sum_{r}^{N_r} \omega_{i,r} = M_i \sum_{r}^{N_r} \left(\beta_{i,r} - \alpha_{i,r} \right) \left( R_{f,r} - R_{b,r} \right)
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Se</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">reaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">)):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Transform the global Y vector to the local X vector</span>
                <span class="n">chi_r_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">chi_p_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">R_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_r_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_p_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                <span class="c1">#breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">subreaction</span><span class="p">):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="c1"># Transform the global y vector to the local X vector</span>
                <span class="n">chi_r_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">chi_p_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">R_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_r_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_p_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                
                <span class="c1"># breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>
                
                
        <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Member of the reaction group of this problem are ill-defined&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Se = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">Se</span>

<span class="k">def</span> <span class="nf">compute_Sy_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Se</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">reaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">)):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegar[k][idx] = 1</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegap[k][idx] = 1</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Transform the global y vector to the local X vector</span>
                <span class="n">chi_r_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">chi_p_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">R_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_r_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_p_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                <span class="c1">#breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1"># S += mmol * (np.matmul(np.transpose(omegap), obj.stoichp) - np.matmul(  np.transpose(omegar), obj.stoichr)) * w_s</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">subreaction</span><span class="p">):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegar[k][idx] = 1</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegap[k][idx] = 1</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="c1"># Transform the global y vector to the local X vector</span>
                <span class="n">chi_r_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">chi_p_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">R_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_r_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_p_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                
                <span class="c1"># breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>
                
                
        <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Member of the reaction group of this problem are ill-defined&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Se = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">Se</span>


<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sy</span> <span class="o">=</span> <span class="n">compute_Sy</span>
<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sy_2T</span> <span class="o">=</span> <span class="n">compute_Sy_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling">
<h2>Computation of the Vibrational-Translational Energy transfer and Chemical-Vibrational Coupling<a class="headerlink" href="#computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling" title="Permalink to this headline">¶</a></h2>
<p>The source term <span class="math notranslate nohighlight">\(S_v\)</span> is taken into account in order to study the evolution of the vibrational-elecronic energy term introducted by the two-temperature model.
$<span class="math notranslate nohighlight">\( S_v = S_{c-v} + S_{v-t} \)</span>$
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_{c-v}\)</span> is the vibrational energy lost or gained due to the chemical reactions.
$<span class="math notranslate nohighlight">\( S_{c-v} = \sum_{i}^{N_s} \omega_i e^{ve}_i \)</span>$</p></li>
<li><p><span class="math notranslate nohighlight">\(S_{v-t} \)</span> is the vibrational energy relaxation term between vibrational and translational energy modes due to collisions.
The energy exchange rate is modeled using the Landau-Teller model as:
$<span class="math notranslate nohighlight">\( S_{v-t} = \sum_i \rho_i \frac{e^{ve,*}_i - e^{ve}_i}{\tau_i} \)</span><span class="math notranslate nohighlight">\(
Where \)</span>e^{ve,*}<em>i<span class="math notranslate nohighlight">\( is the vibrational-electronic energy of species \)</span>i<span class="math notranslate nohighlight">\( at the translational-rotational temperature \)</span>T^{tr}<span class="math notranslate nohighlight">\( and \)</span>\tau_i<span class="math notranslate nohighlight">\( is the characteristic relaxation time. For a mixture:
\)</span><span class="math notranslate nohighlight">\( 
\tau_i = \frac{\sum_r X_r}{\sum_r X_r/\tau_{ir}} \)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(
X_i = \frac{Y_i}{M_i} \left( \sum_{r}\frac{Y_r}{M_r} \right)^{-1}
\)</span><span class="math notranslate nohighlight">\(
\)</span>\tau</em>{ir}<span class="math notranslate nohighlight">\( is obtained from the Millikan and White's semiempirical correlation:
\)</span><span class="math notranslate nohighlight">\( \tau_{ir} = \tau_{ir}^{MW} = \frac{101325}{p} exp \left[ A_{ir} \left(\left(T^{tr}\right)^{-1/3} - B_{ir} \right) - 18.42 \right] \)</span><span class="math notranslate nohighlight">\(
Where:
\)</span><span class="math notranslate nohighlight">\( A_{ir} = 1.16 \cdot 10^{-3} \mu_{ir}^{1/2} \theta_{v,i}^{4/3} \)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\( B_{ir} = 0.015 \mu_{ir}^{1/4} \)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\( \mu_{ir} = \frac{M_i M_r}{M_i + M_r} \)</span>$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_Sv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">Sy</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="c1"># Recover theta_v</span>
    <span class="n">th_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">mmol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span>
        <span class="n">th_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">th_v</span>
    
    <span class="c1"># Recover Pressure</span>
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> 
    
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">e_v_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">e_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Svt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">mmol</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="c1"># Compute v-e and chemical source terms</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="c1"># xr = Y[j] / mmol[j] / (np.sum(Y/mmol))</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">X</span>
        <span class="n">mu_sr</span> <span class="o">=</span> <span class="n">mmol</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">mmol</span> <span class="o">/</span> <span class="p">(</span><span class="n">mmol</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">mmol</span><span class="p">)</span>     <span class="c1"># reduced molecular weight of colliding species</span>
        <span class="n">A_sr</span> <span class="o">=</span> <span class="mf">1.16e-3</span> <span class="o">*</span> <span class="n">mu_sr</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">th_v</span><span class="o">**</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># !!!!!!!!!!!!!!!! [j] si / no? CANCELLARE</span>
        <span class="n">B_sr</span> <span class="o">=</span> <span class="mf">0.015</span> <span class="o">*</span> <span class="n">mu_sr</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">tau_sr</span> <span class="o">=</span> <span class="mi">101325</span> <span class="o">/</span> <span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">A_sr</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">B_sr</span><span class="p">)</span> <span class="o">-</span> <span class="mf">18.42</span><span class="p">)</span>
        <span class="n">ts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xr</span> <span class="o">/</span> <span class="n">tau_sr</span><span class="p">)</span>      <span class="c1"># CANCELLARE controllare sommatoria (cfr Zanardi 2.124)</span>
        <span class="n">e_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span>
        <span class="n">e_v_eq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">Svt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">e_v_eq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">e_v</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">ts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  
        
        
    <span class="n">Sc</span> <span class="o">=</span> <span class="n">Sy</span> <span class="o">*</span> <span class="n">e_v</span>
    <span class="n">Sv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Svt</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Sc</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sv = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Sv</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">Sv</span>

<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sv</span> <span class="o">=</span> <span class="n">compute_Sv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pre-shock-relax-chemistry-funciton">
<h2>Pre-shock relax chemistry funciton<a class="headerlink" href="#pre-shock-relax-chemistry-funciton" title="Permalink to this headline">¶</a></h2>
<p>Starting from the given composition, the equilibrium composition in the reference state (pre-shock) is computed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pre_shock_relax_chemistry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Y</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>
    <span class="n">Sy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Sy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">)):</span>
        
        <span class="n">Sy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
        <span class="n">Y</span> <span class="o">+=</span> <span class="mf">1e-6</span> <span class="o">*</span> <span class="n">Sy</span>
        <span class="k">if</span> <span class="n">output</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; concentration : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;    Sorgente : &#39;</span>  <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">Sy</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Species not conserved in pre-shock relax&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y less than 0 in chemical relax pre - shock&#39;</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">Y</span>

<span class="n">problem</span><span class="o">.</span><span class="n">pre_shock_relax_chemistry</span> <span class="o">=</span> <span class="n">pre_shock_relax_chemistry</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="temperature-version">
<h2>Temperature version<a class="headerlink" href="#temperature-version" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euler-system-of-equation-and-solve-function-temperature-version">
<h3>Euler system of equation and solve function, temperature version<a class="headerlink" href="#euler-system-of-equation-and-solve-function-temperature-version" title="Permalink to this headline">¶</a></h3>
<p>In this case the primary variables considered are density, velocity, mass fractions and temperature. \</p>
<p>The equations read:</p>
<ul class="simple">
<li><p>Mass equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0\)</span></p></li>
<li><p>Momentum equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \)</span> <br>
Since <span class="math notranslate nohighlight">\( P = P(\rho, T, Y) = \rho \Sigma_i Y_i R T \)</span> , then <span class="math notranslate nohighlight">\( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T} d T + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)</span>  <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_u T \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial T} = \rho \Sigma_i Y_i R_u\)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial Y_i} = \rho R_u T\)</span> <br>
Hence, the momentum equation can be written as : <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R T \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_u \frac{\partial T}{\partial x} + \rho R T \Sigma_i \frac{Y_i}{x}\)</span></p></li>
</ul>
</li>
<li><p>Energy equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\)</span> <br>
In analogy with the pressure, we have <span class="math notranslate nohighlight">\( e = e (T, Y_i) \)</span>, then <span class="math notranslate nohighlight">\( de = \frac{\partial e }{\partial T} dT + \Sigma \frac{\partial e }{\partial Y_i} dY_i\)</span> <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial T} = cv(T, Y_i) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial Y_i} = e_i(T) \)</span> <br>
Hence, the energy equation can be written as : <br>
<span class="math notranslate nohighlight">\( \frac{\partial T}{\partial x} = \frac{1}{cv} \left [ \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \Sigma_i e_i(T) \frac{\partial Y}{\partial x} \right ]\)</span></p></li>
</ul>
</li>
<li><p>Species transport equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In this block one of the primary variables is temperature and not energy</span>

<span class="k">def</span> <span class="nf">Euler_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    <span class="n">rho_x</span><span class="p">,</span> <span class="n">u_x</span><span class="p">,</span> <span class="n">T_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> 
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span> <span class="p">)</span>
    <span class="n">e_Y</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="c1">## p_x = np.sum(rho_x * Y  * Ru * T + rho * Y_x * T * Ru + rho * Y * Ru * T_x)  # CANCELLARE</span>
    <span class="n">p_x</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="c1">##p_x = (self.R(Y)*T*Y)* rho_x + (rho*self.R(Y)*Y)* T_x</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">p_x</span> <span class="o">+=</span> <span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T_x</span>
        <span class="c1">##p_x += (rho*self.R(Y)*T)*Y_x[t]</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First term of the derivative p_x: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    
    <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="c1"># print(&#39;S NOp = %.12e&#39; %S[-5])</span>
    <span class="c1"># print(&#39;S em = %.12e&#39; %S[-1])</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system R                                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho_x            : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system cv               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system p                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>

    <span class="c1"># Mass equation</span>
    <span class="n">rho_xc</span> <span class="o">=</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">u_x</span>
    
    <span class="c1"># Momentum equation</span>
    <span class="c1"># u_xc  = -  p_x / rho / u</span>
    <span class="n">p_Y</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span>
    <span class="n">p_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">)</span>
    <span class="n">p_rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">)</span>
    <span class="n">e_T</span> <span class="o">=</span> <span class="n">cv</span>
    <span class="n">u_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">p_Y</span><span class="p">,</span> <span class="n">Y_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p_T</span> <span class="o">/</span> <span class="n">e_T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">e_Y</span><span class="p">,</span> <span class="n">Y_x</span><span class="p">))</span> <span class="o">/</span> \
            <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">u</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">p_rho</span> <span class="o">-</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_T</span> <span class="o">/</span> <span class="n">e_T</span> <span class="p">)</span>
    
    <span class="c1"># print(&#39;rho_x              : &#39; + str(rho_x))</span>
    <span class="c1"># print(&#39;p                  : &#39; + str(p))</span>
    <span class="c1"># print(&#39;rho                : &#39; + str(rho))</span>
    <span class="c1"># print(&#39;e_Y                : &#39; + str(e_Y))</span>
    <span class="c1"># print(&#39;Y_x                : &#39; + str(Y_x))</span>
    <span class="c1"># print(&#39;sum(e_Y * Y_x)     : &#39; + str(np.sum(e_Y * Y_x)))</span>
    <span class="c1"># print(&#39;cv                 : &#39; + str(cv))</span>
    <span class="c1"># Energy equation</span>
    <span class="n">T_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho_x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">))</span> <span class="o">/</span> <span class="n">e_T</span>
    <span class="c1"># print(&#39;T_xc              : &#39; + str(T_xc))</span>

    <span class="c1">#e_xc  = p / rho ** 2 * rho_x + Se + rho * u_x + 1 / 2 * rho_x * u</span>
    
    <span class="c1"># Species equations</span>
    <span class="n">Y_xc</span>  <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    <span class="n">x_xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho_xc</span><span class="p">]</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_xc</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Y_xc</span><span class="p">:</span>
        <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_c              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x - x_c        : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system S                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        
        
    <span class="k">return</span>   <span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span>
    
<span class="k">def</span> <span class="nf">Euler_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_spatial</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A Solving for x = </span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_spatial</span>, end=&quot;&quot;)
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;State values  = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        
        <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
            <span class="n">x0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        
        <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
                                            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>  
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler_x did not converge&#39;</span><span class="p">)</span>    
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="c1"># print(&#39;x_x = &#39; + str(x_x))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ier = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ier</span><span class="p">))</span>
            
        
        <span class="k">return</span> <span class="n">x_x</span>
    
    
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_system</span> <span class="o">=</span> <span class="n">Euler_system</span>
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_x</span> <span class="o">=</span> <span class="n">Euler_x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solve-temperature-version">
<h3>Solve, temperature version<a class="headerlink" href="#solve-temperature-version" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># Compute post shock values to be used as initial conditions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RHjump</span><span class="p">()</span>
    
    <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x</span><span class="p">,</span> 
                              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e4</span><span class="p">,</span>
                              <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">:,:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span>

<span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Post processing</span>
    <span class="c1"># Gather mmol of each specie</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
        
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">)):</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mmol</span>
        <span class="c1"># Normalization of the molar fraction</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># print(str(parameter))</span>
        <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">parameter</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span> <span class="o">=</span> <span class="n">X</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">=</span> <span class="n">e</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="o">=</span> <span class="n">p</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span> <span class="o">=</span> <span class="n">solve</span>
<span class="n">problem</span><span class="o">.</span><span class="n">postprocess</span> <span class="o">=</span> <span class="n">postprocess</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="temperature-version-temperature-version">
<h2>2 Temperature version (Temperature version)<a class="headerlink" href="#temperature-version-temperature-version" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euler-system-of-equation-2-temperature-version">
<h3>Euler system of equation, 2 temperature version<a class="headerlink" href="#euler-system-of-equation-2-temperature-version" title="Permalink to this headline">¶</a></h3>
<p>The equations read:
In</p>
<ul class="simple">
<li><p>Mass equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0\)</span></p></li>
<li><p>Momentum equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \)</span> <br>
Since <span class="math notranslate nohighlight">\( P = P(\rho, T, Y) = \rho \Sigma_i Y_i R T \)</span> , then <span class="math notranslate nohighlight">\( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T} d T + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)</span>  <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_u T \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial T} = \rho \Sigma_i Y_i R_u\)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial Y_i} = \rho R_u T\)</span> <br>
Hence, the momentum equation can be written as : <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R T \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_u \frac{\partial T}{\partial x} + \rho R T \Sigma_i \frac{Y_i}{x}\)</span></p></li>
</ul>
</li>
<li><p>Energy equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\)</span> <br>
In analogy with the pressure, we have <span class="math notranslate nohighlight">\( e = e (T, Y_i) \)</span>, then <span class="math notranslate nohighlight">\( de = \frac{\partial e }{\partial T} dT + \Sigma \frac{\partial e }{\partial Y_i} dY_i\)</span> <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial T} = cv(T, Y_i) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial Y_i} = e_i(T) \)</span> <br>
Hence, the energy equation can be written as : <br>
<span class="math notranslate nohighlight">\( \frac{\partial T}{\partial x} = \frac{1}{cv} \left [ \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \Sigma_i e_i(T) \frac{\partial Y}{\partial x} \right ]\)</span></p></li>
</ul>
</li>
<li><p>Species transport equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_system_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="n">rho_x</span><span class="p">,</span> <span class="n">u_x</span><span class="p">,</span> <span class="n">T_x</span><span class="p">,</span> <span class="n">Tv_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">Y_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>    
    
    <span class="n">p_x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
        <span class="n">p_x</span> <span class="o">+=</span> <span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T_x</span>
    
    <span class="n">e2_tr</span><span class="p">,</span> <span class="n">e2_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span> <span class="p">)</span>
    <span class="n">e_Y_tr</span><span class="p">,</span> <span class="n">e_Y_ve</span>             <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y_2T</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
    <span class="n">e_Y_v</span>                      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y_v</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
    <span class="n">e_Y_tot</span> <span class="o">=</span> <span class="n">e_Y_tr</span> <span class="o">+</span> <span class="n">e_Y_ve</span> 
    <span class="n">e_tr_T</span> <span class="o">=</span> <span class="n">cv_tr</span>
    <span class="n">e_ve_Tv</span> <span class="o">=</span> <span class="n">cv_ve</span>
    <span class="n">p_Y</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span>
    <span class="n">p_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">)</span>
    <span class="n">p_rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">)</span>
    
        
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First term of the derivative p_x: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span>  

    <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy_2T</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
    <span class="n">Svt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sv</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system R                                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho_x            : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Tv                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Tv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system cv               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Tv_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Tv_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system p                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Svt               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Svt</span><span class="p">))</span>

    <span class="c1"># Mass equation</span>
    <span class="n">rho_xc</span> <span class="o">=</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">u_x</span>
    
    <span class="c1"># Momentum equation</span>
    <span class="n">u_xc</span>  <span class="o">=</span> <span class="o">-</span>  <span class="n">p_x</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    <span class="c1"># u_xc  = (- np.inner(p_Y, Y_x) + p_T / e_tr_T * (np.inner(e_Y_tot, Y_x) + e_ve_Tv * Tv_x) )/ \</span>
    <span class="c1">#         (rho * u - rho / u * p_rho - p / (rho * u) * p_T / e_tr_T )</span>
    
    <span class="c1"># print(&#39;Svt =&#39; + str(Svt))</span>
    <span class="c1"># Svt = 0</span>
    
    <span class="c1"># Energy equation                                           # new term : de_ve/dTv * dTv/dx</span>
    <span class="c1"># T_xc  = (p / rho ** 2 * rho_x - np.sum(e_Y_tot * Y_x) - cv_ve * Tv_x) / cv_tr</span>
    <span class="n">T_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho_x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y_tot</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">)</span> <span class="o">-</span> <span class="n">e_ve_Tv</span> <span class="o">*</span> <span class="n">Tv_x</span><span class="p">)</span> <span class="o">/</span> <span class="n">e_tr_T</span>
    <span class="n">Tv_xc</span> <span class="o">=</span> <span class="p">(</span><span class="n">Svt</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y_v</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">))</span> <span class="o">/</span> <span class="n">e_ve_Tv</span>
    <span class="c1"># print(&#39;Tv_xc =&#39; + str(Tv_xc))</span>
    
    <span class="c1">#e_xc  = p / rho ** 2 * rho_x + Se + rho * u_x + 1 / 2 * rho_x * u</span>
    
    <span class="c1"># Species equations</span>
    <span class="n">Y_xc</span>  <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    <span class="n">x_xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho_xc</span><span class="p">]</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tv_xc</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Y_xc</span><span class="p">:</span>
        <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_c              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x - x_c        : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system S                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Svt              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Svt</span><span class="p">))</span>
        
        
    <span class="k">return</span>   <span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span>
    
<span class="k">def</span> <span class="nf">Euler_x_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_spatial</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solving for x = </span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_spatial</span>, end=&quot;&quot;)
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;State values  = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        
<span class="c1">#         x0 = [0.0, 0.0, 0.0, 0.0]</span>
        
<span class="c1">#         for i in self.specie:</span>
<span class="c1">#             x0.append(0)</span>
        <span class="k">if</span> <span class="n">x0</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
                <span class="n">x0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        
        <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system_2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
                                            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler_x did not converge&#39;</span><span class="p">)</span>    
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="c1"># print(&#39;x_x = &#39; + str(x_x))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ier = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ier</span><span class="p">))</span>
            
            
        <span class="k">return</span> <span class="n">x_x</span>
    
    
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_system_2T</span> <span class="o">=</span> <span class="n">Euler_system_2T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_x_2T</span> <span class="o">=</span> <span class="n">Euler_x_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solve-2-temperature-version">
<h3>Solve, 2 temperature version<a class="headerlink" href="#solve-2-temperature-version" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># Compute post shock values to be used as initial conditions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RHjump_2T</span><span class="p">()</span>
    
    <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                                                                                    <span class="c1"># True</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x_2T</span><span class="p">,</span> 
                              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">,</span>
                              <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">:,:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span>
    
    <span class="c1"># Compute energy</span>
    <span class="n">e_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">e_ve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">)):</span>
        <span class="n">e_tr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_tr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">e_ve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_ve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_tr</span> <span class="o">=</span> <span class="n">e_tr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_ve</span> <span class="o">=</span> <span class="n">e_ve</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="o">=</span> <span class="n">p</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">solve_2T</span> <span class="o">=</span> <span class="n">solve_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="plot">
<h1>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;T [K]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Trt&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Tv&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    <span class="c1"># Set labels etc.</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tv [K]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;rho [Kg/m3]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity [m/s]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Molar fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">logplot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">logplot_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Molar fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">print_max</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;For validation purpuses, the fluxes of conserved values are plotted as a function of x&#39;&#39;&#39;</span>
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="c1"># Compute and plot mass flux</span>

    <span class="n">subaxes_mass</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mass_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span>
    <span class="n">error_mass_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_flux</span> <span class="o">-</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass2</span> <span class="o">=</span> <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass flux [Kg/s]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot momentum flux</span>
    <span class="n">subaxes_momentum</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">momentum_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> 
    <span class="n">error_momentum_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">momentum_flux</span> <span class="o">-</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_momentum2</span> <span class="o">=</span> <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Momentum flux [Pa * m / s]&#39;</span><span class="p">)</span>  <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot total enthalpy flux</span>
    <span class="n">subaxes_enthalpy</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> 
    <span class="n">error_enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">enthalpy_flux</span> <span class="o">-</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_enthalpy2</span> <span class="o">=</span> <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;enthalpy flux [J/ms]&#39;</span><span class="p">)</span> <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="c1">#     # Compute and plot energy flux</span>
<span class="c1">#     subaxes_energy     = plt.subplot(5, 1, 4)</span>
<span class="c1">#     energy_flux = (self.sol_rho * ( self.sol_e + 1 / 2 * self.sol_u ** 2 )) * self.sol_u </span>
<span class="c1">#     error_energy_flux = ( energy_flux - energy_flux[0] ) / energy_flux[0]</span>
<span class="c1">#     subaxes_energy.plot(self.sol_x, error_energy_flux, ls)</span>
    
<span class="c1">#     subaxes_energy2 = subaxes_energy.twiny()</span>
<span class="c1">#     subaxes_energy2.plot(x_lambda, error_energy_flux, ls)</span>
    
<span class="c1">#     # Set labels etc.</span>
<span class="c1">#     subaxes_energy.set_xlim(0, xmax)</span>
<span class="c1">#     subaxes_energy2.set_xlim(0, xmax / self.mfp)</span>
<span class="c1">#     subaxes_energy.set_xlabel(&#39;x [m]&#39;)</span>
<span class="c1">#     subaxes_energy2.set_xlabel(&#39;x / reference mfp [-]&#39;)</span>
<span class="c1">#     subaxes_energy.set_ylabel(&#39;Energy flux [J/ms]&#39;) # CANCELLARE controllare unità di misura o toglierle</span>
<span class="c1">#     subaxes_energy2.grid()</span>
<span class="c1">#     subaxes_energy.yaxis.grid(True)</span>
    
    <span class="c1"># Compute and plot sum of mass fractions</span>
    <span class="n">subaxes_mass_frac</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">mass_frac_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
    <span class="n">error_mass_frac_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_frac_flux</span> <span class="o">-</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass_frac2</span> <span class="o">=</span> <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum of mass fractions [-]&#39;</span><span class="p">)</span> 
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_max</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass flux error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum momentum flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_momentum_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum enthalpy flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_enthalpy_flux</span><span class="p">))))</span>
        <span class="c1"># print(&#39;Maximum energy flux error     : &#39; + str(np.max(np.abs(error_energy_flux))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass frac error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_frac_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last value of mass flux       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass_flux</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ymin                          : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">validate_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">print_max</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;For validation purpuses, the fluxes of conserved values are plotted as a function of x&#39;&#39;&#39;</span>
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="c1"># Compute and plot mass flux</span>

    <span class="n">subaxes_mass</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mass_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span>
    <span class="n">error_mass_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_flux</span> <span class="o">-</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass2</span> <span class="o">=</span> <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass flux [Kg/s]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot momentum flux</span>
    <span class="n">subaxes_momentum</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">momentum_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="c1"># CANCELLARE multiply per u to obtain a flux</span>
    <span class="n">error_momentum_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">momentum_flux</span> <span class="o">-</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_momentum2</span> <span class="o">=</span> <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Momentum flux [Pa * m / s]&#39;</span><span class="p">)</span>  <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot total enthalpy flux</span>
    <span class="n">subaxes_enthalpy</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_tr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_ve</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> 
    <span class="n">error_enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">enthalpy_flux</span> <span class="o">-</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_enthalpy2</span> <span class="o">=</span> <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;enthalpy flux [J/ms]&#39;</span><span class="p">)</span> <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot sum of mass fractions</span>
    <span class="n">subaxes_mass_frac</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">mass_frac_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># CANCELLARE multiply per u to obtain a flux</span>
    <span class="n">error_mass_frac_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_frac_flux</span> <span class="o">-</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass_frac2</span> <span class="o">=</span> <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum of mass fractions [-]&#39;</span><span class="p">)</span> <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_max</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass flux error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum momentum flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_momentum_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum energy flux error     : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_enthalpy_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass frac error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_frac_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last value of mass flux       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass_flux</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ymin                          : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">)))</span>
    

<span class="n">problem</span><span class="o">.</span><span class="n">plot_T</span> <span class="o">=</span> <span class="n">plot_T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_2T</span> <span class="o">=</span> <span class="n">plot_2T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_rho</span> <span class="o">=</span> <span class="n">plot_rho</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_u</span> <span class="o">=</span> <span class="n">plot_u</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_Y</span> <span class="o">=</span> <span class="n">plot_Y</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_X</span> <span class="o">=</span> <span class="n">plot_X</span>
<span class="n">problem</span><span class="o">.</span><span class="n">logplot_Y</span> <span class="o">=</span> <span class="n">logplot_Y</span>
<span class="n">problem</span><span class="o">.</span><span class="n">logplot_X</span> <span class="o">=</span> <span class="n">logplot_X</span>
<span class="n">problem</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="n">validate</span>
<span class="n">problem</span><span class="o">.</span><span class="n">validate_2T</span> <span class="o">=</span> <span class="n">validate_2T</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="specie-problem">
<h1>11 specie problem<a class="headerlink" href="#specie-problem" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_11specie</span> <span class="o">=</span> <span class="n">problem</span><span class="p">()</span>

<span class="c1"># Add species </span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">NO</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">N</span><span class="p">,</span>  <span class="mi">0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O</span><span class="p">,</span>  <span class="mi">0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">O2p</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">NOp</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">N2p</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">Np</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">Op</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">add_specie_ic</span><span class="p">(</span><span class="n">em</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Add reactions</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O2diss</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2diss</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NOdiss</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NO_O</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_N2</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_O2p</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2_Np</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_NOp</span> <span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2_Op</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N_NOp</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O2_NOp</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NOp_N</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O___N</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O___O</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N___N</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">O_ion</span><span class="p">)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">reaction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N_ion</span><span class="p">)</span>

<span class="c1"># Set ic</span>
<span class="c1"># caso 1 di Matte (stessi di Park)    CANCELLARE</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mf">247.02</span> <span class="c1"># 300</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">3.097e-4</span> <span class="c1">#1.225</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">5062</span> <span class="c1">#3000</span>

<span class="c1"># Solve</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">solve_2T</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pre shock Mach : 16.000562605530575
******************************
Post-shock guess values:
rho    : 0.0018226047541988338
T      : 12530.13407323571
Speed  : 860.1433724938996
Mach   : 0.3817439471343904
******************************
Post-shock values:
rho    : 0.0018226047541988334
T      : 12530.13407323571
Tv     : 247.02
Speed  : 860.1433724939
Mach   : 0.409518116035972
******************************
Reference mean free path : 2.168525552716173e-05

Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
Solving for x = 0.000000000000e+00
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 0.000000000000e+00
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.168525552716e-10
Solving for x = 2.168525552716e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.084262776358e-10
Solving for x = 1.084262776358e-10
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 5.421313881790e-11
Solving for x = 5.421313881790e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.710656940895e-11
Solving for x = 2.710656940895e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.355328470448e-11
Solving for x = 1.355328470448e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 6.776642352238e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 6.776642352238e-12
Solving for x = 6.776642352238e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 6.776642352238e-12
Solving for x = 1.355328470448e-12
Solving for x = 1.355328470448e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.355328470448e-12
Solving for x = 1.355328470448e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.710656940895e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.710656940895e-13
Solving for x = 2.710656940895e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 5.421313881790e-14
Solving for x = 5.421313881790e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 5.421313881790e-14
Solving for x = 1.084262776358e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.084262776358e-14
Solving for x = 6.387380298553e-15
Solving for x = 6.387380298553e-15
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.277476059711e-14
Solving for x = 1.277476059711e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.644622705918e-14
Solving for x = 2.644622705918e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 4.011769352125e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 4.011769352125e-14
Solving for x = 5.378915998332e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 5.378915998332e-14
Solving for x = 8.315359800387e-14
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 8.315359800387e-14
Solving for x = 1.125180360244e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.125180360244e-13
Solving for x = 1.418824740450e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.418824740450e-13
Solving for x = 1.712469120655e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.712469120655e-13
Solving for x = 2.559772896123e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.559772896123e-13
Solving for x = 3.407076671590e-13
Solving for x = 3.407076671590e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 4.254380447057e-13
Solving for x = 4.254380447057e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 7.357475782674e-13
Solving for x = 7.357475782674e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.046057111829e-12
Solving for x = 1.046057111829e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.356366645391e-12
Solving for x = 1.356366645391e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.666676178952e-12
Solving for x = 1.666676178952e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.616593059778e-12
Solving for x = 2.616593059778e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 3.566509940603e-12
Solving for x = 3.566509940603e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 4.516426821429e-12
Solving for x = 4.516426821429e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 5.466343702254e-12
Solving for x = 5.466343702254e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 6.943410292002e-12
Solving for x = 6.943410292002e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 8.420476881750e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 8.420476881750e-12
Solving for x = 9.897543471498e-12
Solving for x = 9.897543471498e-12
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.137461006125e-11
Solving for x = 1.137461006125e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.459087888297e-11
Solving for x = 1.459087888297e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 1.780714770470e-11
Solving for x = 1.780714770470e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.102341652643e-11
Solving for x = 2.102341652643e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.423968534815e-11
Solving for x = 2.423968534815e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.745595416988e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 2.745595416988e-11
Solving for x = 3.119069108112e-11
Solving for x = 3.119069108112e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 3.492542799236e-11
Solving for x = 3.492542799236e-11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solving for x = 3.866016490360e-11
Solving for x = 3.866016490360e-11
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_8738</span><span class="o">/</span><span class="mf">140116881.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">40</span> 
<span class="g g-Whitespace">     </span><span class="mi">41</span> <span class="c1"># Solve</span>
<span class="ne">---&gt; </span><span class="mi">42</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">solve_2T</span><span class="p">()</span>

<span class="nn">/tmp/ipykernel_8738/3553125332.py</span> in <span class="ni">solve_2T</span><span class="nt">(self, xf)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>         <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>                                                                                     <span class="c1"># True</span>
<span class="ne">---&gt; </span><span class="mi">11</span>     <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x_2T</span><span class="p">,</span> 
<span class="g g-Whitespace">     </span><span class="mi">12</span>                               <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>                               <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/integrate/_ivp/ivp.py</span> in <span class="ni">solve_ivp</span><span class="nt">(fun, t_span, y0, method, t_eval, dense_output, events, vectorized, args, **options)</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span>     <span class="n">status</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">575</span>     <span class="k">while</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">576</span>         <span class="n">message</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span> 
<span class="g g-Whitespace">    </span><span class="mi">578</span>         <span class="k">if</span> <span class="n">solver</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;finished&#39;</span><span class="p">:</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/integrate/_ivp/base.py</span> in <span class="ni">step</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span>             <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
<span class="ne">--&gt; </span><span class="mi">181</span>             <span class="n">success</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_impl</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span> 
<span class="g g-Whitespace">    </span><span class="mi">183</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/integrate/_ivp/bdf.py</span> in <span class="ni">_step_impl</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">351</span>                     <span class="n">LU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">J</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">352</span> 
<span class="ne">--&gt; </span><span class="mi">353</span>                 <span class="n">converged</span><span class="p">,</span> <span class="n">n_iter</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">solve_bdf_system</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span>                     <span class="bp">self</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_new</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">LU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_lu</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>                     <span class="n">scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newton_tol</span><span class="p">)</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/integrate/_ivp/bdf.py</span> in <span class="ni">solve_bdf_system</span><span class="nt">(fun, t_new, y_predict, c, psi, LU, solve_lu, scale, tol)</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="n">converged</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NEWTON_MAXITER</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">43</span>         <span class="n">f</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t_new</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span>             <span class="k">break</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/integrate/_ivp/base.py</span> in <span class="ni">fun</span><span class="nt">(t, y)</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>         <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">137</span>             <span class="bp">self</span><span class="o">.</span><span class="n">nfev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">138</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fun_single</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span> 
<span class="g g-Whitespace">    </span><span class="mi">140</span>         <span class="bp">self</span><span class="o">.</span><span class="n">fun</span> <span class="o">=</span> <span class="n">fun</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/integrate/_ivp/base.py</span> in <span class="ni">fun_wrapped</span><span class="nt">(t, y)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> 
<span class="g g-Whitespace">     </span><span class="mi">19</span>     <span class="k">def</span> <span class="nf">fun_wrapped</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">20</span>         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> 
<span class="g g-Whitespace">     </span><span class="mi">22</span>     <span class="k">return</span> <span class="n">fun_wrapped</span><span class="p">,</span> <span class="n">y0</span>

<span class="nn">/tmp/ipykernel_8738/2680226215.py</span> in <span class="ni">Euler_x_2T</span><span class="nt">(self, x_spatial, x, x0)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>         <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> 
<span class="ne">--&gt; </span><span class="mi">112</span>         <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system_2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
<span class="g g-Whitespace">    </span><span class="mi">113</span>                                             <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/optimize/minpack.py</span> in <span class="ni">fsolve</span><span class="nt">(func, x0, args, fprime, full_output, col_deriv, xtol, maxfev, band, epsfcn, factor, diag)</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>                <span class="s1">&#39;diag&#39;</span><span class="p">:</span> <span class="n">diag</span><span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span> 
<span class="ne">--&gt; </span><span class="mi">160</span>     <span class="n">res</span> <span class="o">=</span> <span class="n">_root_hybr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">fprime</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>     <span class="k">if</span> <span class="n">full_output</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>

<span class="nn">~/.local/lib/python3.8/site-packages/scipy/optimize/minpack.py</span> in <span class="ni">_root_hybr</span><span class="nt">(func, x0, args, jac, col_deriv, xtol, maxfev, band, eps, factor, diag, **unknown_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span>         <span class="k">if</span> <span class="n">maxfev</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span>             <span class="n">maxfev</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">237</span>         <span class="n">retval</span> <span class="o">=</span> <span class="n">_minpack</span><span class="o">.</span><span class="n">_hybrd</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xtol</span><span class="p">,</span> <span class="n">maxfev</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span>                                  <span class="n">ml</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">epsfcn</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">diag</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="k">else</span><span class="p">:</span>

<span class="nn">/tmp/ipykernel_8738/2680226215.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(x_x)</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>         <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> 
<span class="ne">--&gt; </span><span class="mi">112</span>         <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system_2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
<span class="g g-Whitespace">    </span><span class="mi">113</span>                                             <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>

<span class="nn">/tmp/ipykernel_8738/2680226215.py</span> in <span class="ni">Euler_system_2T</span><span class="nt">(self, x, x_x)</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span>     <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> 
<span class="ne">---&gt; </span><span class="mi">31</span>     <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy_2T</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>     <span class="n">Svt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sv</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span> 

<span class="nn">/tmp/ipykernel_8738/2075763074.py</span> in <span class="ni">compute_Sy_2T</span><span class="nt">(self, rho, T, Y, Tv)</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>                 <span class="c1">#breakpoint()</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>                 <span class="c1"># Update the source terms for the species equation</span>
<span class="ne">--&gt; </span><span class="mi">114</span>                 <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>                 <span class="c1">#Update the energy source term</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>                 <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_11specie</span><span class="o">.</span><span class="n">postprocess</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="c1"># em</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span> <span class="c1"># Op</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1"># Np</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span> <span class="c1"># N2p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1"># NOp</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span> <span class="c1"># O2p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f6c60bba490&gt;]
</pre></div>
</div>
<img alt="../_images/Reactive_Air_shock_2T_last_49_1.png" src="../_images/Reactive_Air_shock_2T_last_49_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="c1"># em</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_11specie</span><span class="o">.</span><span class="n">sol_X</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">9e-5</span><span class="p">,</span><span class="mf">1.1e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(9e-05, 0.00011)
</pre></div>
</div>
<img alt="../_images/Reactive_Air_shock_2T_last_50_1.png" src="../_images/Reactive_Air_shock_2T_last_50_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmax</span> <span class="o">=</span> <span class="mf">5e-3</span>
<span class="n">xmax_l</span> <span class="o">=</span> <span class="mf">3e7</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_2T</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="c1"># ax[0].set_ylim(8.5e3,1e4)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_rho</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="c1"># ax[1].set_ylim(2.2e-3,2.6e-3)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">logplot_X</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>
<span class="c1"># ax[2].set_ylim(1e-5,1e-4)</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_u</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Reactive_Air_shock_2T_last_51_0.png" src="../_images/Reactive_Air_shock_2T_last_51_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">_11specie</span><span class="o">.</span><span class="n">plot_X</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">xmax</span> <span class="o">=</span> <span class="mf">5e-3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 0.0001)
</pre></div>
</div>
<img alt="../_images/Reactive_Air_shock_2T_last_52_1.png" src="../_images/Reactive_Air_shock_2T_last_52_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_11specie</span><span class="o">.</span><span class="n">validate_2T</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximum mass flux error       : 4.7087946167778684e-11
Maximum momentum flux error   : 4.33289294380527e-11
Maximum energy flux error     : 2.8386473906864516e-06
Maximum mass frac error       : 7.560618797697316e-14
Last value of mass flux       : 1.5677014000738168
Ymin                          : -2.777136648662164e-72
</pre></div>
</div>
<img alt="../_images/Reactive_Air_shock_2T_last_53_1.png" src="../_images/Reactive_Air_shock_2T_last_53_1.png" />
</div>
</div>
<div class="section" id="effect-of-altitude-density">
<h2>Effect of altitude (density)<a class="headerlink" href="#effect-of-altitude-density" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="effect-of-velocity">
<h2>Effect of velocity<a class="headerlink" href="#effect-of-velocity" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="effect-of-composition">
<h2>Effect of composition<a class="headerlink" href="#effect-of-composition" title="Permalink to this headline">¶</a></h2>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="o2-dissociation">
<h1>O2 Dissociation<a class="headerlink" href="#o2-dissociation" title="Permalink to this headline">¶</a></h1>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./2_Temperature"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Venti Edoardo, Zucchelli Umberto<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>