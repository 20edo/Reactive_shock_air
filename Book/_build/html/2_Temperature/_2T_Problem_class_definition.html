
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Problem class definition &#8212; Reactive air shock assignment</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Results" href="../Results/Results.html" />
    <link rel="prev" title="Reaction and sub-reaction classes" href="_2T_Reaction_class_definition.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/Logo_Politecnico_Milano.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Reactive air shock assignment</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Cerca in questo libro ..." aria-label="Cerca in questo libro ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  One temperature code description
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/1T_code_structure.html">
   One temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/Specie_class_definition.html">
   Specie class definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/Reaction_class_definition.html">
   Reaction and sub-reaction classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1_Temperature/Problem_class_definition.html">
   Problem class definition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Two-temperatures code description
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_code_structure.html">
   Two-temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_Specie_class_definition.html">
   Specie class definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_2T_Reaction_class_definition.html">
   Reaction and sub-reaction classes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Problem class definition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Results
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Results/Results.html">
   Results
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Attiva / disattiva la navigazione" aria-controls="site-navigation"
                title="Attiva / disattiva la navigazione" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Scarica questa pagina"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/2_Temperature/_2T_Problem_class_definition.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Scarica il file sorgente" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Stampa in PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Modalità schermo intero"
        title="Modalità schermo intero"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/20edo/Reactive_shock_air/master?urlpath=tree/Book/2_Temperature/_2T_Problem_class_definition.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Lanciare Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenuti
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thermodynamics">
   Thermodynamics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rh-jump-relations">
   RH jump relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
   Computation of the chemical source terms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling">
   Computation of the Vibrational-Translational Energy transfer and Chemical-Vibrational Coupling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperature-version-temperature-version">
   2 Temperature version (Temperature version)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#euler-system-of-equation-2-temperature-version">
     Euler system of equation, 2 temperature version
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-2-temperature-version">
     Solve, 2 temperature version
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   Post-processing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-plot">
     Temperature plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-plot">
     Density plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-plot">
     Velocity plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-plot">
     Mass fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-plot">
     Molar fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-log-plot">
     Mass fractions log-plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-log-plot">
     Molar fractions log-plot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation">
   Validation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Problem class definition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contenuti </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thermodynamics">
   Thermodynamics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rh-jump-relations">
   RH jump relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
   Computation of the chemical source terms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling">
   Computation of the Vibrational-Translational Energy transfer and Chemical-Vibrational Coupling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperature-version-temperature-version">
   2 Temperature version (Temperature version)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#euler-system-of-equation-2-temperature-version">
     Euler system of equation, 2 temperature version
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solve-2-temperature-version">
     Solve, 2 temperature version
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   Post-processing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature-plot">
     Temperature plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-plot">
     Density plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-plot">
     Velocity plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-plot">
     Mass fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-plot">
     Molar fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-log-plot">
     Mass fractions log-plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-log-plot">
     Molar fractions log-plot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation">
   Validation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> _2T_Reaction_class_definition.ipynb
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="problem-class-definition">
<h1>Problem class definition<a class="headerlink" href="#problem-class-definition" title="Permalink to this headline">¶</a></h1>
<p>In the same manner of the one temperature, the problem class is a container for mixture thermodynamics, initial conditions, solution and plot functions.</p>
<div class="section" id="thermodynamics">
<h2>Thermodynamics<a class="headerlink" href="#thermodynamics" title="Permalink to this headline">¶</a></h2>
<p>On one hand many thermodynamic functions are the same as their one temperature equivalent, on the other hand it is necessary to define appropriate functions for the computation of the translational-rotational energy form the translational-rotational temperature and the same for the vibro-electronic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">problem</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specie</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>     <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mi">300</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">1.225</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">3000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>     <span class="o">=</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="mf">6.2</span> <span class="o">*</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1"># Sigma HS nitrogen</span>
    
    <span class="k">def</span> <span class="nf">add_specie_ic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specie</span><span class="p">,</span> <span class="n">Y0</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">specie</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y0</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y0</span>
        
    <span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">R</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">R</span>
    
    <span class="k">def</span> <span class="nf">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">e1_tr</span><span class="p">,</span> <span class="n">e1_ve</span><span class="p">,</span> <span class="n">cv1_tr</span><span class="p">,</span> <span class="n">cv1_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
            <span class="n">e_tr</span>  <span class="o">=</span> <span class="n">e_tr</span> <span class="o">+</span> <span class="n">e1_tr</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">cv_tr</span> <span class="o">=</span> <span class="n">cv_tr</span> <span class="o">+</span> <span class="n">cv1_tr</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">e_ve</span>  <span class="o">=</span> <span class="n">e_ve</span> <span class="o">+</span> <span class="n">e1_ve</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">cv_ve</span> <span class="o">=</span> <span class="n">cv_ve</span> <span class="o">+</span> <span class="n">cv1_ve</span> <span class="o">*</span><span class="n">Y</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span>
    
    <span class="k">def</span> <span class="nf">e_Y_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of energy 2T wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="n">e_Y_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="n">e_Y_ve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y_tr</span><span class="p">)):</span>
            <span class="n">e_Y_tr</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">e_Y_ve</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">useless_tr</span><span class="p">,</span> <span class="n">useless_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y_tr</span><span class="p">,</span> <span class="n">e_Y_ve</span>
    
    <span class="k">def</span> <span class="nf">e_Y_v</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of vibrational-electronic energy wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="n">e_Y_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y_v</span><span class="p">)):</span>
            <span class="n">e_Y_v</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y_v</span>
    
    <span class="k">def</span> <span class="nf">only_e_tr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the translational-rotational energy&#39;&#39;&#39;</span>
        <span class="n">e_tr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1_tr</span><span class="p">,</span> <span class="n">e1_ve</span><span class="p">,</span> <span class="n">cv1_tr</span><span class="p">,</span> <span class="n">cv1_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
            <span class="n">e_tr</span> <span class="o">=</span> <span class="n">e_tr</span> <span class="o">+</span> <span class="n">e1_tr</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e_tr</span>
    
    <span class="k">def</span> <span class="nf">only_e_ve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the vibrational-electronic energy&#39;&#39;&#39;</span>
        <span class="n">e_ve</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span>
            <span class="n">e_ve</span> <span class="o">=</span> <span class="n">e_ve</span> <span class="o">+</span> <span class="n">e1_ve</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e_ve</span>
    
    <span class="k">def</span> <span class="nf">T_from_e_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">T0_tr</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">T0_ve</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
        
        <span class="n">T_tr</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier_tr</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">T</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_tr</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">e_tr</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0_tr</span><span class="p">,</span>
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span> <span class="o">*</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">T_ve</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier_ve</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Tv</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_ve</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">-</span> <span class="n">e_ve</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0_ve</span><span class="p">,</span>
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span> <span class="o">*</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier_tr</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_tr_from_e did not converge&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier_ve</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_ve_from_e did not converge&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">T_tr</span><span class="p">,</span> <span class="n">T_ve</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rh-jump-relations">
<h2>RH jump relations<a class="headerlink" href="#rh-jump-relations" title="Permalink to this headline">¶</a></h2>
<p>The Rankine-Hugoniot relations are the same and read: <br></p>
<p><span class="math notranslate nohighlight">\( \rho_0 u_0 = \rho_1 u_1 \)</span> <br>
<span class="math notranslate nohighlight">\( \rho_0 u_0^2 + P_0 = \rho_1 u_1^2 + P_1 \)</span> <br>
<span class="math notranslate nohighlight">\( h_0^t  = e_0 + \frac{P_0}{\rho_0} + \frac{1}{2}u_0^2 = 
e_1 + \frac{P_1}{\rho_1} + \frac{1}{2} u_1^2 = h_1^t \)</span> <br>
<span class="math notranslate nohighlight">\( Y_{i_0} = Y_{i_1} \)</span> <br></p>
<p>Where <span class="math notranslate nohighlight">\(P = \rho \sum_{i}^{N_s} Y_i R_i T^{tr} \)</span> and <span class="math notranslate nohighlight">\(e = e^{tr} + e^{ve}\)</span> <br>
The non-linear equations are written in the “RHsystem” function whose solutions are found through a non-linear solver.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The shock is solved with the hypothesis of frozen chemistry and constant vibrational-electronic temperature.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RHsystem_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">rho2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span>
    <span class="n">e2_tr</span><span class="p">,</span> <span class="n">e2_ve</span><span class="p">,</span> <span class="n">CV2_tr</span><span class="p">,</span> <span class="n">CV2_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">e0_tr</span><span class="p">,</span> <span class="n">e0_ve</span><span class="p">,</span> <span class="n">CV0_tr</span><span class="p">,</span> <span class="n">CV0_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">out_rho</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">)</span>                                  <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="n">out_mom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>  <span class="n">p0</span><span class="p">)</span>                       <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
    <span class="n">out_ene</span> <span class="o">=</span> <span class="p">(</span><span class="n">e0_tr</span> <span class="o">+</span> <span class="n">e0_ve</span> <span class="o">+</span> <span class="n">p0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">-</span> <span class="p">(</span><span class="n">e2_tr</span> <span class="o">+</span> <span class="n">e2_ve</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">/</span> <span class="n">rho2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u2</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>
      
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">out_rho</span><span class="p">,</span> <span class="n">out_mom</span><span class="p">,</span> <span class="n">out_ene</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rho2, T2, u2 : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">out</span>

    
<span class="k">def</span> <span class="nf">RHjump_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Build a guess assuming perfect gas with gamma = 1.4</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">M0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">/</span> <span class="n">c0</span>
    <span class="n">M2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">p2</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
    <span class="n">T2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">);</span> 
    <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">M2</span><span class="p">;</span>
        
    <span class="c1"># Solve RH relations</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RHsystem_2T</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> 
                                     <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RH not converged&#39;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Compute reference post shock mean free path</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    <span class="n">mmixt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mmol</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">=</span> <span class="n">Kb</span> <span class="o">*</span> <span class="n">T2</span> <span class="o">/</span> <span class="n">p2</span>  <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cv2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">cp</span> <span class="o">/</span> <span class="n">cv2</span>
    <span class="n">c2c</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">M2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">/</span> <span class="n">c2c</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre shock Mach : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock guess values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tv     : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2c</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reference mean free path : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speed is negative!!! Look at RHjump&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;EXITING&quot;</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">RHsystem_2T</span> <span class="o">=</span> <span class="n">RHsystem_2T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">RHjump_2T</span> <span class="o">=</span> <span class="n">RHjump_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computation-of-the-chemical-source-terms">
<h2>Computation of the chemical source terms<a class="headerlink" href="#computation-of-the-chemical-source-terms" title="Permalink to this headline">¶</a></h2>
<p>The chemical source terms are computed in the same manner as the one temperaturee model but the forward and backward reaction rates depend both on the translational-rotational and vibrational-electronic temperature according to Park’s model [1].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_Sy_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Se</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">reaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">)):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegar[k][idx] = 1</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegap[k][idx] = 1</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Transform the global y vector to the local X vector</span>
                <span class="n">chi_r_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">chi_p_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">R_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_r_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_p_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                <span class="c1">#breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1"># S += mmol * (np.matmul(np.transpose(omegap), obj.stoichp) - np.matmul(  np.transpose(omegar), obj.stoichr)) * w_s</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">subreaction</span><span class="p">):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegar[k][idx] = 1</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegap[k][idx] = 1</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="c1"># Transform the global y vector to the local X vector</span>
                <span class="n">chi_r_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">chi_p_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">R_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_r_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb_2T</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">chi_p_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                
                <span class="c1"># breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">R_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">R_s</span>
                
                
        <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Member of the reaction group of this problem are ill-defined&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Se = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">Se</span>


<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sy_2T</span> <span class="o">=</span> <span class="n">compute_Sy_2T</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Now the reaction rates <span class="math notranslate nohighlight">\(R_{i,j}\)</span> depend on the type of reaction considered as described above</p>
</div>
</div>
<div class="section" id="computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling">
<h2>Computation of the Vibrational-Translational Energy transfer and Chemical-Vibrational Coupling<a class="headerlink" href="#computation-of-the-vibrational-translational-energy-transfer-and-chemical-vibrational-coupling" title="Permalink to this headline">¶</a></h2>
<p>The source term <span class="math notranslate nohighlight">\(S_v\)</span> is taken into account in order to study the evolution of the vibrational-elecronic energy term introducted by the two-temperature model.<br>
<span class="math notranslate nohighlight">\( S_v = S_{c-v} + S_{v-t} \)</span> <br>
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{S_{c-v}}\)</span> is the vibrational energy lost or gained due to the chemical reactions. <br>
<span class="math notranslate nohighlight">\( S_{c-v} = \sum_{i}^{N_s} \omega_i e^{ve}_i \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{S_{v-t}} \)</span> is the vibrational energy relaxation term between vibrational and translational energy modes due to collisions.
The energy exchange rate is modeled using the Landau-Teller model as: <br>
<span class="math notranslate nohighlight">\( S_{v-t} = \sum_i \rho_i \frac{e^{ve,*}_i - e^{ve}_i}{\tau_i} \)</span> <br>
Where <span class="math notranslate nohighlight">\(e^{ve,*}_i\)</span> is the vibrational-electronic energy of species <span class="math notranslate nohighlight">\(i\)</span> at the translational-rotational temperature <span class="math notranslate nohighlight">\(T^{tr}\)</span> and <span class="math notranslate nohighlight">\(\tau_i\)</span> is the characteristic relaxation time. For a mixture: <br>
<span class="math notranslate nohighlight">\( \tau_i = \frac{\sum_r X_r}{\sum_r X_r/\tau_{ir}} \)</span> <br>
<span class="math notranslate nohighlight">\( X_i = \frac{Y_i}{M_i} \left( \sum_{r}\frac{Y_r}{M_r} \right)^{-1} \)</span> <br>
<span class="math notranslate nohighlight">\(\tau_{ir}\)</span> is obtained from the Millikan and White’s semiempirical correlation: <br>
<span class="math notranslate nohighlight">\( \tau_{ir} = \tau_{ir}^{MW} = \frac{101325}{p} exp \left[ A_{ir} \left(\left(T^{tr}\right)^{-1/3} - B_{ir} \right) - 18.42 \right] \)</span> <br>
Where:
<span class="math notranslate nohighlight">\( A_{ir} = 1.16 \cdot 10^{-3} \mu_{ir}^{1/2} \theta_{v,i}^{4/3} \)</span> <br>
<span class="math notranslate nohighlight">\( B_{ir} = 0.015 \mu_{ir}^{1/4} \)</span> <br>
<span class="math notranslate nohighlight">\( \mu_{ir} = \frac{M_i M_r}{M_i + M_r} \)</span> <br></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_Sv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">Sy</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="c1"># Recover theta_v</span>
    <span class="n">th_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">mmol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span>
        <span class="n">th_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">th_v</span>
    
    <span class="c1"># Recover Pressure</span>
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> 
    
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">e_v_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">e_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Svt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">mmol</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="c1"># Compute v-e and chemical source terms</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="c1"># xr = Y[j] / mmol[j] / (np.sum(Y/mmol))</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">X</span>
        <span class="n">mu_sr</span> <span class="o">=</span> <span class="n">mmol</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">mmol</span> <span class="o">/</span> <span class="p">(</span><span class="n">mmol</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">mmol</span><span class="p">)</span>     <span class="c1"># reduced molecular weight of colliding species</span>
        <span class="n">A_sr</span> <span class="o">=</span> <span class="mf">1.16e-3</span> <span class="o">*</span> <span class="n">mu_sr</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">th_v</span><span class="o">**</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> 
        <span class="n">B_sr</span> <span class="o">=</span> <span class="mf">0.015</span> <span class="o">*</span> <span class="n">mu_sr</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">tau_sr</span> <span class="o">=</span> <span class="mi">101325</span> <span class="o">/</span> <span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">A_sr</span> <span class="o">*</span> <span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">B_sr</span><span class="p">)</span> <span class="o">-</span> <span class="mf">18.42</span><span class="p">)</span>
        <span class="n">ts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xr</span> <span class="o">/</span> <span class="n">tau_sr</span><span class="p">)</span>     
        <span class="n">e_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span>
        <span class="n">e_v_eq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">energy_vib_2T</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">Svt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">e_v_eq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">e_v</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">ts</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  
        
        
    <span class="n">Sc</span> <span class="o">=</span> <span class="n">Sy</span> <span class="o">*</span> <span class="n">e_v</span>
    <span class="n">Sv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Svt</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Sc</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sv = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Sv</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">Sv</span>

<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sv</span> <span class="o">=</span> <span class="n">compute_Sv</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="temperature-version-temperature-version">
<h2>2 Temperature version (Temperature version)<a class="headerlink" href="#temperature-version-temperature-version" title="Permalink to this headline">¶</a></h2>
<div class="section" id="euler-system-of-equation-2-temperature-version">
<h3>Euler system of equation, 2 temperature version<a class="headerlink" href="#euler-system-of-equation-2-temperature-version" title="Permalink to this headline">¶</a></h3>
<p>The equations read:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textbf{Mass equation}\)</span>: <br />
<span class="math notranslate nohighlight">\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0 \Longrightarrow \frac{\partial \rho}{\partial x} = - \frac{\rho}{u} \frac{\partial u}{\partial x} \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{Momentum equation}\)</span>: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \)</span> <br>
Since <span class="math notranslate nohighlight">\( P = P(\rho, T^{tr}, Y) = \rho \Sigma_i Y_i R_i T^{tr} \)</span> , then <span class="math notranslate nohighlight">\( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T^{tr}} d T^{tr} + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)</span>  <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_i T^{tr} \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial T^{tr}} = \rho \Sigma_i Y_i R_i\)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial Y_i} = \rho R_i T^{tr}\)</span> <br>
Hence, the momentum equation can be written as : <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R_i T^{tr} \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_i \frac{\partial T^{tr}}{\partial x} + \rho R T^{tr} \Sigma_i \frac{\partial Y_i}{\partial x}\)</span></p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The momentum equation can be rewritten also as:
<span class="math notranslate nohighlight">\(\frac{\partial u}{\partial x} =\frac{- \sum_i \frac{\partial p}{\partial Y_i} \frac{\partial Y_i}{\partial x} + \frac{\partial p}{\partial T} \left( \sum_i \frac{\partial e}{\partial Y_i} \frac{\partial Y_i}{\partial x} + \frac{\partial e}{\partial T^v} \frac{\partial T^v}{\partial x} \right) \left( \frac{\partial e}{\partial T} \right)^{-1}}{\rho u - \frac{\rho}{u} \frac{\partial P}{\partial \rho} - \frac{p}{\rho u} \frac{\partial P}{\partial T} \left( \frac{\partial e}{\partial T} \right)^{-1}} \)</span></p>
</div>
<ul>
<li><p><span class="math notranslate nohighlight">\(\textbf{Energy equation}\)</span>: <br />
<span class="math notranslate nohighlight">\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\)</span> <br>
Expressing the dependence of e on the thermodynamic variables: <span class="math notranslate nohighlight">\( e = e (T, T^v, Y_i) \)</span>, then <br>
<span class="math notranslate nohighlight">\( de = \frac{\partial e }{\partial T} dT + \frac{\partial e }{\partial T^v} dT^v + \Sigma \frac{\partial e }{\partial Y_i} dY_i\)</span> <br></p>
<p>The derivatives can be expressed as : <br></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial T} = cv^{tr} (T, Y_i) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial T^v} = \frac{\partial e^v}{\partial T^v} = cv^v (T^v, Y_i) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial Y_i} = e_i(T) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e^v}{\partial Y_i} = e^v_i(T^v) \)</span> <br>
Hence, the energy equation can be written as : <br>
<span class="math notranslate nohighlight">\( \frac{\partial T}{\partial x} = \left [ \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \frac{\partial e}{\partial T^v} \frac{\partial T^v}{\partial x} - \Sigma_i \frac{\partial e}{\partial Y_i} \frac{\partial Y_i}{\partial x} \right ] \left( \frac{\partial e}{\partial T} \right)^{-1}\)</span> <br></p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(\textbf{Vibrational energy equation}\)</span>: <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial e^v}{\partial x} = S_v \)</span> <br>
Expressing the dependence of <span class="math notranslate nohighlight">\(e^v = e^v (T^v, Y_i)\)</span> on the thermodynamic variables:
<span class="math notranslate nohighlight">\( de^v = \frac{\partial e^v }{\partial T^v} dT^v + \Sigma \frac{\partial e^v }{\partial Y_i} dY_i\)</span> <br>
<span class="math notranslate nohighlight">\( \frac{\partial T^v}{\partial x} = \left [ \frac{S_v}{\rho u} - \Sigma_i \frac{\partial e^v}{\partial Y_i} \frac{\partial Y_i}{\partial x} \right ] \left( \frac{\partial e^v}{\partial T^v} \right)^{-1}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{Species transport equation}\)</span>: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_system_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
    <span class="n">rho_x</span><span class="p">,</span> <span class="n">u_x</span><span class="p">,</span> <span class="n">T_x</span><span class="p">,</span> <span class="n">Tv_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">Y_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>    
    
    <span class="n">p_x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
        <span class="n">p_x</span> <span class="o">+=</span> <span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T_x</span>
    
    <span class="n">e2_tr</span><span class="p">,</span> <span class="n">e2_ve</span><span class="p">,</span> <span class="n">cv_tr</span><span class="p">,</span> <span class="n">cv_ve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_2T</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span> <span class="p">)</span>
    <span class="n">e_Y_tr</span><span class="p">,</span> <span class="n">e_Y_ve</span>             <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y_2T</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
    <span class="n">e_Y_v</span>                      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y_v</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
    <span class="n">e_Y_tot</span> <span class="o">=</span> <span class="n">e_Y_tr</span> <span class="o">+</span> <span class="n">e_Y_ve</span> 
    <span class="n">e_tr_T</span> <span class="o">=</span> <span class="n">cv_tr</span>
    <span class="n">e_ve_Tv</span> <span class="o">=</span> <span class="n">cv_ve</span>
    <span class="n">p_Y</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span>
    <span class="n">p_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">)</span>
    <span class="n">p_rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">)</span>
    
        
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First term of the derivative p_x: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span>  

    <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy_2T</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">)</span>
    <span class="n">Svt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sv</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system R                                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho_x            : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Tv                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Tv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system cv               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Tv_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Tv_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system p                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Svt               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Svt</span><span class="p">))</span>

    <span class="c1"># Mass equation</span>
    <span class="n">rho_xc</span> <span class="o">=</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">u_x</span>
    
    <span class="c1"># Momentum equation</span>
    <span class="c1"># u_xc  = -  p_x / rho / u</span>
    <span class="n">u_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">p_Y</span><span class="p">,</span> <span class="n">Y_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">p_T</span> <span class="o">/</span> <span class="n">e_tr_T</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">e_Y_tot</span><span class="p">,</span> <span class="n">Y_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">e_ve_Tv</span> <span class="o">*</span> <span class="n">Tv_x</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span> \
            <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">u</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">p_rho</span> <span class="o">-</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_T</span> <span class="o">/</span> <span class="n">e_tr_T</span> <span class="p">)</span>
    
    <span class="c1"># Energy equation                                           # new term : de_ve/dTv * dTv/dx</span>
    <span class="n">T_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho_x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y_tot</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">)</span> <span class="o">-</span> <span class="n">e_ve_Tv</span> <span class="o">*</span> <span class="n">Tv_x</span><span class="p">)</span> <span class="o">/</span> <span class="n">e_tr_T</span>
    <span class="n">Tv_xc</span> <span class="o">=</span> <span class="p">(</span><span class="n">Svt</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">u</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y_v</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">))</span> <span class="o">/</span> <span class="n">e_ve_Tv</span>
    
    <span class="c1"># Species equations</span>
    <span class="n">Y_xc</span>  <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    <span class="n">x_xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho_xc</span><span class="p">]</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tv_xc</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Y_xc</span><span class="p">:</span>
        <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_c              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x - x_c        : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system S                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Svt              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Svt</span><span class="p">))</span>
        
        
    <span class="k">return</span>   <span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span>
    
<span class="k">def</span> <span class="nf">Euler_x_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_spatial</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solving for x = </span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_spatial</span>, end=&quot;&quot;)
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;State values  = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">x0</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mf">0.15</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="p">(</span> <span class="n">a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
                <span class="n">x0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        
        <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system_2T</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
                                            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler_x did not converge&#39;</span><span class="p">)</span>    
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="c1"># print(&#39;x_x = &#39; + str(x_x))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ier = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ier</span><span class="p">))</span>
            
            
        <span class="k">return</span> <span class="n">x_x</span>
    
    
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_system_2T</span> <span class="o">=</span> <span class="n">Euler_system_2T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_x_2T</span> <span class="o">=</span> <span class="n">Euler_x_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solve-2-temperature-version">
<h3>Solve, 2 temperature version<a class="headerlink" href="#solve-2-temperature-version" title="Permalink to this headline">¶</a></h3>
<p>The solve function is analogous to the one temperature version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># Compute post shock values to be used as initial conditions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RHjump_2T</span><span class="p">()</span>
    
    <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                                                                                    <span class="c1"># True</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x_2T</span><span class="p">,</span> 
                              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e5</span><span class="p">,</span>
                              <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">:,:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span>
    
    <span class="c1"># Compute energy</span>
    <span class="n">e_tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">e_ve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">)):</span>
        <span class="n">e_tr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_tr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">e_ve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e_ve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_tr</span> <span class="o">=</span> <span class="n">e_tr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_ve</span> <span class="o">=</span> <span class="n">e_ve</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="o">=</span> <span class="n">p</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">solve_2T</span> <span class="o">=</span> <span class="n">solve_2T</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="post-processing">
<h2>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h2>
<p>Once the result in terms of state variables have been computed, the pressure, energy and molar mass fractions are recovered to be used for the visualization and analysis of the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Post processing</span>
    <span class="c1"># Gather mmol of each specie</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
        
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">)):</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mmol</span>
        <span class="c1"># Normalization of the molar fraction</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
        <span class="c1"># print(str(parameter))</span>
        <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">parameter</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span> <span class="o">=</span> <span class="n">X</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">=</span> <span class="n">e</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="o">=</span> <span class="n">p</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">postprocess</span> <span class="o">=</span> <span class="n">postprocess</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot">
<h2>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h2>
<p>Several plot functions have been prepared to ease analysis and comparisons. These function plot the outcome of the analysis with a double x-axis: the upper values represent the number of reference mean free path while the lower is the distance measured in meters from the shock.</p>
<div class="section" id="temperature-plot">
<h3>Temperature plot<a class="headerlink" href="#temperature-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Trt&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">,</span> <span class="n">ls</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Tv&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Tv</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    <span class="c1"># Set labels etc.</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tv [K]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="density-plot">
<h3>Density plot<a class="headerlink" href="#density-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;rho [Kg/m3]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="velocity-plot">
<h3>Velocity plot<a class="headerlink" href="#velocity-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity [m/s]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mass-fractions-plot">
<h3>Mass fractions plot<a class="headerlink" href="#mass-fractions-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="molar-fractions-plot">
<h3>Molar fractions plot<a class="headerlink" href="#molar-fractions-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Molar fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mass-fractions-log-plot">
<h3>Mass fractions log-plot<a class="headerlink" href="#mass-fractions-log-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logplot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="molar-fractions-log-plot">
<h3>Molar fractions log-plot<a class="headerlink" href="#molar-fractions-log-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logplot_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Molar fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>For validation purposes, the fluxes of conservative variables are computed, the relative error is plotted and the max values printed. <br>
The conservative fluxes are:</p>
<ul class="simple">
<li><p>Mass flux : <span class="math notranslate nohighlight">\( \rho u\)</span></p></li>
<li><p>Momentum flux: <span class="math notranslate nohighlight">\( \rho u^2 + P \)</span></p></li>
<li><p>Energy flux: <span class="math notranslate nohighlight">\( ( \rho ( e + \frac{1}{2} u ^ 2 ) + P ) u \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">validate_2T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">print_max</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;For validation purpuses, the fluxes of conserved values are plotted as a function of x&#39;&#39;&#39;</span>
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="c1"># Compute and plot mass flux</span>

    <span class="n">subaxes_mass</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mass_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span>
    <span class="n">error_mass_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_flux</span> <span class="o">-</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass2</span> <span class="o">=</span> <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass flux [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot momentum flux</span>
    <span class="n">subaxes_momentum</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">momentum_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> 
    <span class="n">error_momentum_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">momentum_flux</span> <span class="o">-</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_momentum2</span> <span class="o">=</span> <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Momentum flux [-]&#39;</span><span class="p">)</span> 
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot total enthalpy flux</span>
    <span class="n">subaxes_enthalpy</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_tr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e_ve</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> 
    <span class="n">error_enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">enthalpy_flux</span> <span class="o">-</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_enthalpy2</span> <span class="o">=</span> <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;enthalpy flux [-]&#39;</span><span class="p">)</span> 
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot sum of mass fractions</span>
    <span class="n">subaxes_mass_frac</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">mass_frac_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
    <span class="n">error_mass_frac_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_frac_flux</span> <span class="o">-</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass_frac2</span> <span class="o">=</span> <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum of mass fractions [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_max</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass flux error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum momentum flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_momentum_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum energy flux error     : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_enthalpy_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass frac error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_frac_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last value of mass flux       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass_flux</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ymin                          : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">problem</span><span class="o">.</span><span class="n">plot_2T</span> <span class="o">=</span> <span class="n">plot_2T</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_rho</span> <span class="o">=</span> <span class="n">plot_rho</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_u</span> <span class="o">=</span> <span class="n">plot_u</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_Y</span> <span class="o">=</span> <span class="n">plot_Y</span>
<span class="n">problem</span><span class="o">.</span><span class="n">plot_X</span> <span class="o">=</span> <span class="n">plot_X</span>
<span class="n">problem</span><span class="o">.</span><span class="n">logplot_Y</span> <span class="o">=</span> <span class="n">logplot_Y</span>
<span class="n">problem</span><span class="o">.</span><span class="n">logplot_X</span> <span class="o">=</span> <span class="n">logplot_X</span>
<span class="n">problem</span><span class="o">.</span><span class="n">validate_2T</span> <span class="o">=</span> <span class="n">validate_2T</span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./2_Temperature"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="_2T_Reaction_class_definition.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Reaction and sub-reaction classes</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Results/Results.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Results</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Di Venti Edoardo, Zucchelli Umberto<br/>
    
        &copy; Diritto d'autore 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>