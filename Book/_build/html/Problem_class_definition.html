
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Problem class definition &#8212; Reactive air shock assignment</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Reaction and sub-reaction classes" href="Reaction_class_definition.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/Logo_Politecnico_Milano.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Reactive air shock assignment</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Code description
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1T_code_structure.html">
   One temperature
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Problem_class_definition.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/20edo/Reactive_shock_air"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/20edo/Reactive_shock_air/issues/new?title=Issue%20on%20page%20%2FProblem_class_definition.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/20edo/Reactive_shock_air/master?urlpath=tree/Book/Problem_class_definition.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialization">
   Initialization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reynolds-hugoiniot-jump-relations">
   Reynolds-Hugoiniot jump relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
   Computation of the chemical source terms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pre-shock-relax-chemistry-funciton">
   Pre-shock relax chemistry funciton
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#euler-system-of-equation">
   Euler system of equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve">
   Solve
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   Post-processing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperature-plot">
   Temperature plot
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-plot">
     Density plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-plot">
     Velocity plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-plot">
     Mass fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-plot">
     Molar fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-log-plot">
     Mass fractions log-plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-log-plot">
     Molar fractions log-plot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation">
   Validation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Problem class definition</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#initialization">
   Initialization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reynolds-hugoiniot-jump-relations">
   Reynolds-Hugoiniot jump relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computation-of-the-chemical-source-terms">
   Computation of the chemical source terms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pre-shock-relax-chemistry-funciton">
   Pre-shock relax chemistry funciton
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#euler-system-of-equation">
   Euler system of equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve">
   Solve
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   Post-processing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot">
   Plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperature-plot">
   Temperature plot
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-plot">
     Density plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#velocity-plot">
     Velocity plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-plot">
     Mass fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-plot">
     Molar fractions plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mass-fractions-log-plot">
     Mass fractions log-plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#molar-fractions-log-plot">
     Molar fractions log-plot
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#validation">
   Validation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> Reaction_class_definition.ipynb
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="problem-class-definition">
<h1>Problem class definition<a class="headerlink" href="#problem-class-definition" title="Permalink to this headline">¶</a></h1>
<p>We define a class problem so that several condition can be studied, analyzed, compared and contrasted.</p>
<p>The initial conditions for the post-shock relaxation region are obtained by assuming frozen chemistry through the shock which, in the Euler equations framework is a discontinuity whose jumps are defined by the Rankine-Hugoniot relations.</p>
<p>The variable are mixture density, velocity, energy and mixture mass fractions.</p>
<p>For the mixture model considered the the following relations hold:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e_{mixture} = \Sigma_i e_i Y_i \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(CV_{mixture} = \Sigma_i CV_i Y_i \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R_{mixture} = \Sigma_i R_i Y_i \)</span></p></li>
</ul>
<p>where Y is the mass fraction of each specie (obviously <span class="math notranslate nohighlight">\( \Sigma_i Y_i = 1\)</span> ).</p>
<div class="section" id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<p>In the following the class is created and the functions to compute the thermodynamic variables are defined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some variables have a default value when the class is initialized. All of them will be overwritten when defining a problem, but the sigma value that represents the equivalent cross section of pure nitrogen assuming hard sphere potential.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">problem</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specie</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>     <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>     <span class="o">=</span> <span class="mi">300</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span>   <span class="o">=</span> <span class="mf">1.225</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">u0</span>     <span class="o">=</span> <span class="mi">3000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>     <span class="o">=</span> <span class="mf">3.14</span> <span class="o">*</span> <span class="p">(</span><span class="mf">6.2</span> <span class="o">*</span> <span class="mf">1e-10</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1"># Sigma HS nitrogen</span>
    
    <span class="k">def</span> <span class="nf">add_specie_ic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specie</span><span class="p">,</span> <span class="n">Y0</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">specie</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y0</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">specie</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y0</span>
        
    <span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
        <span class="n">R</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">R</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">R</span>
    
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">CV1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">CV</span> <span class="o">+</span> <span class="n">CV1</span><span class="o">*</span><span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e</span><span class="p">,</span> <span class="n">CV</span>        
    
    <span class="k">def</span> <span class="nf">e_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Computes the derivative of energy wrt Y at constant T&#39;&#39;&#39;</span>
        <span class="n">e_Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_Y</span><span class="p">)):</span>
            <span class="n">e_Y</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">inutile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e_Y</span>
        
    <span class="k">def</span> <span class="nf">only_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span> <span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">CV</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only_e x : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;only e Y : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
            <span class="n">e1</span><span class="p">,</span> <span class="n">CV1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="n">e1</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">e</span>    
    
    <span class="k">def</span> <span class="nf">T_from_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">T0</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">):</span>
        
        <span class="n">T</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">T</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">T0</span><span class="p">,</span> 
                                            <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_from_e did not converge&#39;</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reynolds-hugoiniot-jump-relations">
<h2>Reynolds-Hugoiniot jump relations<a class="headerlink" href="#reynolds-hugoiniot-jump-relations" title="Permalink to this headline">¶</a></h2>
<p>At first, the Rankine Hugoniot relations are solved for a perfect gas with the same R of the mixture and the isoentropic coefficient <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>. <br>
Then, the results obtained are used as guess to initialize the non-linear solver.</p>
<p>The Rankine-Hugoniot relations read: <br></p>
<p>\begin{cases}
\rho_0 u_0 = \rho_1 u \
\rho_0 u_0^2 + P_0 = \rho_1 u_1^2 + P_1 \
h_0^t  = e_0 + \frac{P_0}{\rho_0} + \frac{1}{2}u_0^2 =
e_1 + \frac{P_1}{\rho_1} + \frac{1}{2} u_1^2 = h_1^t
\end{cases}</p>
<p>The non-linear equations are written in the “RHsystem” function whose solutions are found through a non-linear.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The shock is solved with the hypothesis of frozen chemistry</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">RHsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">rho2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span>
    <span class="n">e2</span><span class="p">,</span> <span class="n">CV2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
    
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">e0</span><span class="p">,</span> <span class="n">CV0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span>
    
    <span class="n">out_rho</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span><span class="p">)</span>                       <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="p">)</span>
    <span class="n">out_mom</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>  <span class="n">p0</span><span class="p">)</span>            <span class="o">-</span> <span class="p">(</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
    <span class="n">out_ene</span> <span class="o">=</span> <span class="p">(</span><span class="n">e0</span> <span class="o">+</span> <span class="n">p0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">-</span> <span class="p">(</span><span class="n">e2</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">/</span> <span class="n">rho2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u2</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span>
      
    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">out_rho</span><span class="p">,</span> <span class="n">out_mom</span><span class="p">,</span> <span class="n">out_ene</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rho2, T2, u2 : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">out</span>

    
<span class="k">def</span> <span class="nf">RHjump</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Build a guess assuming perfect gas with gamma = 1.4</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.4</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span>
    <span class="n">M0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u0</span> <span class="o">/</span> <span class="n">c0</span>
    <span class="n">M2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span> 
    <span class="n">p2</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
    <span class="n">T2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">)</span> \
            <span class="o">/</span> <span class="p">(</span> <span class="p">(</span> <span class="n">gamma</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M0</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">);</span> 
    <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">T2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">M2</span><span class="p">;</span>
        
    <span class="c1"># Solve RH relations</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RHsystem</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho2</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">u2</span><span class="p">],</span> <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> 
                                     <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># , epsfcn=1e-8, factor = 0.1</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RH not converged&#39;</span><span class="p">)</span>
            
    <span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Compute reference post shock mean free path</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    <span class="n">mmixt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mmol</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">=</span> <span class="n">Kb</span> <span class="o">*</span> <span class="n">T2</span> <span class="o">/</span> <span class="n">p2</span>  <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span>
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cv2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">cp</span> <span class="o">/</span> <span class="n">cv2</span>
    <span class="n">c2c</span> <span class="o">=</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">M2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span> <span class="o">/</span> <span class="n">c2c</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pre shock Mach : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock guess values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Post-shock values:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rho    : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T      : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Speed  : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mach   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">M2c</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;******************************&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Reference mean free path : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speed is negative!!! Look at RHjump&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s2">&quot;EXITING&quot;</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">RHsystem</span> <span class="o">=</span> <span class="n">RHsystem</span>
<span class="n">problem</span><span class="o">.</span><span class="n">RHjump</span> <span class="o">=</span> <span class="n">RHjump</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the “RHjump” function a reference mean free path is computed to be able to compare the relaxation length in terms if mean free path for different initial conditions. It represents the mean free path just after the shock and is computed by the cross section defined in the problem class</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While the defualt value of sigma is reasonable for air (since the bi-atomical nitrogen is its the first specie in terms of composition both in mass and molar fractions), it is not exact. Furthermore the effects of different composition are not captured by this value, hence it shall be used with caution and only as a reference.</p>
</div>
</div>
<div class="section" id="computation-of-the-chemical-source-terms">
<h2>Computation of the chemical source terms<a class="headerlink" href="#computation-of-the-chemical-source-terms" title="Permalink to this headline">¶</a></h2>
<p>The computations for the chemical source terms are performed in “local” coordinates for each reaction, so first the incidence matrix to transform form global to local variables and viceversa are computed, then the specie mass fraction vector is transformed in “local” number densities which are furthermore multiplied by the forward and backward reaction coefficients as defined before to compute the reaction rate. <br></p>
<p>According to the Park’s definition of forward and backward coefficients, the reaction rate is computed as: <br></p>
<p><span class="math notranslate nohighlight">\( K_f \Pi_{i = 0}^{N_{reactants}} \)</span>
Manca un pezzo</p>
<p>Finally, the generated/destroyed species are expressed in terms of “global” mass fraction rate and summed for each reaction and sub-reaction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Altough the energy released by the reaction is computed, it is no of practical use for the way the mixture energy have been written.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Se</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Recover mmol</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">reaction</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">)):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subreactions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegar[k][idx] = 1</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegap[k][idx] = 1</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Transform the global y vector to the local n vector</span>
                <span class="n">nr_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">np_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">w_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">nr_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                <span class="c1">#breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">w_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">w_s</span>
                <span class="c1"># S += mmol * (np.matmul(np.transpose(omegap), obj.stoichp) - np.matmul(  np.transpose(omegar), obj.stoichr)) * w_s</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">subreaction</span><span class="p">):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reaction</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                
                <span class="c1"># Add the reactants to the reactants matrix by an incidence matrix omegar</span>
                <span class="n">omegar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">reactants</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegar[k][idx] = 1</span>
                    <span class="n">omegar</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                
                <span class="c1"># Add the products to the products matrix by an incidence matrix omegap</span>
                <span class="n">omegap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)])</span>
                
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">products</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># omegap[k][idx] = 1</span>
                    <span class="n">omegap</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="c1"># Transform the global y vector to the local n vector</span>
                <span class="n">nr_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegar</span><span class="p">))</span>
                <span class="n">np_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">/</span> <span class="n">mmol</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">omegap</span><span class="p">))</span>
                
                <span class="c1"># Compute the reaction rate</span>
                <span class="n">w_s</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">kf</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">nr_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">)</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">kb</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np_l</span> <span class="o">**</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">)</span>
                
                <span class="c1"># breakpoint()</span>
                <span class="c1"># Update the source terms for the species equation</span>
                <span class="n">S</span> <span class="o">+=</span> <span class="n">mmol</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">stoichp</span><span class="p">,</span> <span class="n">omegap</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">stoichr</span><span class="p">,</span> <span class="n">omegar</span><span class="p">))</span> <span class="o">*</span> <span class="n">w_s</span>
                <span class="c1">#Update the energy source term</span>
                <span class="n">Se</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">e_mol</span> <span class="o">*</span> <span class="n">w_s</span>
                
                
        <span class="k">else</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Member of the reaction group of this problem are ill-defined&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Se = : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">Se</span>

<span class="n">problem</span><span class="o">.</span><span class="n">compute_Sy</span> <span class="o">=</span> <span class="n">compute_Sy</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pre-shock-relax-chemistry-funciton">
<h2>Pre-shock relax chemistry funciton<a class="headerlink" href="#pre-shock-relax-chemistry-funciton" title="Permalink to this headline">¶</a></h2>
<p>In general, once the density and temperature of a mixture are known, the equilibrium composition can be computed by the chemical equilibrium constant. In this function, the equilibrium composition of the mixture is computed through the chemical source terms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pre_shock_relax_chemistry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relax</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Y</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span>
    <span class="n">Sy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Sy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-8</span><span class="p">)):</span>
        
        <span class="n">Sy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rho0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T0</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
        <span class="n">Y</span> <span class="o">+=</span> <span class="n">relax</span> <span class="o">*</span> <span class="n">Sy</span> <span class="c1"># Relaxation parameter to favour convergence of chemical relaxation for mixture very far from equilibrium</span>
        <span class="k">if</span> <span class="n">output</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; concentration : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;    Sorgente : &#39;</span>  <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">Sy</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;********************************&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="mf">1e-8</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Species not conserved in pre-shock relax&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">Y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Y less than 0 in chemical relax pre - shock&#39;</span><span class="p">)</span>
            
    <span class="k">return</span> <span class="n">Y</span>

<span class="n">problem</span><span class="o">.</span><span class="n">pre_shock_relax_chemistry</span> <span class="o">=</span> <span class="n">pre_shock_relax_chemistry</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since in general both temperature, density and composition may be unknown or uncertain, this function prints the chemical equilibrium composition BUT DOES NOT UPDATE the inital conditions of the problem.</p>
</div>
</div>
<div class="section" id="euler-system-of-equation">
<h2>Euler system of equation<a class="headerlink" href="#euler-system-of-equation" title="Permalink to this headline">¶</a></h2>
<p>The primary variables considered are density, velocity, mass fractions and temperature. \</p>
<p>The Euler equations read:</p>
<ul class="simple">
<li><p>Mass equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial \rho u}{\partial x} = \frac{\partial \rho}{\partial x}u + \rho \frac{\partial u}{\partial x} = 0\)</span></p></li>
<li><p>Momentum equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} \)</span> <br>
Since <span class="math notranslate nohighlight">\( P = P(\rho, T, Y) = \rho \Sigma_i Y_i R T \)</span> , then <span class="math notranslate nohighlight">\( dp = \frac{\partial P}{\partial \rho} d \rho + \frac{\partial P}{\partial T} d T + \Sigma_i \frac{\partial P}{\partial Y_i} d Y_i \)</span>  <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial \rho} = \Sigma_i Y_i R_u T \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial T} = \rho \Sigma_i Y_i R_u\)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial P}{\partial Y_i} = \rho R_u T\)</span> <br>
Hence, the momentum equation can be written as : <br>
<span class="math notranslate nohighlight">\( \rho u \frac{\partial u}{\partial x} = - \frac{\partial P}{\partial x} = \Sigma_i Y_i R T \frac{\partial \rho}{\partial x} + \rho \Sigma_i Y_i R_u \frac{\partial T}{\partial x} + \rho R T \Sigma_i \frac{Y_i}{x}\)</span></p></li>
</ul>
</li>
<li><p>Energy equation: <br />
<span class="math notranslate nohighlight">\( \frac{\partial e}{\partial x} = \frac{P}{\rho^2} \frac{\partial \rho}{\partial x}\)</span> <br>
In analogy with the pressure, we have <span class="math notranslate nohighlight">\( e = e (T, Y_i) \)</span>, then <span class="math notranslate nohighlight">\( de = \frac{\partial e }{\partial T} dT + \Sigma \frac{\partial e }{\partial Y_i} dY_i\)</span> <br>
The derivatives can be expressed as : <br></p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial T} = cv(T, Y_i) \)</span> <br></p></li>
<li><p><span class="math notranslate nohighlight">\( \frac{\partial e}{\partial Y_i} = e_i(T) \)</span> <br>
Hence, the energy equation can be written as : <br>
<span class="math notranslate nohighlight">\( \frac{\partial T}{\partial x} = \frac{1}{cv}  \frac{P}{\rho^2} \frac{\partial \rho}{\partial x} - \Sigma_i e_i(T) \frac{\partialY_i} \)</span> Controllare per quale strano motivo latex non compila</p></li>
</ul>
</li>
<li><p>Species transport equation: <br />
<span class="math notranslate nohighlight">\( \rho u \frac{\partial Y_i }{\partial x} = \omega_i \qquad for \; i = 1 ... N_s \)</span></p></li>
</ul>
<p>Being the equations non linear, in analogy to what done for the shock relaxation, “Euler_system” defines the system of equations while “Euler_x” computes the derivative of the states by a non-linear solver.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Euler_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">):</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    <span class="n">rho_x</span><span class="p">,</span> <span class="n">u_x</span><span class="p">,</span> <span class="n">T_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Y_x</span> <span class="o">=</span> <span class="n">x_x</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> 
    
    <span class="n">e2</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span> <span class="p">)</span>
    <span class="n">e_Y</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e_Y</span><span class="p">(</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
    <span class="n">p_x</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">)):</span>
        <span class="n">p_x</span> <span class="o">+=</span> <span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">+</span> \
               <span class="n">rho</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T_x</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First term of the derivative p_x: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span> <span class="o">*</span> <span class="n">Y</span>  <span class="o">*</span> <span class="n">Ru</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mmol</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    
    <span class="n">S</span><span class="p">,</span> <span class="n">Se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_Sy</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system R                                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="n">Y</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho_x            : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Y_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system rho              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system cv               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cv</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system T_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system p                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>

    <span class="c1"># Mass equation</span>
    <span class="n">rho_xc</span> <span class="o">=</span> <span class="o">-</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span> <span class="o">*</span> <span class="n">u_x</span>
    
    <span class="c1"># Momentum equation</span>
    <span class="n">u_xc</span>  <span class="o">=</span> <span class="o">-</span>  <span class="n">p_x</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    <span class="c1"># Energy equation</span>
    <span class="n">T_xc</span>  <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rho_x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e_Y</span> <span class="o">*</span> <span class="n">Y_x</span><span class="p">))</span> <span class="o">/</span> <span class="n">cv</span>
    
    <span class="c1"># Species equations</span>
    <span class="n">Y_xc</span>  <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">/</span> <span class="n">u</span>
    
    <span class="n">x_xc</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho_xc</span><span class="p">]</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u_xc</span><span class="p">)</span>
    <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_xc</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Y_xc</span><span class="p">:</span>
        <span class="n">x_xc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_c              : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system x_x - x_c        : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system S                : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler system Se               : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Se</span><span class="p">))</span>
        
        
    <span class="k">return</span>   <span class="n">x_x</span> <span class="o">-</span> <span class="n">x_xc</span>
    
<span class="k">def</span> <span class="nf">Euler_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_spatial</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A Solving for x = </span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_spatial</span>, end=&quot;&quot;)
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;State values  = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        
        <span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
            <span class="n">x0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        
        <span class="n">x_x</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">ier</span><span class="p">,</span> <span class="n">mesg</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x_x</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">Euler_system</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_x</span><span class="p">),</span> 
                                            <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>  
                                            <span class="n">xtol</span><span class="o">=</span><span class="n">atol</span><span class="o">*</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Euler_x did not converge&#39;</span><span class="p">)</span>    
        
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ier = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ier</span><span class="p">))</span>
            
        
        <span class="k">return</span> <span class="n">x_x</span>
    
    
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_system</span> <span class="o">=</span> <span class="n">Euler_system</span>
<span class="n">problem</span><span class="o">.</span><span class="n">Euler_x</span> <span class="o">=</span> <span class="n">Euler_x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solve">
<h2>Solve<a class="headerlink" href="#solve" title="Permalink to this headline">¶</a></h2>
<p>The solve function resolves the shock and then computes the state varibles by integration of the derivatives in the spatial coordinate x.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The problem is stiff, thus an appropriate method must be chosen. In this code an implicit multi-step variable-order (1 to 5) method based on a backward differentiation formula for the derivative approximation has been chosen. The first step is a fraction of the reference post-shock mean free path.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    
    <span class="c1"># Compute post shock values to be used as initial conditions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RHjump</span><span class="p">()</span>
    
    <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rho1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Y0</span><span class="p">:</span>
        <span class="n">y0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    
    <span class="n">sol</span> <span class="o">=</span> <span class="n">itg</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Euler_x</span><span class="p">,</span> 
                              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xf</span><span class="p">],</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BDF&#39;</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">first_step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mfp</span> <span class="o">/</span> <span class="mf">1e4</span><span class="p">,</span>
                              <span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vectorized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,:],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">:,:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span> <span class="o">=</span> <span class="n">solve</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="post-processing">
<h2>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h2>
<p>Once the result in terms of state variables have been computed, the pressure, energy and molar mass fractions are recovered to be used for the visualization and analysis of the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Post processing</span>
    <span class="c1"># Gather mmol of each specie</span>
    <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">mmol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mmol</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">mmol</span><span class="p">)</span>
        
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">)):</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_e</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">mmol</span>
        <span class="c1"># Normalization of the molar fraction</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parameter</span><span class="p">))</span>
        <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">parameter</span>
        
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span> <span class="o">=</span> <span class="n">X</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">=</span> <span class="n">e</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> <span class="o">=</span> <span class="n">p</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">postprocess</span> <span class="o">=</span> <span class="n">postprocess</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot">
<h2>Plot<a class="headerlink" href="#plot" title="Permalink to this headline">¶</a></h2>
<p>Several plot functions have been prepared to ease analysis and comparisons. These function plot the outcome of the analysis with a double x-axis: the upper values represent the number of reference mean free path while the lower is the distance measured in meters from the shock.</p>
</div>
<div class="section" id="temperature-plot">
<h2>Temperature plot<a class="headerlink" href="#temperature-plot" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_T</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;T [K]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">plot_T</span> <span class="o">=</span> <span class="n">plot_T</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="density-plot">
<h3>Density plot<a class="headerlink" href="#density-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_rho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;rho [Kg/m3]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">plot_rho</span> <span class="o">=</span> <span class="n">plot_rho</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="velocity-plot">
<h3>Velocity plot<a class="headerlink" href="#velocity-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity [m/s]&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">plot_u</span> <span class="o">=</span> <span class="n">plot_u</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mass-fractions-plot">
<h3>Mass fractions plot<a class="headerlink" href="#mass-fractions-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">plot_Y</span> <span class="o">=</span> <span class="n">plot_Y</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="molar-fractions-plot">
<h3>Molar fractions plot<a class="headerlink" href="#molar-fractions-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Molar fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">problem</span><span class="o">.</span><span class="n">plot_X</span> <span class="o">=</span> <span class="n">plot_X</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mass-fractions-log-plot">
<h3>Mass fractions log-plot<a class="headerlink" href="#mass-fractions-log-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logplot_Y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">logplot_Y</span> <span class="o">=</span> <span class="n">logplot_Y</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="molar-fractions-log-plot">
<h3>Molar fractions log-plot<a class="headerlink" href="#molar-fractions-log-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logplot_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">):</span>
    <span class="c1"># Set axes</span>
    
    <span class="k">if</span> <span class="n">ax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
    
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>

    
    <span class="c1"># Add second x axis </span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        
    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_X</span><span class="p">),</span> <span class="n">ls</span><span class="p">)</span>


    <span class="c1"># Set labels etc.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="c1">#ax.set_ylim(bottom = 0)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Molar fractions&#39;</span><span class="p">)</span>
    
    <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specie</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">problem</span><span class="o">.</span><span class="n">logplot_X</span> <span class="o">=</span> <span class="n">logplot_X</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>For validation purposes, the fluxes of conservative variables are computed, the relative error is plotted and the max values printed. <br>
The conservative fluxes are:</p>
<ul class="simple">
<li><p>Mass flux : <span class="math notranslate nohighlight">\( \rho u\)</span></p></li>
<li><p>Momentum flux: <span class="math notranslate nohighlight">\( \rho u^2 + P \)</span></p></li>
<li><p>Energy flux: <span class="math notranslate nohighlight">\( ( \rho ( e + \frac{1}{2} u ^ 2 ) + P ) u \)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">xmax_l</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">print_max</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;For validation purpuses, the fluxes of conserved values are plotted as a function of x&#39;&#39;&#39;</span>
    <span class="c1"># Set xmax</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmax_l</span><span class="p">:</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="n">xmax_l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
            
        <span class="k">else</span><span class="p">:</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">x_lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span>
    
    <span class="c1"># Compute and plot mass flux</span>

    <span class="n">subaxes_mass</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mass_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span>
    <span class="n">error_mass_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_flux</span> <span class="o">-</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass2</span> <span class="o">=</span> <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mass flux [Kg/s]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot momentum flux</span>
    <span class="n">subaxes_momentum</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">momentum_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span> 
    <span class="n">error_momentum_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">momentum_flux</span> <span class="o">-</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">momentum_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_momentum2</span> <span class="o">=</span> <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_momentum_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Momentum flux [Pa * m / s]&#39;</span><span class="p">)</span>  <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_momentum2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_momentum</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot total enthalpy flux</span>
    <span class="n">subaxes_enthalpy</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_rho</span> <span class="o">*</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_e</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> <span class="o">**</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_p</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_u</span> 
    <span class="n">error_enthalpy_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">enthalpy_flux</span> <span class="o">-</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">enthalpy_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_enthalpy2</span> <span class="o">=</span> <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_enthalpy_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;enthalpy flux [J/ms]&#39;</span><span class="p">)</span> <span class="c1"># CANCELLARE controllare unità di misura o toglierle</span>
    <span class="n">subaxes_enthalpy2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_enthalpy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compute and plot sum of mass fractions</span>
    <span class="n">subaxes_mass_frac</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">mass_frac_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
    <span class="n">error_mass_frac_flux</span> <span class="o">=</span> <span class="p">(</span> <span class="n">mass_frac_flux</span> <span class="o">-</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="o">/</span> <span class="n">mass_frac_flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_x</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="n">subaxes_mass_frac2</span> <span class="o">=</span> <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_lambda</span><span class="p">,</span> <span class="n">error_mass_frac_flux</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span>
    
    <span class="c1"># Set labels etc.</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfp</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x [m]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / reference mfp [-]&#39;</span><span class="p">)</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum of mass fractions [-]&#39;</span><span class="p">)</span> 
    <span class="n">subaxes_mass_frac2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">subaxes_mass_frac</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_max</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass flux error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum momentum flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_momentum_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum enthalpy flux error   : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_enthalpy_flux</span><span class="p">))))</span>
        <span class="c1"># print(&#39;Maximum energy flux error     : &#39; + str(np.max(np.abs(error_energy_flux))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Maximum mass frac error       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error_mass_frac_flux</span><span class="p">))))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last value of mass flux       : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mass_flux</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ymin                          : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_Y</span><span class="p">)))</span>
        
<span class="n">problem</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="n">validate</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Reaction_class_definition.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Reaction and sub-reaction classes</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Venti Edoardo, Zucchelli Umberto<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>